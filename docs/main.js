/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={541:(e,t,i)=>{!function(e){"use strict";function t(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(t||(t="undefined"==typeof window?i.g:window),void 0!==t[e])return t[e];for(var n=["webkit","moz","ms","o"],a=0,l=n.length,s=e.charAt(0).toUpperCase()+e.substr(1);a<l;a++){var r=t[n[a]+s];if(void 0!==r)return r}return null}function r(e,t,i,n,a,l,s){if("function"!=typeof n)throw new TypeError("Invalid animation rule:",n);var o=e-i,u=o/a,h=0;u>1&&(u=1),1!==u&&(h=n(u),isFinite(h)&&!isNaN(h)&&(u=h)),t&&t(u),o<a?s.frame=$((function(e){return r(e,t,i,n,a,l,s)})):(l&&l(),s.inProgress=!1)}function o(){Array.prototype.constructor.apply(this,arguments)}function u(e,t,i,n,a,l){e.beginPath(),e.moveTo(t+l,i),e.lineTo(t+n-l,i),e.quadraticCurveTo(t+n,i,t+n,i+l),e.lineTo(t+n,i+a-l),e.quadraticCurveTo(t+n,i+a,t+n-l,i+a),e.lineTo(t+l,i+a),e.quadraticCurveTo(t,i+a,t,i+a-l),e.lineTo(t,i+l),e.quadraticCurveTo(t,i,t+l,i),e.closePath()}function h(e,t){var i,n=t.valueDec,a=t.valueInt,l=0,s=void 0,r=void 0;if(i=(e=parseFloat(e))<0,e=Math.abs(e),n>0){for(s=a-(r=e.toFixed(n).toString().split("."))[0].length;l<s;++l)r[0]="0"+r[0];r=(i?"-":"")+r[0]+"."+r[1]}else{for(s=a-(r=Math.round(e).toString()).length;l<s;++l)r="0"+r;r=(i?"-":"")+r}return r}function d(e,t,i){return e["font"+t+"Style"]+" "+e["font"+t+"Weight"]+" "+e["font"+t+"Size"]*i+"px "+e["font"+t]}function c(e){e.shadowOffsetX=null,e.shadowOffsetY=null,e.shadowBlur=null,e.shadowColor="",e.strokeStyle=null,e.lineWidth=0,e.save()}function p(e,t,i,n){t.valueTextShadow&&(e.shadowOffsetX=i,e.shadowOffsetY=i,e.shadowBlur=n,e.shadowColor=t.colorValueTextShadow)}function m(e,t,i,n,a){i.beginPath(),i.arc(0,0,ie(e),0,2*re,!0),i.lineWidth=t,i.strokeStyle=a?se.linearGradient(i,n,a,e):n,i.stroke(),i.closePath()}function f(e,t){var i=K.pixelRatio;return e.maxRadius||(e.maxRadius=e.max-t.borderShadowWidth-t.borderOuterWidth*i-t.borderMiddleWidth*i-t.borderInnerWidth*i+(t.borderOuterWidth?.5:0)+(t.borderMiddleWidth?.5:0)+(t.borderInnerWidth?.5:0)),e.maxRadius}function v(e,t){var i=K.pixelRatio,n=t.borderShadowWidth*i,a=e.max-n-t.borderOuterWidth*i/2,l=a-t.borderOuterWidth*i/2-t.borderMiddleWidth*i/2+.5,s=l-t.borderMiddleWidth*i/2-t.borderInnerWidth*i/2+.5,r=f(e,t),o=void 0,u=!1;e.save(),t.borderOuterWidth&&(u=se.drawShadow(e,t,u),m(a,t.borderOuterWidth*i,e,t.colorBorderOuter,t.colorBorderOuterEnd)),t.borderMiddleWidth&&(u=se.drawShadow(e,t,u),m(l,t.borderMiddleWidth*i,e,t.colorBorderMiddle,t.colorBorderMiddleEnd)),t.borderInnerWidth&&(u=se.drawShadow(e,t,u),m(s,t.borderInnerWidth*i,e,t.colorBorderInner,t.colorBorderInnerEnd)),se.drawShadow(e,t,u),e.beginPath(),e.arc(0,0,ie(r),0,2*re,!0),t.colorPlateEnd?((o=e.createRadialGradient(0,0,r/2,0,0,r)).addColorStop(0,t.colorPlate),o.addColorStop(1,t.colorPlateEnd)):o=t.colorPlate,e.fillStyle=o,e.fill(),e.closePath(),e.restore()}function g(e,t){var i=e.max*(parseFloat(t.highlightsWidth)||0)/100;if(i){var n=ie(b(e,t)-i/2),a=0,l=t.highlights.length,s=(t.maxValue-t.minValue)/t.ticksAngle;for(e.save();a<l;a++){var r=t.highlights[a];e.beginPath(),e.rotate(oe),e.arc(0,0,n,se.radians(t.startAngle+(r.from-t.minValue)/s),se.radians(t.startAngle+(r.to-t.minValue)/s),!1),e.strokeStyle=r.color,e.lineWidth=i,e.lineCap=t.highlightsLineCap,e.stroke(),e.closePath(),e.restore(),e.save()}}}function y(e,t){var i=b(e,t),n=void 0,a=void 0,l=void 0,s=0,r=0,o=Math.abs(t.minorTicks)||0,u=t.ticksAngle/(t.maxValue-t.minValue);for(e.lineWidth=K.pixelRatio,e.strokeStyle=t.colorMinorTicks||t.colorStrokeTicks,e.save(),t.exactTicks?(a=t.maxValue-t.minValue,n=o?a/o:0,r=(ae.mod(t.majorTicks[0],o)||0)*u):n=o*(t.majorTicks.length-1);s<n;++s)(l=t.startAngle+r+s*(t.ticksAngle/n))<=t.ticksAngle+t.startAngle&&(e.rotate(se.radians(l)),e.beginPath(),e.moveTo(0,i),e.lineTo(0,i-.075*e.max),w(e))}function b(e,t){var i=e.max/100;return f(e,t)-5*i-(t.barWidth?2*(parseFloat(t.barStrokeWidth)||0)+((parseFloat(t.barWidth)||0)+5)*i:0)}function x(e,t){se.prepareTicks(t);var i,n=ie(b(e,t)),a=void 0,l=t.majorTicks.length,s=K.pixelRatio;for(e.lineWidth=2*s,e.save(),i=t.colorMajorTicks instanceof Array?t.colorMajorTicks:new Array(l).fill(t.colorStrokeTicks||t.colorMajorTicks),a=0;a<l;++a)e.strokeStyle=i[a],e.rotate(se.radians(E(t,t.exactTicks?t.majorTicks[a]:a,l))),e.beginPath(),e.moveTo(0,n),e.lineTo(0,n-.15*e.max),w(e);t.strokeTicks&&(e.strokeStyle=t.colorStrokeTicks||i[0],e.rotate(oe),e.beginPath(),e.arc(0,0,n,se.radians(t.startAngle),se.radians(t.startAngle+t.ticksAngle),!1),w(e))}function E(e,t,i){if(e.exactTicks){var n=e.ticksAngle/(e.maxValue-e.minValue);return e.startAngle+n*(t-e.minValue)}return e.startAngle+t*(e.ticksAngle/(i-1))}function w(e){e.stroke(),e.restore(),e.closePath(),e.save()}function _(e,t){var i=b(e,t)-.15*e.max,n={},a=0,l=t.majorTicks.length,s="needle"!==t.animationTarget,r=t.colorNumbers instanceof Array?t.colorNumbers:new Array(l).fill(t.colorNumbers),o=s?-(t.value-t.minValue)/(t.maxValue-t.minValue)*t.ticksAngle:0;for(s&&(e.save(),e.rotate(-se.radians(o))),e.font=se.font(t,"Numbers",e.max/200),e.lineWidth=0,e.textAlign="center",e.textBaseline="middle";a<l;++a){var u=o+E(t,t.exactTicks?t.majorTicks[a]:a,l),h=e.measureText(t.majorTicks[a]).width,d=t.fontNumbersSize,c=Math.sqrt(h*h+d*d)/2,p=se.radialPoint(i-c-t.numbersMargin/100*e.max,se.radians(u));360===u&&(u=0),n[u]||(n[u]=!0,e.fillStyle=r[a],e.fillText(t.majorTicks[a],p.x,p.y))}s&&e.restore()}function U(e,t){t.title&&(e.save(),e.font=se.font(t,"Title",e.max/200),e.fillStyle=t.colorTitle,e.textAlign="center",e.fillText(t.title,0,-e.max/4.25,.8*e.max),e.restore())}function V(e,t){t.units&&(e.save(),e.font=se.font(t,"Units",e.max/200),e.fillStyle=t.colorUnits,e.textAlign="center",e.fillText(se.formatContext(t,t.units),0,e.max/3.25,.8*e.max),e.restore())}function A(e,t){if(t.needle){var i=t.ticksAngle<360?se.normalizedValue(t).indented:t.value,n=c?t.startAngle:t.startAngle+(i-t.minValue)/(t.maxValue-t.minValue)*t.ticksAngle;"right"===t.barStartPosition&&(n=t.startAngle+t.ticksAngle-(i-t.minValue)/(t.maxValue-t.minValue)*t.ticksAngle);var a=f(e,t),l=ie(a/100*t.needleCircleSize),s=ie(a/100*t.needleCircleSize*.75),r=ie(a/100*t.needleEnd),o=ie(t.needleStart?a/100*t.needleStart:0),u=a/100*t.needleWidth,h=a/100*t.needleWidth/2,d=K.pixelRatio,c="needle"!==t.animationTarget;e.save(),se.drawNeedleShadow(e,t),e.rotate(se.radians(n)),e.fillStyle=se.linearGradient(e,t.colorNeedle,t.colorNeedleEnd,r-o),"arrow"===t.needleType?(e.beginPath(),e.moveTo(-h,-o),e.lineTo(-u,0),e.lineTo(-1*d,r),e.lineTo(d,r),e.lineTo(u,0),e.lineTo(h,-o),e.closePath(),e.fill(),e.beginPath(),e.lineTo(-.5*d,r),e.lineTo(-1*d,r),e.lineTo(-u,0),e.lineTo(-h,-o),e.lineTo(h/2*d-2*d,-o),e.closePath(),e.fillStyle=t.colorNeedleShadowUp,e.fill()):(e.beginPath(),e.moveTo(-h,r),e.lineTo(-h,o),e.lineTo(h,o),e.lineTo(h,r),e.closePath(),e.fill()),t.needleCircleSize&&(e.restore(),se.drawNeedleShadow(e,t),t.needleCircleOuter&&(e.beginPath(),e.arc(0,0,l,0,2*re,!0),e.fillStyle=se.linearGradient(e,t.colorNeedleCircleOuter,t.colorNeedleCircleOuterEnd,l),e.fill(),e.closePath()),t.needleCircleInner&&(e.beginPath(),e.arc(0,0,s,0,2*re,!0),e.fillStyle=se.linearGradient(e,t.colorNeedleCircleInner,t.colorNeedleCircleInnerEnd,s),e.fill(),e.closePath()),e.restore())}}function I(e,t,i){se.drawValueBox(e,t,i,0,e.max-.33*e.max,e.max)}function S(e,t){var i=e.max/100,n=f(e,t)-5*i,a=parseFloat(t.barStrokeWidth+"")||0,l=(parseFloat(t.barWidth+"")||0)*i,s=n-2*a-l,r=(n-s)/2,o=s+r,u=a/o,h=t.startAngle,d=t.startAngle+t.ticksAngle;if(e.save(),e.rotate(oe),a&&(e.beginPath(),e.arc(0,0,o,se.radians(h)-u,se.radians(d)+u,!1),e.strokeStyle=t.colorBarStroke,e.lineWidth=2*r,e.stroke(),e.closePath()),l&&(e.beginPath(),e.arc(0,0,o,se.radians(h),se.radians(d),!1),e.strokeStyle=t.colorBar,e.lineWidth=l,e.stroke(),e.closePath(),t.barShadow&&(e.beginPath(),e.arc(0,0,n,se.radians(h),se.radians(d),!1),e.clip(),e.beginPath(),e.strokeStyle=t.colorBar,e.lineWidth=1,e.shadowBlur=t.barShadow,e.shadowColor=t.colorBarShadow,e.shadowOffsetX=0,e.shadowOffsetY=0,e.arc(0,0,n,se.radians(t.startAngle),se.radians(t.startAngle+t.ticksAngle),!1),e.stroke(),e.closePath(),e.restore(),e.rotate(oe)),t.barProgress)){var c=function(e){var t=e.startAngle,i=e.startAngle+e.ticksAngle,n=t,a=t+(se.normalizedValue(e).normal-e.minValue)/(e.maxValue-e.minValue)*e.ticksAngle;if("middle"===e.barStartPosition){var l=.5*(e.minValue+e.maxValue);e.value<l?(n=180-(l-se.normalizedValue(e).normal)/(e.maxValue-e.minValue)*e.ticksAngle,a=180):(n=180,a=180+(se.normalizedValue(e).normal-l)/(e.maxValue-e.minValue)*e.ticksAngle)}else"right"===e.barStartPosition&&(n=i-a+t,a=i);return{startAngle:n,endAngle:a}}(t),p=c.startAngle,m=c.endAngle;e.beginPath(),e.arc(0,0,o,se.radians(p),se.radians(m),!1),e.strokeStyle=t.colorBarProgress,e.lineWidth=l,e.stroke(),e.closePath()}e.restore()}function T(e){return e.options.animatedValue?e.options.value:e.value}function C(e,t,i,n,a,l,s,r,o){e.beginPath(),e.lineWidth=t,e.strokeStyle=o?se.linearGradient(e,r,o,s,!0,a):r,i>0?se.roundRect(e,n,a,l,s,i):e.rect(n,a,l,s),e.stroke(),e.closePath()}function k(e,t,i,n,a,l){var s=K.pixelRatio;e.save();var r=t.borderRadius*s,o=a-t.borderShadowWidth-t.borderOuterWidth*s,u=o-t.borderOuterWidth*s-t.borderMiddleWidth*s,h=u-t.borderMiddleWidth*s-t.borderInnerWidth*s,d=h-t.borderInnerWidth*s,c=l-t.borderShadowWidth-t.borderOuterWidth*s,p=c-t.borderOuterWidth*s-t.borderMiddleWidth*s,m=p-t.borderMiddleWidth*s-t.borderInnerWidth*s,f=m-t.borderInnerWidth*s,v=i-(u-o)/2,g=v-(h-u)/2,y=g-(d-h)/2,b=n-(p-c)/2,x=b-(m-p)/2,E=x-(f-m)/2,w=0,_=!1;return t.borderOuterWidth&&(_=se.drawShadow(e,t,_),C(e,t.borderOuterWidth*s,r,i+t.borderOuterWidth*s/2-w,n+t.borderOuterWidth*s/2-w,o,c,t.colorBorderOuter,t.colorBorderOuterEnd),w+=.5*s),t.borderMiddleWidth&&(_=se.drawShadow(e,t,_),C(e,t.borderMiddleWidth*s,r-=1+2*w,v+t.borderMiddleWidth*s/2-w,b+t.borderMiddleWidth*s/2-w,u+2*w,p+2*w,t.colorBorderMiddle,t.colorBorderMiddleEnd),w+=.5*s),t.borderInnerWidth&&(_=se.drawShadow(e,t,_),C(e,t.borderInnerWidth*s,r-=1+2*w,g+t.borderInnerWidth*s/2-w,x+t.borderInnerWidth*s/2-w,h+2*w,m+2*w,t.colorBorderInner,t.colorBorderInnerEnd),w+=.5*s),se.drawShadow(e,t,_),function(e,t,i,n,a,l,s,r){e.beginPath(),e.fillStyle=r?se.linearGradient(e,s,r,a>l?a:l,l>a,a>l?i:n):s,t>0?se.roundRect(e,i,n,a,l,t):e.rect(i,n,a,l),e.fill(),e.closePath()}(e,r,y,E,d+2*w,f+2*w,t.colorPlate,t.colorPlateEnd),e.restore(),[y,E,d,f]}function P(e,t,i,n,a,l,s){var r=function(e,t,i,n,a,l){var s=K.pixelRatio,r=l>=a,o=r?.85*a:l,u=r?l:a;i=r?te(i+(a-o)/2):i;var h=!!t.title,d=!!t.units,c=!!t.valueBox,p=void 0,m=void 0,f=void 0;r?(m=te(.05*u),p=te(.075*u),f=te(.11*u),h&&(u-=p,n+=p),d&&(u-=m),c&&(u-=f)):(m=p=te(.15*o),h&&(o-=p,n+=p),d&&(o-=m));var v=2*t.barStrokeWidth,g=t.barBeginCircle?te(o*t.barBeginCircle/200-v/2):0,y=te(o*t.barWidth/100-v),b=te(u*t.barLength/100-v),x=te((u-b)/2),E=te(i+(r?o/2:x+g)),w=te(n+(r?u-x-g+v/2:o/2)),_=!r||t.hasLeft&&t.hasRight?0:(t.hasRight?-1:1)*t.ticksWidth/100*o,U=r||t.hasLeft&&t.hasRight?0:(t.hasRight?-1:1)*t.ticksWidth/100*o;return e.barDimensions={isVertical:r,width:o,length:u,barWidth:y,barLength:b,strokeWidth:v,barMargin:x,radius:g,pixelRatio:s,barOffset:null,titleMargin:h?p:0,unitsMargin:d?m:0,get ticksLength(){return this.barLength-this.barOffset-this.strokeWidth},X:i+_,Y:n+U,x0:E+_,y0:w+U,baseX:i,baseY:n,ticksPadding:t.ticksPadding/100},e.barDimensions}(e,t,n,a,l,s),o=r.isVertical,u=r.width,h=r.barWidth,d=r.barLength,c=r.strokeWidth,p=r.barMargin,m=r.radius,f=r.x0,v=r.y0,g=r.X,y=r.Y,b=d;if(e.save(),e.beginPath(),t.barBeginCircle){var x=se.radians(o?270:0),E=Math.asin(h/2/m),w=Math.cos(E),_=Math.sin(E),U=f+(o?m*_:m*w-c/2),V=o?v-m*w:v+m*_,A=ie(o?V-v:U-f);e.barDimensions.barOffset=te(A+m);var I=o?te(f-m*_):U,S=o?V:te(v-m*_);"progress"===i&&(d=e.barDimensions.barOffset+(d-e.barDimensions.barOffset)*(se.normalizedValue(t).normal-t.minValue)/(t.maxValue-t.minValue));var T=te(U+d-e.barDimensions.barOffset+c/2),C=te(V-d+e.barDimensions.barOffset-c/2);e.arc(f,v,m,x+E,x-E),o?(e.moveTo(U,S),e.lineTo(U,C),e.lineTo(I,C),e.lineTo(I,S)):(e.moveTo(U,S),e.lineTo(T,S),e.lineTo(T,V),e.lineTo(U,V))}else{var k=te(o?g+(u-h)/2:g+p),P=te(o?y+d+p:y+(u-h)/2);"progress"===i&&(d*=(t.value-t.minValue)/(t.maxValue-t.minValue)),o?e.rect(k,P,h,-d):e.rect(k,P,d,h)}"progress"!==i&&t.barStrokeWidth&&(e.lineWidth=c,e.strokeStyle=t.colorBarStroke,e.stroke()),"progress"!==i&&t.colorBar?(e.fillStyle=t.colorBarEnd?se.linearGradient(e,t.colorBar,t.colorBarEnd,d,o,o?y:g):t.colorBar,e.fill()):"progress"===i&&t.colorBarProgress&&(e.fillStyle=t.colorBarProgressEnd?se.linearGradient(e,t.colorBarProgress,t.colorBarProgressEnd,b,o,o?y:g):t.colorBarProgress,e.fill()),e.closePath(),t.barBeginCircle&&(e.barDimensions.radius+=c),e.barDimensions.barWidth+=c,e.barDimensions.barLength+=c}function L(e,t,i,n,a,l){P(e,t,"",i,n,a,l)}function M(e,t){return t.needleSide!==e||t.tickSide!==e||t.numberSide!==e}function O(e,t,i,n,a,l){t.barProgress&&P(e,t,"progress",i,n,a,l)}function R(e,t,i,n,a){e.beginPath(),e.moveTo(t,i),e.lineTo(n,a),e.stroke(),e.closePath(),e.save()}function N(e,t,i,n,a,l,s,r,o){var u=e.barDimensions,h=u.isVertical,d=u.length,c=u.barWidth,p=u.barOffset,m=u.barMargin,f=u.pixelRatio,v=u.width,g=u.X,y=u.Y,b=u.ticksLength,x=u.ticksPadding,E=(v-c)/2,w=void 0,_=void 0,U=0,V=i.length,A=void 0,I=o*v,S=E-x*v,T=E+c+I+x*v,C=t instanceof Array?t:new Array(i.length).fill(t);e.lineWidth=r*f,e.save();for(var k=b/(a-n);U<V;U++)A=i[U],e.strokeStyle=C[U],h?(_=y+d-m-p+(n-A)*k,l&&R(e,w=g+S,_,te(w-I),_),s&&R(e,w=g+T,_,te(w-I),_)):(w=g+m+p-(n-A)*k,l&&R(e,w,_=y+S,w,te(_-I)),s&&R(e,w,te(_=y+T),w,_-I))}function D(e,t,i,n,a){e.beginPath(),e.moveTo(t,i),e.lineTo(n,a),e.stroke(),e.closePath()}function F(e,t,i,n){return t.colorNeedleEnd?se.linearGradient(e,n?t.colorNeedleEnd:t.colorNeedle,n?t.colorNeedle:t.colorNeedleEnd,i,!e.barDimensions.isVertical):t.colorNeedle}function z(e,t,i,n,a,l,s,r){e.lineWidth=t.needleWidth,e.strokeStyle=F(e,t,s,r),e.beginPath(),e.moveTo(i,n),e.lineTo(a,l),e.stroke(),e.closePath()}function B(e,t,i,n,a,l,s,r){var o=s-te(.4*s),u=i===a,h=t.needleWidth/2;e.fillStyle=F(e,t,s,r),e.beginPath(),u?(n>l&&(o*=-1),e.moveTo(i-h,n),e.lineTo(i+h,n),e.lineTo(i+h,n+o),e.lineTo(i,l),e.lineTo(i-h,n+o),e.lineTo(i-h,n)):(i>a&&(o*=-1),e.moveTo(i,n-h),e.lineTo(i,n+h),e.lineTo(i+o,n+h),e.lineTo(a,n),e.lineTo(i+o,n-h),e.lineTo(i,n-h)),e.fill(),e.closePath()}function j(e,t,i,n,a,l,s){var r=(parseFloat(t.fontValueSize)||0)*l/200,o=(.11*s-r)/2;e.barDimensions.isVertical&&se.drawValueBox(e,t,i,n+l/2,a+s-r-o,l)}var W=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,l=void 0;try{for(var s,r=e[Symbol.iterator]();!(n=(s=r.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){a=!0,l=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw l}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Y=function e(t,i,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,i);if(void 0===a){var l=Object.getPrototypeOf(t);return null===l?void 0:e(l,i,n)}if("value"in a)return a.value;var s=a.get;return void 0!==s?s.call(n):void 0},G=function e(t,i,n,a){var l=Object.getOwnPropertyDescriptor(t,i);if(void 0===l){var s=Object.getPrototypeOf(t);null!==s&&e(s,i,n,a)}else if("value"in l&&l.writable)l.value=n;else{var r=l.set;void 0!==r&&r.call(a,n)}return n},X=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var i=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(null!=a)for(var l=Object.keys(Object(a)),s=0,r=l.length;s<r;s++){var o=l[s],u=Object.getOwnPropertyDescriptor(a,o);void 0!==u&&u.enumerable&&(i[o]=a[o])}}return i}}),Array.prototype.indexOf||Object.defineProperty(Array.prototype,"indexOf",{value:function(e,t){var i;if(null===this)throw new TypeError('"this" is null or not defined');var n=Object(this),a=n.length>>>0;if(0===a)return-1;var l=+t||0;if(Math.abs(l)===1/0&&(l=0),l>=a)return-1;for(i=Math.max(l>=0?l:a-Math.abs(l),0);i<a;){if(i in n&&n[i]===e)return i;i++}return-1}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(e){if(null===this)throw new TypeError("this is null or not defined");for(var t=Object(this),i=t.length>>>0,n=arguments[1]|0,a=n<0?Math.max(i+n,0):Math.min(n,i),l=arguments[2],s=void 0===l?i:l|0,r=s<0?Math.max(i+s,0):Math.min(s,i);a<r;)t[a]=e,a++;return t}}),"undefined"==typeof window&&(window=void 0===i.g?{}:i.g);var H=function(){function e(){l(this,e),this._events={},this.addListener=this.on,this.removeListener=this.off}return X(e,[{key:"emit",value:function(e){if(this._events[e]){for(var t=0,i=this._events[e].length,n=arguments.length,a=Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];for(;t<i;t++)this._events[e][t]&&this._events[e][t].apply(this,a)}}},{key:"once",value:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(var a=0,l=i.length,s=this;a<l;a++)!function(){var t=i[a];i[a]=function i(){s.off(e,i),t.apply(s,arguments)}}();this.on.apply(this,[e].concat(i))}},{key:"on",value:function(e){this._events[e]||(this._events[e]=[]);for(var t=0,i=arguments.length<=1?0:arguments.length-1;t<i;t++)this._events[e].push(arguments.length<=t+1?void 0:arguments[t+1])}},{key:"off",value:function(e){if(this._events[e])for(var t=0,i=arguments.length<=1?0:arguments.length-1;t<i;t++)for(var n=arguments.length<=t+1?void 0:arguments[t+1],a=void 0;~(a=this._events[e].indexOf(n));)this._events[e].splice(a,1)}},{key:"removeAllListeners",value:function(e){delete this._events[e]}},{key:"listeners",get:function(){return this._events}}]),e}(),$=s("requestAnimationFrame")||function(e){return setTimeout((function(){return e((new Date).getTime())}),1e3/60)},q={linear:function(e){return e},quad:function(e){return Math.pow(e,2)},dequad:function(e){return 1-q.quad(1-e)},quint:function(e){return Math.pow(e,5)},dequint:function(e){return 1-Math.pow(1-e,5)},cycle:function(e){return 1-Math.sin(Math.acos(e))},decycle:function(e){return Math.sin(Math.acos(1-e))},bounce:function(e){return 1-q.debounce(1-e)},debounce:function(e){for(var t=0,i=1;;t+=i,i/=2)if(e>=(7-4*t)/11)return-Math.pow((11-6*t-11*e)/4,2)+Math.pow(i,2)},elastic:function(e){return 1-q.delastic(1-e)},delastic:function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*1.5/3*e)}},Z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"linear",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};if(l(this,e),this.duration=i,this.rule=t,this.draw=n,this.end=a,"function"!=typeof this.draw)throw new TypeError("Invalid animation draw callback:",n);if("function"!=typeof this.end)throw new TypeError("Invalid animation end callback:",a)}return X(e,[{key:"animate",value:function(e,t){var i=this;this.frame&&this.cancel();var n=window.performance&&window.performance.now?window.performance.now():s("animationStartTime")||Date.now();e=e||this.draw,t=t||this.end,this.draw=e,this.end=t,this.frame=$((function(a){return r(a,e,n,q[i.rule]||i.rule,i.duration,t,i)}))}},{key:"cancel",value:function(){this.frame&&((s("cancelAnimationFrame")||function(e){})(this.frame),this.frame=null)}},{key:"destroy",value:function(){this.cancel(),this.draw=null,this.end=null}}]),e}();Z.rules=q;var J=function(){function t(i,n,a){l(this,t),this.options=i,this.element=n.toLowerCase(),this.type=t.toDashed(a),this.Type=e[a],this.mutationsObserved=!1,this.isObservable=!!window.MutationObserver,window.GAUGES_NO_AUTO_INIT||t.domReady(this.traverse.bind(this))}return X(t,[{key:"isValidNode",value:function(e){return!(!e.tagName||e.tagName.toLowerCase()!==this.element||e.getAttribute("data-type")!==this.type)}},{key:"traverse",value:function(){for(var e=document.getElementsByTagName(this.element),t=0,i=e.length;t<i;t++)this.process(e[t]);this.isObservable&&!this.mutationsObserved&&(new MutationObserver(this.observe.bind(this)).observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),this.mutationsObserved=!0)}},{key:"observe",value:function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];if("attributes"===n.type&&"data-type"===n.attributeName&&this.isValidNode(n.target)&&n.oldValue!==this.type)setTimeout(this.process.bind(this,n.target));else if(n.addedNodes&&n.addedNodes.length)for(var a=0,l=n.addedNodes.length;a<l;a++)setTimeout(this.process.bind(this,n.addedNodes[a]))}}},{key:"process",value:function(e){var i=this;if(!this.isValidNode(e))return null;var n=void 0,a=JSON.parse(JSON.stringify(this.options)),l=null;for(n in a)if(a.hasOwnProperty(n)){var s=t.toAttributeName(n),r=t.parse(e.getAttribute(s));null!=r&&(a[n]=r)}return a.renderTo=e,(l=new this.Type(a)).draw&&l.draw(),this.isObservable?(l.observer=new MutationObserver((function(n){n.forEach((function(n){if("attributes"===n.type){var a=n.attributeName.toLowerCase(),s=e.getAttribute(a).toLowerCase();if("data-type"===a&&s&&s!==i.type)l.observer.disconnect(),delete l.observer,l.destroy&&l.destroy();else if("data-"===a.substr(0,5)){var r=a.substr(5).split("-").map((function(e,t){return t?e.charAt(0).toUpperCase()+e.substr(1):e})).join(""),o={};o[r]=t.parse(e.getAttribute(n.attributeName)),"value"===r?l&&(l.value=o[r]):l.update&&l.update(o)}}}))})),l.observer.observe(e,{attributes:!0}),l):l}}],[{key:"parse",value:function(e){if("true"===e)return!0;if("false"===e)return!1;if("undefined"!==e){if("null"===e)return null;if(/^[-+#.\w\d\s]+(?:,[-+#.\w\d\s]*)+$/.test(e))return e.split(",");try{return JSON.parse(e)}catch(e){}return e}}},{key:"toDashed",value:function(e){for(var t=e.split(/(?=[A-Z])/),i=1,n=t.length,a=t[0].toLowerCase();i<n;i++)a+="-"+t[i].toLowerCase();return a}},{key:"toCamelCase",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.split(/-/),n=0,a=i.length,l="";n<a;n++)l+=n||t?i[n][0].toUpperCase()+i[n].substr(1).toLowerCase():i[n].toLowerCase();return l}},{key:"toAttributeName",value:function(e){return"data-"+t.toDashed(e)}},{key:"domReady",value:function(e){if(/comp|inter|loaded/.test((window.document||{}).readyState+""))return e();window.addEventListener?window.addEventListener("DOMContentLoaded",e,!1):window.attachEvent&&window.attachEvent("onload",e)}}]),t}(),K=function(){function e(t,i,n){l(this,e),e.collection.push(this),this.width=i||0,this.height=n||0,this.element=t,this.init()}return X(e,[{key:"init",value:function(){var t=e.pixelRatio;this.element.width=this.width*t,this.element.height=this.height*t,this.element.style.width=this.width+"px",this.element.style.height=this.height+"px",this.elementClone=this.element.cloneNode(!0),this.context=this.element.getContext("2d"),this.contextClone=this.elementClone.getContext("2d"),this.drawWidth=this.element.width,this.drawHeight=this.element.height,this.drawX=this.drawWidth/2,this.drawY=this.drawHeight/2,this.minSide=this.drawX<this.drawY?this.drawX:this.drawY,this.elementClone.initialized=!1,this.contextClone.translate(this.drawX,this.drawY),this.contextClone.save(),this.context.translate(this.drawX,this.drawY),this.context.save(),this.context.max=this.contextClone.max=this.minSide,this.context.maxRadius=this.contextClone.maxRadius=null}},{key:"destroy",value:function(){var t=e.collection.indexOf(this);~t&&e.collection.splice(t,1),this.context.clearRect(-this.drawX,-this.drawY,this.drawWidth,this.drawHeight),this.context.max=null,delete this.context.max,this.context.maxRadius=null,delete this.context.maxRadius,this.context=null,this.contextClone=null,this.elementClone=null,this.element=null,this.onRedraw=null}},{key:"commit",value:function(){var t=e.pixelRatio;return 1!==t&&(this.contextClone.scale(t,t),this.contextClone.save()),this}},{key:"redraw",value:function(){return this.init(),this.onRedraw&&this.onRedraw(),this}}],[{key:"redraw",value:function(){for(var t=0,i=e.collection.length;t<i;t++)e.collection[t].redraw()}},{key:"pixelRatio",get:function(){return window.devicePixelRatio||1}}]),e}();K.collection=[],window.matchMedia&&window.matchMedia("screen and (min-resolution: 2dppx)").addListener(K.redraw);var Q={renderTo:null,width:0,height:0,minValue:0,maxValue:100,value:0,units:!1,exactTicks:!1,majorTicks:[0,20,40,60,80,100],minorTicks:10,strokeTicks:!0,animatedValue:!1,animateOnInit:!1,title:!1,borders:!0,numbersMargin:1,listeners:null,valueInt:3,valueDec:2,majorTicksInt:1,majorTicksDec:0,animation:!0,animationDuration:500,animationRule:"cycle",colorPlate:"#fff",colorPlateEnd:"",colorMajorTicks:"#444",colorMinorTicks:"#666",colorStrokeTicks:"",colorTitle:"#888",colorUnits:"#888",colorNumbers:"#444",colorNeedle:"rgba(240,128,128,1)",colorNeedleEnd:"rgba(255,160,122,.9)",colorValueText:"#444",colorValueTextShadow:"rgba(0,0,0,0.3)",colorBorderShadow:"rgba(0,0,0,0.5)",colorBorderOuter:"#ddd",colorBorderOuterEnd:"#aaa",colorBorderMiddle:"#eee",colorBorderMiddleEnd:"#f0f0f0",colorBorderInner:"#fafafa",colorBorderInnerEnd:"#ccc",colorValueBoxRect:"#888",colorValueBoxRectEnd:"#666",colorValueBoxBackground:"#babab2",colorValueBoxShadow:"rgba(0,0,0,1)",colorNeedleShadowUp:"rgba(2,255,255,0.2)",colorNeedleShadowDown:"rgba(188,143,143,0.45)",colorBarStroke:"#222",colorBar:"#ccc",colorBarProgress:"#888",colorBarShadow:"#000",fontNumbers:"Arial",fontTitle:"Arial",fontUnits:"Arial",fontValue:"Arial",fontNumbersSize:20,fontTitleSize:24,fontUnitsSize:22,fontValueSize:26,fontNumbersStyle:"normal",fontTitleStyle:"normal",fontUnitsStyle:"normal",fontValueStyle:"normal",fontNumbersWeight:"normal",fontTitleWeight:"normal",fontUnitsWeight:"normal",fontValueWeight:"normal",needle:!0,needleShadow:!0,needleType:"arrow",needleStart:5,needleEnd:85,needleWidth:4,borderOuterWidth:3,borderMiddleWidth:3,borderInnerWidth:3,borderShadowWidth:3,valueBox:!0,valueBoxStroke:5,valueBoxWidth:0,valueText:"",valueTextShadow:!0,valueBoxBorderRadius:2.5,highlights:[{from:20,to:60,color:"#eee"},{from:60,to:80,color:"#ccc"},{from:80,to:100,color:"#999"}],highlightsWidth:15,highlightsLineCap:"butt",barWidth:20,barStrokeWidth:0,barProgress:!0,barShadow:0};o.prototype=Object.create(Array.prototype),o.prototype.constructor=o,o.prototype.get=function(e){if("string"==typeof e)for(var t=0,i=this.length;t<i;t++){if((this[t].options.renderTo.tagName?this[t].options.renderTo:document.getElementById(this[t].options.renderTo||"")).getAttribute("id")===e)return this[t]}else if("number"==typeof e)return this[e];return null};var ee="2.1.7",te=Math.round,ie=Math.abs,ne=new o;ne.version=ee;var ae=function(t){function i(t){l(this,i);var a=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),s=a.constructor.name;if("BaseGauge"===s)throw new TypeError("Attempt to instantiate abstract class!");if(ne.push(a),t.listeners&&Object.keys(t.listeners).forEach((function(e){(t.listeners[e]instanceof Array?t.listeners[e]:[t.listeners[e]]).forEach((function(t){a.on(e,t)}))})),a.version=ee,a.type=e[s]||i,a.initialized=!1,t.minValue=parseFloat(t.minValue),t.maxValue=parseFloat(t.maxValue),t.value=parseFloat(t.value)||0,t.borders||(t.borderInnerWidth=t.borderMiddleWidth=t.borderOuterWidth=0),!t.renderTo)throw TypeError("Canvas element was not specified when creating the Gauge object!");var r=t.renderTo.tagName?t.renderTo:document.getElementById(t.renderTo);if(!(r instanceof HTMLCanvasElement))throw TypeError("Given gauge canvas element is invalid!");return t.width=parseFloat(t.width)||0,t.height=parseFloat(t.height)||0,t.width&&t.height||(t.width||(t.width=r.parentNode?r.parentNode.offsetWidth:r.offsetWidth),t.height||(t.height=r.parentNode?r.parentNode.offsetHeight:r.offsetHeight)),a.options=t||{},a.options.animateOnInit&&(a._value=a.options.value,a.options.value=a.options.minValue),a.canvas=new K(r,t.width,t.height),a.canvas.onRedraw=a.draw.bind(a),a.animation=new Z(t.animationRule,t.animationDuration),a}return a(i,t),X(i,[{key:"update",value:function(e){return Object.assign(this.options,this.type.configure(e||{})),this.canvas.width=this.options.width,this.canvas.height=this.options.height,this.animation.rule=this.options.animationRule,this.animation.duration=this.options.animationDuration,this.canvas.redraw(),this}},{key:"destroy",value:function(){var e=ne.indexOf(this);~e&&ne.splice(e,1),this.canvas.destroy(),this.canvas=null,this.animation.destroy(),this.animation=null,this.emit("destroy")}},{key:"draw",value:function(){return this.options.animateOnInit&&!this.initialized&&(this.value=this._value,this.initialized=!0,this.emit("init")),this.emit("render"),this}},{key:"value",set:function(e){var t=this;e=i.ensureValue(e,this.options.minValue);var n=this.options.value;if(e!==n)if(this.options.animation){if(this.animation.frame&&(this.options.value=this._value,this._value===e))return this.animation.cancel(),void delete this._value;void 0===this._value&&(this._value=e),this.emit("animationStart"),this.animation.animate((function(i){var a=n+(e-n)*i;t.options.animatedValue&&t.emit("value",a,t.value),t.options.value=a,t.draw(),t.emit("animate",i,t.options.value)}),(function(){void 0!==t._value&&(t.emit("value",t._value,t.value),t.options.value=t._value,delete t._value),t.draw(),t.emit("animationEnd")}))}else this.emit("value",e,this.value),this.options.value=e,this.draw()},get:function(){return void 0===this._value?this.options.value:this._value}}],[{key:"configure",value:function(e){return e}},{key:"initialize",value:function(e,t){return new J(t,"canvas",e)}},{key:"fromElement",value:function(e){var t=J.toCamelCase(e.getAttribute("data-type")),i=e.attributes,n=0,a=i.length,l={};if(t){for(/Gauge$/.test(t)||(t+="Gauge");n<a;n++)l[J.toCamelCase(i[n].name.replace(/^data-/,""),!1)]=J.parse(i[n].value);new J(l,e.tagName,t).process(e)}}},{key:"ensureValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e=parseFloat(e),!isNaN(e)&&isFinite(e)||(e=parseFloat(t)||0),e}},{key:"mod",value:function(e,t){return(e%t+t)%t}},{key:"version",get:function(){return ee}}]),i}(H);void 0!==e&&(e.BaseGauge=ae,e.gauges=(window.document||{}).gauges=ne);var le=/{([_a-zA-Z]+[_a-zA-Z0-9]*)}/g,se={roundRect:u,padValue:h,formatMajorTickNumber:function(e,t){var i=void 0,n=!1;return i=0===t.majorTicksDec?Math.round(e).toString():e.toFixed(t.majorTicksDec),t.majorTicksInt>1?(n=~i.indexOf("."),~i.indexOf("-")?"-"+[t.majorTicksInt+t.majorTicksDec+2+(n?1:0)-i.length].join("0")+i.replace("-",""):[t.majorTicksInt+t.majorTicksDec+1+(n?1:0)-i.length].join("0")+i):i},radians:function(e){return e*Math.PI/180},radialPoint:function(e,t){return{x:-e*Math.sin(t),y:e*Math.cos(t)}},linearGradient:function(e,t,i,n){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=e.createLinearGradient(a?0:l,a?l:0,a?0:n,a?n:0);return s.addColorStop(0,t),s.addColorStop(1,i),s},drawNeedleShadow:function(e,t){t.needleShadow&&(e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowBlur=10,e.shadowColor=t.colorNeedleShadowDown)},drawValueBox:function(e,t,i,n,a,l){if(t.valueBox){c(e);var s=t.valueDec?1+t.valueDec:0,r="9".repeat(Math.max.apply(null,[String(parseInt(i)).length+s].concat(t.majorTicks.map((function(e){return String(parseInt(e,10)).length+s}))))),o=t.valueText||h(i,t),m=l/200,f=l/100,v=.4*f,g=1.2*f;e.font=d(t,"Value",m),p(e,t,v,g);var y=e.measureText(t.valueText?o:"-"+h(Number(r),t)).width;c(e);var b=parseFloat(t.fontValueSize)*m+v+g,x=f*parseFloat(t.valueBoxStroke),E=2*l-2*x,w=y+10*f,_=1.1*b+v+g,U=f*t.valueBoxBorderRadius,V=(parseFloat(t.valueBoxWidth)||0)/100*E;V>w&&(w=V),w>E&&(w=E);var A=n-w/2,I=a-_/2,S=a-5.75*f;if(e.beginPath(),U?u(e,A,I,w,_,U):e.rect(A,I,w,_),x){var T=e.createRadialGradient(n,S,10*f,n,S,20*f);T.addColorStop(0,t.colorValueBoxRect),T.addColorStop(1,t.colorValueBoxRectEnd),e.strokeStyle=T,e.lineWidth=x,e.stroke()}t.colorValueBoxShadow&&(e.shadowBlur=1.2*f,e.shadowColor=t.colorValueBoxShadow),t.colorValueBoxBackground&&(e.fillStyle=t.colorValueBoxBackground,e.fill()),e.closePath(),e.restore(),p(e,t,v,g),e.fillStyle=t.colorValueText,e.textAlign="center",e.textBaseline="alphabetic",e.fillText(o,A+w/2,a+_/2-b/3),e.restore()}},verifyError:function(e){if(!(e instanceof DOMException&&2152923147===e.result))throw e},prepareTicks:function(e){return e.majorTicks instanceof Array||(e.majorTicks=e.majorTicks?[e.majorTicks]:[]),e.majorTicks.length||(e.majorTicks.push(se.formatMajorTickNumber(e.minValue,e)),e.majorTicks.push(se.formatMajorTickNumber(e.maxValue,e))),["right"!==e.tickSide,"left"!==e.tickSide]},drawShadow:function(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return e.restore(),!0;e.save();var i=t.borderShadowWidth;return i&&(e.shadowBlur=i,e.shadowColor=t.colorBorderShadow),!0},font:d,normalizedValue:function(e){var t=e.value,i=e.minValue,n=e.maxValue,a=.01*(n-i);return{normal:t<i?i:t>n?n:t,indented:t<i?i-a:t>n?n+a:t}},formatContext:function(e,t){return t.replace(le,(function(t,i){var n=e[i];return void 0!==n?n:t}))}},re=Math.PI,oe=re/2,ue=Object.assign({},Q,{ticksAngle:270,startAngle:45,colorNeedleCircleOuter:"#f0f0f0",colorNeedleCircleOuterEnd:"#ccc",colorNeedleCircleInner:"#e8e8e8",colorNeedleCircleInnerEnd:"#f5f5f5",needleCircleSize:10,needleCircleInner:!0,needleCircleOuter:!0,needleStart:20,animationTarget:"needle",useMinPath:!1,barWidth:0,barStartPosition:"left"}),he=function(e){function t(e){return l(this,t),e=Object.assign({},ue,e||{}),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t.configure(e)))}return a(t,e),X(t,[{key:"draw",value:function(){try{var e=this.canvas,i=[-e.drawX,-e.drawY,e.drawWidth,e.drawHeight],n=i[0],a=i[1],l=i[2],s=i[3],r=this.options;if("needle"===r.animationTarget){if(!e.elementClone.initialized){var o=e.contextClone;o.clearRect(n,a,l,s),o.save(),this.emit("beforePlate"),v(o,r),this.emit("beforeHighlights"),g(o,r),this.emit("beforeMinorTicks"),y(o,r),this.emit("beforeMajorTicks"),x(o,r),this.emit("beforeNumbers"),_(o,r),this.emit("beforeTitle"),U(o,r),this.emit("beforeUnits"),V(o,r),e.elementClone.initialized=!0}this.canvas.commit(),e.context.clearRect(n,a,l,s),e.context.save(),e.context.drawImage(e.elementClone,n,a,l,s),e.context.save(),this.emit("beforeProgressBar"),S(e.context,r),this.emit("beforeValueBox"),I(e.context,r,T(this)),this.emit("beforeNeedle"),A(e.context,r)}else{var u=-se.radians((r.value-r.minValue)/(r.maxValue-r.minValue)*r.ticksAngle);if(e.context.clearRect(n,a,l,s),e.context.save(),this.emit("beforePlate"),v(e.context,r),e.context.rotate(u),this.emit("beforeHighlights"),g(e.context,r),this.emit("beforeMinorTicks"),y(e.context,r),this.emit("beforeMajorTicks"),x(e.context,r),this.emit("beforeNumbers"),_(e.context,r),this.emit("beforeProgressBar"),S(e.context,r),e.context.rotate(-u),e.context.save(),!e.elementClone.initialized){var h=e.contextClone;h.clearRect(n,a,l,s),h.save(),this.emit("beforeTitle"),U(h,r),this.emit("beforeUnits"),V(h,r),this.emit("beforeNeedle"),A(h,r),e.elementClone.initialized=!0}e.context.drawImage(e.elementClone,n,a,l,s)}this.emit("beforeValueBox"),I(e.context,r,T(this)),Y(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}catch(e){se.verifyError(e)}return this}},{key:"value",set:function(e){e=ae.ensureValue(e,this.options.minValue),this.options.animation&&360===this.options.ticksAngle&&this.options.useMinPath&&(this._value=e,e=this.options.value+((e-this.options.value)%360+540)%360-180),G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"value",e,this)},get:function(){return Y(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"value",this)}}],[{key:"configure",value:function(e){return e.barWidth>50&&(e.barWidth=50),isNaN(e.startAngle)&&(e.startAngle=45),isNaN(e.ticksAngle)&&(e.ticksAngle=270),e.ticksAngle>360&&(e.ticksAngle=360),e.ticksAngle<0&&(e.ticksAngle=0),e.startAngle<0&&(e.startAngle=0),e.startAngle>360&&(e.startAngle=360),e}}]),t}(ae);void 0!==e&&(e.RadialGauge=he),ae.initialize("RadialGauge",ue);var de=Object.assign({},Q,{borderRadius:0,barBeginCircle:30,colorBarEnd:"",colorBarProgressEnd:"",needleWidth:6,tickSide:"both",needleSide:"both",numberSide:"both",ticksWidth:10,ticksWidthMinor:5,ticksPadding:5,barLength:85,fontTitleSize:26,highlightsWidth:10}),ce=function(e){function i(e){return l(this,i),e=Object.assign({},de,e||{}),n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,i.configure(e)))}return a(i,e),X(i,[{key:"draw",value:function(){try{var e=this.canvas,n=[-e.drawX,-e.drawY,e.drawWidth,e.drawHeight],a=n[0],l=n[1],s=n[2],r=n[3],o=this.options;if(!e.elementClone.initialized){var u=e.contextClone;u.clearRect(a,l,s,r),u.save(),this.emit("beforePlate"),this.drawBox=k(u,o,a,l,s,r),this.emit("beforeBar"),L.apply(void 0,[u,o].concat(t(this.drawBox))),e.context.barDimensions=u.barDimensions,this.emit("beforeHighlights"),function(e,t){var i=e.barDimensions,n=i.isVertical,a=i.width,l=i.length,s=i.barWidth,r=i.barOffset,o=i.barMargin,u=i.X,h=i.Y,d=i.ticksLength,c=i.ticksPadding,p=a*(parseFloat(t.highlightsWidth)||0)/100;if(t.highlights&&p){var m="right"!==t.tickSide,f="left"!==t.tickSide,v=0,g=t.highlights.length,y=(a-s)/2,b=t.maxValue-t.minValue,x=te(n?u+y:u+o+r),E=p,w=n?h+l-o-r:h+y,_=te((t.ticksWidth/100+c)*a)+(p-t.ticksWidth/100*a),U=te(s+c*a);for(e.save();v<g;v++){var V=t.highlights[v],A=d*ie(t.minValue-V.from)/b,I=d*ie((V.to-V.from)/b);e.beginPath(),e.fillStyle=V.color,n?(m&&e.rect(x-_,w-A,E,-I),f&&e.rect(x+U,w-A,E,-I)):(m&&e.rect(x+A,w-_,I,E),f&&e.rect(x+A,w+U,I,E)),e.fill(),e.closePath()}}}(u,o),this.emit("beforeMinorTicks"),function(e,t){var i=se.prepareTicks(t),n=W(i,2),a=n[0],l=n[1],s=[],r=t.minValue,o=Math.abs(t.minorTicks)||0,u=o?(t.maxValue-t.minValue)/(o*(t.majorTicks.length-1)):0;if(o)if(t.exactTicks)for(var h=ae.mod(t.majorTicks[0],o)||0;r<t.maxValue;r+=o)h+r<t.maxValue&&s.push(h+r);else for(;r<t.maxValue;r+=u)s.push(r);N(e,t.colorMinorTicks||t.colorStrokeTicks,s,t.minValue,t.maxValue,a,l,1,t.ticksWidthMinor/100)}(u,o),this.emit("beforeMajorTicks"),function(e,t){var i=se.prepareTicks(t),n=W(i,2),a=n[0],l=n[1],s=2,r=(t.maxValue-t.minValue)/(t.majorTicks.length-1),o=t.colorMajorTicks instanceof Array?t.colorMajorTicks:new Array(t.majorTicks.length).fill(t.colorStrokeTicks||t.colorMajorTicks);if(N(e,o,t.exactTicks?t.majorTicks:t.majorTicks.map((function(e,i){return t.minValue+r*i})),t.minValue,t.maxValue,a,l,s,t.ticksWidth/100),t.strokeTicks){var u=e.barDimensions,h=u.isVertical,d=u.length,c=u.width,p=u.barWidth,m=u.barMargin,f=u.barOffset,v=u.X,g=u.Y,y=u.ticksLength,b=u.pixelRatio,x=u.ticksPadding,E=(c-p)/2+p+x*c,w=(c-p)/2-x*c,_=void 0,U=void 0,V=void 0,A=void 0;e.strokeStyle=t.colorStrokeTicks||o[0],s*=b,h?(A=(U=g+d-m-f+s/2)-y-s,a&&(V=_=te(v+w),D(e,_,U,V,A)),l&&(V=_=te(v+E),D(e,_,U,V,A))):(V=(_=v+m+f-s/2)+y+s,a&&(A=U=te(g+w),D(e,_,U,V,A)),l&&(A=U=te(g+E),D(e,_,U,V,A)))}}(u,o),this.emit("beforeNumbers"),function(e,t){var i=e.barDimensions,n=i.isVertical,a=i.length,l=i.width,s=i.barWidth,r=i.barMargin,o=i.barOffset,u=i.X,h=i.Y,d=i.ticksLength,c=i.ticksPadding,p=t.maxValue-t.minValue,m=p/(t.majorTicks.length-1),f=t.exactTicks?t.majorTicks:t.majorTicks.map((function(e,i){return t.minValue+m*i})),v=f.length,g="right"!==t.numberSide,y="left"!==t.numberSide,b=t.fontNumbersSize*l/200,x=0,E=(t.ticksWidth/100+2*c)*l,w=(l-s)/2-E,_=(l-s)/2+s+E,U=void 0,V=void 0,A=void 0,I=void 0,S=t.colorNumbers instanceof Array?t.colorNumbers:new Array(v).fill(t.colorNumbers),T=t.numbersMargin/100*l;for(e.font=se.font(t,"Numbers",l/200),e.lineWidth=0,e.textAlign="center";x<v;x++)e.fillStyle=S[x],I=t.majorTicks[x],A=t.exactTicks?d*((f[x]-t.minValue)/p):x*d/(v-1),n?(V=h+a-r-o-A+b/3,g&&(e.textAlign="right",e.fillText(I,u+w-T,V)),y&&(e.textAlign="left",e.fillText(I,u+_+T,V))):(e.measureText(I).width,U=u+r+o+A,g&&e.fillText(I,U,h+w-T),y&&e.fillText(I,U,h+_+b+T))}(u,o),this.emit("beforeTitle"),function(e,t){if(t.title){var i=e.barDimensions,n=i.isVertical,a=i.width,l=i.length,s=i.baseX,r=i.baseY,o=i.titleMargin,u=t.fontTitleSize*a/200,h=te(s+(n?a:l)/2),d=te(r+o/2-(n?u:u/2)-.025*(n?l:a));e.save(),e.textAlign="center",e.fillStyle=t.colorTitle,e.font=se.font(t,"Title",a/200),e.lineWidth=0,e.fillText(t.title,h,d,n?a:l)}}(u,o),this.emit("beforeUnits"),function(e,t){if(t.units){var i=e.barDimensions,n=i.isVertical,a=i.width,l=i.length,s=i.baseX,r=i.baseY,o=i.unitsMargin,u=t.fontUnitsSize*a/200,h=te(s+(n?a:l)/2),d=te(r+(n?l:a)+o/2-u/2);e.save(),e.textAlign="center",e.fillStyle=t.colorUnits,e.font=se.font(t,"Units",a/200),e.lineWidth=0,e.fillText(se.formatContext(t,t.units),h,d,n?a:l)}}(u,o),e.elementClone.initialized=!0}this.canvas.commit(),e.context.clearRect(a,l,s,r),e.context.save(),e.context.drawImage(e.elementClone,a,l,s,r),e.context.save(),this.emit("beforeProgressBar"),O.apply(void 0,[e.context,o].concat(t(this.drawBox))),this.emit("beforeNeedle"),function(e,t){if(t.needle){var i=e.barDimensions,n=i.isVertical,a=i.width,l=i.length,s=i.barWidth,r=i.barOffset,o=i.barMargin,u=i.ticksLength,h=i.X,d=i.Y,c=i.ticksPadding,p="right"!==t.needleSide,m="left"!==t.needleSide,f=u*(se.normalizedValue(t).indented-t.minValue)/(t.maxValue-t.minValue),v=(t.ticksWidth/100+c)*a,g=s/2+v,y=g*(t.needleEnd/100),b=void 0,x=void 0,E="arrow"===t.needleType.toLowerCase()?B:z,w=(a-s)/2,_=g*(t.needleStart/100),U=w-v-_,V=w+s+v+_;e.save(),se.drawNeedleShadow(e,t),n?(x=te(d+l-o-r-f),p&&E(e,t,b=te(h+U),x,b+y,x,y),m&&E(e,t,b=te(h+V),x,b-y,x,y,!0)):(b=te(h+o+r+f),p&&E(e,t,b,x=te(d+U),b,x+y,y),m&&E(e,t,b,x=te(d+V),b,x-y,y,!0)),e.restore()}}(e.context,o),this.emit("beforeValueBox"),j.apply(void 0,[e.context,o,o.animatedValue?this.options.value:this.value].concat(t(this.drawBox))),Y(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"draw",this).call(this)}catch(e){se.verifyError(e)}return this}}],[{key:"configure",value:function(e){return e.barStrokeWidth>=e.barWidth&&(e.barStrokeWidth=te(e.barWidth/2)),e.hasLeft=M("right",e),e.hasRight=M("left",e),e.value>e.maxValue&&(e.value=e.maxValue),e.value<e.minValue&&(e.value=e.minValue),ae.configure(e)}}]),i}(ae);void 0!==e&&(e.LinearGauge=ce),ae.initialize("LinearGauge",de),Object.assign(e,{Collection:o,GenericOptions:Q,Animation:Z,BaseGauge:ae,drawings:se,SmartCanvas:K,DomObserver:J,vendorize:s})}(e.exports)},742:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2000 3000'%3e%3cg fill='none' stroke='%23000' stroke-linecap='round'%3e%3cpath d='M522.074-47.572v-46.75m0 121v-46.75m-653.125-239.25h-61.875m116.875 0h-55m426.25 0h-55m116.875 0h-61.875m-488.125 451h550m-550-451c-91.127 0-165 73.873-165 165m0 0v46.75m-24.75 0h24.75m-24.75 0v27.5m0 0h24.75m0 0v46.75m0 0c0 91.127 73.873 165 165 165m550 0c91.127 0 165-73.873 165-165m0-46.75h24.75m0-27.5v27.5m-24.75-27.5h24.75m-24.75-46.75c0-91.127-73.873-165-165-165m-433.125-52.25v52.25m316.25 0v-52.25m0 0h-316.25m144.375 379.5h27.5m0-17.6h-27.5m27.5 17.6v-17.6m-27.5 0v17.6m0-121h27.5m0-17.6h-27.5m27.5 17.6v-17.6m-27.5 0v17.6m-247.5-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m96.25-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m68.75 0h27.5m0-17.6h-27.5m27.5 17.6v-17.6m-27.5 0v17.6m96.25-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m165-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m68.75 121h27.5m0-17.6h-27.5m27.5 17.6v-17.6m-27.5 0v17.6m-316.25-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m68.75 0h27.5m0-17.6h-27.5m27.5 17.6v-17.6m-27.5 0v17.6m96.25-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m165-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m-343.75 0h27.5m0-17.6h-27.5m27.5 17.6v-17.6m-27.5 0v17.6m412.5-121h27.5m0-17.6h-27.5m27.5 17.6v-17.6m-27.5 0v17.6m96.25-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m96.25-17.6h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m-41.25 103.4h-27.5m0 17.6h27.5m0 0v-17.6m-27.5 0v17.6m68.75 0h27.5m0-17.6h-27.5m27.5 17.6v-17.6m-27.5 0v17.6m361.771 66h168.42m-168.42 16.5v-16.5m168.42 0v16.5m0 0h-168.42m325.195-9.68v-442.151m0 0v-34.925m-2062.32 34.925v-34.925m34.921-34.925H995.362m34.928 302.451h292.25m0 0H1397M995.362-371.253c19.288 0 34.928 15.637 34.928 34.925M-1032.03-200.84v4.212m34.921-174.625c-19.291 0-34.921 15.637-34.921 34.925m-290.51 267.526h290.51m-364.97 0h74.46m2352.83 209.55v90.805m0 0v69.85m0 69.85h292.25m-309.72 0h17.47m-17.46 0h-17.467M-1032.03 140.748v90.805m2062.32 69.85v34.925m-2043.11 34.925h15.711m1992.472 0H-997.109m2319.649 0H1397m-2429.03-139.7v69.85m2027.392 69.85c19.288 0 34.928-15.637 34.928-34.925m-2062.32 34.925h19.21m-309.72 0h290.51m0-69.85v34.925M-1397 371.253h74.46m325.431 0c-19.291 0-34.921-15.637-34.921-34.925m0-195.58V-200.84m0 0v-100.563m0 0v-34.925M1397-68.802v209.55m-2794-209.55v209.55m2794 0v230.505m-2794-230.505v230.505m2064.755-219.45v-19.25m0 0c0-17.922 14.528-32.45 32.45-32.45m0 0h178.2m0 0c17.922 0 32.45 14.528 32.45 32.45m0 0v19.25m0 0c0 17.921-14.528 32.45-32.45 32.45m0 0h-178.2m0 0c-17.922 0-32.45-14.529-32.45-32.45' style='stroke-width:20' transform='rotate(-90 1257.48 247.162)'/%3e%3cpath d='M995.362 371.253c19.288 0 34.928-15.637 34.928-34.925m-2027.399 34.925c-19.291 0-34.921-15.637-34.921-34.925' style='stroke-width:20' transform='rotate(-90 1257.48 247.162)'/%3e%3c/g%3e%3c/svg%3e"}},t={};function i(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,i),l.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{"use strict";i.p;function e(e,i){!function(e,i){var n,a;n=new Blob([e],{type:"text/plain"}),t(a=window.URL.createObjectURL(n),i),setTimeout((function(){return window.URL.revokeObjectURL(a)}),1e3)}(JSON.stringify(e),i)}function t(e,t){var i;(i=document.createElement("a")).href=e,i.download=t,document.body.appendChild(i),i.style="display: none",i.click(),i.remove()}const n={};var a=i(742),l=i.n(a);n.ESP32C6_Expander={name:"ESP32C6 Expander",Overlay:l(),OverlayWidth:610,OverlayElementHeight:25,CANBusCount:2,Pins:[{name:"1",value:1,supportedModes:"digitalin digitalout analog pwmout",overlayX:450,overlayY:345,align:"right"},{name:"3",value:3,supportedModes:"digitalin digitalout analog pwmout",overlayX:450,overlayY:391,align:"right"},{name:"4",value:4,supportedModes:"digitalin digitalout analog pwmout",overlayX:450,overlayY:414,align:"right"},{name:"5",value:5,supportedModes:"digitalin digitalout digitalinterrupt analog pwmout",overlayX:450,overlayY:437,align:"right"},{name:"6",value:6,supportedModes:"digitalin digitalout digitalinterrupt analog pwmout",overlayX:450,overlayY:460,align:"right"},{name:"7",value:7,supportedModes:"digitalin digitalout digitalinterrupt analog pwmout",overlayX:450,overlayY:483,align:"right"},{name:"10",value:10,supportedModes:"digitalout pwmout",overlayX:450,overlayY:345,align:"left"},{name:"13",value:14,supportedModes:"digitalin digitalout",overlayX:450,overlayY:414,align:"left"},{name:"14",value:14,supportedModes:"digitalin digitalout",overlayX:450,overlayY:437,align:"left"},{name:"16",value:16,supportedModes:"digitalin digitalout digitalinterrupt analog pwmout",overlayX:450,overlayY:483,align:"left"}],Type:"TopExpander",Burn:function(e){!function(e,t){const i=JSON.stringify(e.saveValue),n=buildConfig({...e.value,type:t});window.localStorage.setItem("config",i);const a=pako.gzip((new TextEncoder).encode(i));let l=new XMLHttpRequest;l.open("POST","/upload/config.json.gz",!0),l.setRequestHeader("Content-Type","application/octet-stream"),l.onreadystatechange=()=>{4==l.readyState&&(200==l.status?alert("Saved Configuration to Device"):alert("Saved Configuration to Browser"))},l.send(a),l=new XMLHttpRequest,l.open("POST","/upload/config.bin",!0),l.setRequestHeader("Content-Type","application/octet-stream"),l.onreadystatechange=()=>{4==l.readyState&&200==l.status&&(l.open("POST","/command/reset",!0),l.send(),alert("Saved Binary to Device"),window.location.reload())},l.send(n)}(e,this.Type)}};function s(e){let t=e.length;for(;--t>=0;)e[t]=0}const r=256,o=286,u=30,h=15,d=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),c=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),p=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),m=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=new Array(576);s(f);const v=new Array(60);s(v);const g=new Array(512);s(g);const y=new Array(256);s(y);const x=new Array(29);s(x);const E=new Array(u);function w(e,t,i,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}let _,U,V;function A(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}s(E);const I=e=>e<256?g[e]:g[256+(e>>>7)],S=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},T=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,S(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},C=(e,t,i)=>{T(e,i[2*t],i[2*t+1])},k=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},P=(e,t,i)=>{const n=new Array(16);let a,l,s=0;for(a=1;a<=h;a++)s=s+i[a-1]<<1,n[a]=s;for(l=0;l<=t;l++){let t=e[2*l+1];0!==t&&(e[2*l]=k(n[t]++,t))}},L=e=>{let t;for(t=0;t<o;t++)e.dyn_ltree[2*t]=0;for(t=0;t<u;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},M=e=>{e.bi_valid>8?S(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},O=(e,t,i,n)=>{const a=2*t,l=2*i;return e[a]<e[l]||e[a]===e[l]&&n[t]<=n[i]},R=(e,t,i)=>{const n=e.heap[i];let a=i<<1;for(;a<=e.heap_len&&(a<e.heap_len&&O(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!O(t,n,e.heap[a],e.depth));)e.heap[i]=e.heap[a],i=a,a<<=1;e.heap[i]=n},N=(e,t,i)=>{let n,a,l,s,o=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+o++],n+=(255&e.pending_buf[e.sym_buf+o++])<<8,a=e.pending_buf[e.sym_buf+o++],0===n?C(e,a,t):(l=y[a],C(e,l+r+1,t),s=d[l],0!==s&&(a-=x[l],T(e,a,s)),n--,l=I(n),C(e,l,i),s=c[l],0!==s&&(n-=E[l],T(e,n,s)))}while(o<e.sym_next);C(e,256,t)},D=(e,t)=>{const i=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems;let s,r,o,u=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<l;s++)0!==i[2*s]?(e.heap[++e.heap_len]=u=s,e.depth[s]=0):i[2*s+1]=0;for(;e.heap_len<2;)o=e.heap[++e.heap_len]=u<2?++u:0,i[2*o]=1,e.depth[o]=0,e.opt_len--,a&&(e.static_len-=n[2*o+1]);for(t.max_code=u,s=e.heap_len>>1;s>=1;s--)R(e,i,s);o=l;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],R(e,i,1),r=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=r,i[2*o]=i[2*s]+i[2*r],e.depth[o]=(e.depth[s]>=e.depth[r]?e.depth[s]:e.depth[r])+1,i[2*s+1]=i[2*r+1]=o,e.heap[1]=o++,R(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,n=t.max_code,a=t.stat_desc.static_tree,l=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,r=t.stat_desc.extra_base,o=t.stat_desc.max_length;let u,d,c,p,m,f,v=0;for(p=0;p<=h;p++)e.bl_count[p]=0;for(i[2*e.heap[e.heap_max]+1]=0,u=e.heap_max+1;u<573;u++)d=e.heap[u],p=i[2*i[2*d+1]+1]+1,p>o&&(p=o,v++),i[2*d+1]=p,d>n||(e.bl_count[p]++,m=0,d>=r&&(m=s[d-r]),f=i[2*d],e.opt_len+=f*(p+m),l&&(e.static_len+=f*(a[2*d+1]+m)));if(0!==v){do{for(p=o-1;0===e.bl_count[p];)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[o]--,v-=2}while(v>0);for(p=o;0!==p;p--)for(d=e.bl_count[p];0!==d;)c=e.heap[--u],c>n||(i[2*c+1]!==p&&(e.opt_len+=(p-i[2*c+1])*i[2*c],i[2*c+1]=p),d--)}})(e,t),P(i,u,e.bl_count)},F=(e,t,i)=>{let n,a,l=-1,s=t[1],r=0,o=7,u=4;for(0===s&&(o=138,u=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)a=s,s=t[2*(n+1)+1],++r<o&&a===s||(r<u?e.bl_tree[2*a]+=r:0!==a?(a!==l&&e.bl_tree[2*a]++,e.bl_tree[32]++):r<=10?e.bl_tree[34]++:e.bl_tree[36]++,r=0,l=a,0===s?(o=138,u=3):a===s?(o=6,u=3):(o=7,u=4))},z=(e,t,i)=>{let n,a,l=-1,s=t[1],r=0,o=7,u=4;for(0===s&&(o=138,u=3),n=0;n<=i;n++)if(a=s,s=t[2*(n+1)+1],!(++r<o&&a===s)){if(r<u)do{C(e,a,e.bl_tree)}while(0!=--r);else 0!==a?(a!==l&&(C(e,a,e.bl_tree),r--),C(e,16,e.bl_tree),T(e,r-3,2)):r<=10?(C(e,17,e.bl_tree),T(e,r-3,3)):(C(e,18,e.bl_tree),T(e,r-11,7));r=0,l=a,0===s?(o=138,u=3):a===s?(o=6,u=3):(o=7,u=4)}};let B=!1;const j=(e,t,i,n)=>{T(e,0+(n?1:0),3),M(e),S(e,i),S(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i};var W=(e,t,i,n)=>{let a,l,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<r;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),D(e,e.l_desc),D(e,e.d_desc),s=(e=>{let t;for(F(e,e.dyn_ltree,e.l_desc.max_code),F(e,e.dyn_dtree,e.d_desc.max_code),D(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*m[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),a=e.opt_len+3+7>>>3,l=e.static_len+3+7>>>3,l<=a&&(a=l)):a=l=i+5,i+4<=a&&-1!==t?j(e,t,i,n):4===e.strategy||l===a?(T(e,2+(n?1:0),3),N(e,f,v)):(T(e,4+(n?1:0),3),((e,t,i,n)=>{let a;for(T(e,t-257,5),T(e,i-1,5),T(e,n-4,4),a=0;a<n;a++)T(e,e.bl_tree[2*m[a]+1],3);z(e,e.dyn_ltree,t-1),z(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),N(e,e.dyn_ltree,e.dyn_dtree)),L(e),n&&M(e)},Y={_tr_init:e=>{B||((()=>{let e,t,i,n,a;const l=new Array(16);for(i=0,n=0;n<28;n++)for(x[n]=i,e=0;e<1<<d[n];e++)y[i++]=n;for(y[i-1]=n,a=0,n=0;n<16;n++)for(E[n]=a,e=0;e<1<<c[n];e++)g[a++]=n;for(a>>=7;n<u;n++)for(E[n]=a<<7,e=0;e<1<<c[n]-7;e++)g[256+a++]=n;for(t=0;t<=h;t++)l[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,l[8]++;for(;e<=255;)f[2*e+1]=9,e++,l[9]++;for(;e<=279;)f[2*e+1]=7,e++,l[7]++;for(;e<=287;)f[2*e+1]=8,e++,l[8]++;for(P(f,287,l),e=0;e<u;e++)v[2*e+1]=5,v[2*e]=k(e,5);_=new w(f,d,257,o,h),U=new w(v,c,0,u,h),V=new w(new Array(0),p,0,19,7)})(),B=!0),e.l_desc=new A(e.dyn_ltree,_),e.d_desc=new A(e.dyn_dtree,U),e.bl_desc=new A(e.bl_tree,V),e.bi_buf=0,e.bi_valid=0,L(e)},_tr_stored_block:j,_tr_flush_block:W,_tr_tally:(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(y[i]+r+1)]++,e.dyn_dtree[2*I(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{T(e,2,3),C(e,256,f),(e=>{16===e.bi_valid?(S(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var G=(e,t,i,n)=>{let a=65535&e,l=e>>>16&65535,s=0;for(;0!==i;){s=i>2e3?2e3:i,i-=s;do{a=a+t[n++]|0,l=l+a|0}while(--s);a%=65521,l%=65521}return a|l<<16};const X=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());var H=(e,t,i,n)=>{const a=X,l=n+i;e^=-1;for(let i=n;i<l;i++)e=e>>>8^a[255&(e^t[i])];return~e},$={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},q={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Z,_tr_stored_block:J,_tr_flush_block:K,_tr_tally:Q,_tr_align:ee}=Y,{Z_NO_FLUSH:te,Z_PARTIAL_FLUSH:ie,Z_FULL_FLUSH:ne,Z_FINISH:ae,Z_BLOCK:le,Z_OK:se,Z_STREAM_END:re,Z_STREAM_ERROR:oe,Z_DATA_ERROR:ue,Z_BUF_ERROR:he,Z_DEFAULT_COMPRESSION:de,Z_FILTERED:ce,Z_HUFFMAN_ONLY:pe,Z_RLE:me,Z_FIXED:fe,Z_DEFAULT_STRATEGY:ve,Z_UNKNOWN:ge,Z_DEFLATED:ye}=q,be=258,xe=262,Ee=42,we=113,_e=666,Ue=(e,t)=>(e.msg=$[t],t),Ve=e=>2*e-(e>4?9:0),Ae=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Ie=e=>{let t,i,n,a=e.w_size;t=e.hash_size,n=t;do{i=e.head[--n],e.head[n]=i>=a?i-a:0}while(--t);t=a,n=t;do{i=e.prev[--n],e.prev[n]=i>=a?i-a:0}while(--t)};let Se=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const Te=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},Ce=(e,t)=>{K(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Te(e.strm)},ke=(e,t)=>{e.pending_buf[e.pending++]=t},Pe=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Le=(e,t,i,n)=>{let a=e.avail_in;return a>n&&(a=n),0===a?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),i),1===e.state.wrap?e.adler=G(e.adler,t,a,i):2===e.state.wrap&&(e.adler=H(e.adler,t,a,i)),e.next_in+=a,e.total_in+=a,a)},Me=(e,t)=>{let i,n,a=e.max_chain_length,l=e.strstart,s=e.prev_length,r=e.nice_match;const o=e.strstart>e.w_size-xe?e.strstart-(e.w_size-xe):0,u=e.window,h=e.w_mask,d=e.prev,c=e.strstart+be;let p=u[l+s-1],m=u[l+s];e.prev_length>=e.good_match&&(a>>=2),r>e.lookahead&&(r=e.lookahead);do{if(i=t,u[i+s]===m&&u[i+s-1]===p&&u[i]===u[l]&&u[++i]===u[l+1]){l+=2,i++;do{}while(u[++l]===u[++i]&&u[++l]===u[++i]&&u[++l]===u[++i]&&u[++l]===u[++i]&&u[++l]===u[++i]&&u[++l]===u[++i]&&u[++l]===u[++i]&&u[++l]===u[++i]&&l<c);if(n=be-(c-l),l=c-be,n>s){if(e.match_start=t,s=n,n>=r)break;p=u[l+s-1],m=u[l+s]}}}while((t=d[t&h])>o&&0!=--a);return s<=e.lookahead?s:e.lookahead},Oe=e=>{const t=e.w_size;let i,n,a;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-xe)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Ie(e),n+=t),0===e.strm.avail_in)break;if(i=Le(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=i,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=Se(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=Se(e,e.ins_h,e.window[a+3-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<xe&&0!==e.strm.avail_in)},Re=(e,t)=>{let i,n,a,l=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,r=e.strm.avail_in;do{if(i=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a)break;if(a=e.strm.avail_out-a,n=e.strstart-e.block_start,i>n+e.strm.avail_in&&(i=n+e.strm.avail_in),i>a&&(i=a),i<l&&(0===i&&t!==ae||t===te||i!==n+e.strm.avail_in))break;s=t===ae&&i===n+e.strm.avail_in?1:0,J(e,0,0,s),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,Te(e.strm),n&&(n>i&&(n=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,i-=n),i&&(Le(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===s);return r-=e.strm.avail_in,r&&(r>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=r&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-r,e.strm.next_in),e.strstart),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==te&&t!==ae&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(Le(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,l=a>e.w_size?e.w_size:a,n=e.strstart-e.block_start,(n>=l||(n||t===ae)&&t!==te&&0===e.strm.avail_in&&n<=a)&&(i=n>a?a:n,s=t===ae&&0===e.strm.avail_in&&i===n?1:0,J(e,e.block_start,i,s),e.block_start+=i,Te(e.strm)),s?3:1)},Ne=(e,t)=>{let i,n;for(;;){if(e.lookahead<xe){if(Oe(e),e.lookahead<xe&&t===te)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=Se(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-xe&&(e.match_length=Me(e,i)),e.match_length>=3)if(n=Q(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Se(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Se(e,e.ins_h,e.window[e.strstart+1]);else n=Q(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Ce(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ae?(Ce(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ce(e,!1),0===e.strm.avail_out)?1:2},De=(e,t)=>{let i,n,a;for(;;){if(e.lookahead<xe){if(Oe(e),e.lookahead<xe&&t===te)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=Se(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-xe&&(e.match_length=Me(e,i),e.match_length<=5&&(e.strategy===ce||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,n=Q(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=Se(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(Ce(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=Q(e,0,e.window[e.strstart-1]),n&&Ce(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Q(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ae?(Ce(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ce(e,!1),0===e.strm.avail_out)?1:2};function Fe(e,t,i,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=a}const ze=[new Fe(0,0,0,0,Re),new Fe(4,4,8,4,Ne),new Fe(4,5,16,8,Ne),new Fe(4,6,32,32,Ne),new Fe(4,4,16,16,De),new Fe(8,16,32,32,De),new Fe(8,16,128,128,De),new Fe(8,32,128,256,De),new Fe(32,128,258,1024,De),new Fe(32,258,258,4096,De)];function Be(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ye,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Ae(this.dyn_ltree),Ae(this.dyn_dtree),Ae(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Ae(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Ae(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const je=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Ee&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==we&&t.status!==_e?1:0},We=e=>{if(je(e))return Ue(e,oe);e.total_in=e.total_out=0,e.data_type=ge;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Ee:we,e.adler=2===t.wrap?0:1,t.last_flush=-2,Z(t),se},Ye=e=>{const t=We(e);var i;return t===se&&((i=e.state).window_size=2*i.w_size,Ae(i.head),i.max_lazy_match=ze[i.level].max_lazy,i.good_match=ze[i.level].good_length,i.nice_match=ze[i.level].nice_length,i.max_chain_length=ze[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},Ge=(e,t,i,n,a,l)=>{if(!e)return oe;let s=1;if(t===de&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),a<1||a>9||i!==ye||n<8||n>15||t<0||t>9||l<0||l>fe||8===n&&1!==s)return Ue(e,oe);8===n&&(n=9);const r=new Be;return e.state=r,r.strm=e,r.status=Ee,r.wrap=s,r.gzhead=null,r.w_bits=n,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=a+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+3-1)/3),r.window=new Uint8Array(2*r.w_size),r.head=new Uint16Array(r.hash_size),r.prev=new Uint16Array(r.w_size),r.lit_bufsize=1<<a+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new Uint8Array(r.pending_buf_size),r.sym_buf=r.lit_bufsize,r.sym_end=3*(r.lit_bufsize-1),r.level=t,r.strategy=l,r.method=i,Ye(e)};var Xe=(e,t)=>{if(je(e)||t>le||t<0)return e?Ue(e,oe):oe;const i=e.state;if(!e.output||0!==e.avail_in&&!e.input||i.status===_e&&t!==ae)return Ue(e,0===e.avail_out?he:oe);const n=i.last_flush;if(i.last_flush=t,0!==i.pending){if(Te(e),0===e.avail_out)return i.last_flush=-1,se}else if(0===e.avail_in&&Ve(t)<=Ve(n)&&t!==ae)return Ue(e,he);if(i.status===_e&&0!==e.avail_in)return Ue(e,he);if(i.status===Ee&&0===i.wrap&&(i.status=we),i.status===Ee){let t=ye+(i.w_bits-8<<4)<<8,n=-1;if(n=i.strategy>=pe||i.level<2?0:i.level<6?1:6===i.level?2:3,t|=n<<6,0!==i.strstart&&(t|=32),t+=31-t%31,Pe(i,t),0!==i.strstart&&(Pe(i,e.adler>>>16),Pe(i,65535&e.adler)),e.adler=1,i.status=we,Te(e),0!==i.pending)return i.last_flush=-1,se}if(57===i.status)if(e.adler=0,ke(i,31),ke(i,139),ke(i,8),i.gzhead)ke(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ke(i,255&i.gzhead.time),ke(i,i.gzhead.time>>8&255),ke(i,i.gzhead.time>>16&255),ke(i,i.gzhead.time>>24&255),ke(i,9===i.level?2:i.strategy>=pe||i.level<2?4:0),ke(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(ke(i,255&i.gzhead.extra.length),ke(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=H(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(ke(i,0),ke(i,0),ke(i,0),ke(i,0),ke(i,0),ke(i,9===i.level?2:i.strategy>=pe||i.level<2?4:0),ke(i,3),i.status=we,Te(e),0!==i.pending)return i.last_flush=-1,se;if(69===i.status){if(i.gzhead.extra){let t=i.pending,n=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+n>i.pending_buf_size;){let a=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+a),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=H(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=a,Te(e),0!==i.pending)return i.last_flush=-1,se;t=0,n-=a}let a=new Uint8Array(i.gzhead.extra);i.pending_buf.set(a.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending+=n,i.gzhead.hcrc&&i.pending>t&&(e.adler=H(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let t,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(e.adler=H(e.adler,i.pending_buf,i.pending-n,n)),Te(e),0!==i.pending)return i.last_flush=-1,se;n=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,ke(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>n&&(e.adler=H(e.adler,i.pending_buf,i.pending-n,n)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let t,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(e.adler=H(e.adler,i.pending_buf,i.pending-n,n)),Te(e),0!==i.pending)return i.last_flush=-1,se;n=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,ke(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>n&&(e.adler=H(e.adler,i.pending_buf,i.pending-n,n))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Te(e),0!==i.pending))return i.last_flush=-1,se;ke(i,255&e.adler),ke(i,e.adler>>8&255),e.adler=0}if(i.status=we,Te(e),0!==i.pending)return i.last_flush=-1,se}if(0!==e.avail_in||0!==i.lookahead||t!==te&&i.status!==_e){let n=0===i.level?Re(i,t):i.strategy===pe?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(Oe(e),0===e.lookahead)){if(t===te)return 1;break}if(e.match_length=0,i=Q(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(Ce(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ae?(Ce(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ce(e,!1),0===e.strm.avail_out)?1:2})(i,t):i.strategy===me?((e,t)=>{let i,n,a,l;const s=e.window;for(;;){if(e.lookahead<=be){if(Oe(e),e.lookahead<=be&&t===te)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(a=e.strstart-1,n=s[a],n===s[++a]&&n===s[++a]&&n===s[++a])){l=e.strstart+be;do{}while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<l);e.match_length=be-(l-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=Q(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=Q(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(Ce(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ae?(Ce(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ce(e,!1),0===e.strm.avail_out)?1:2})(i,t):ze[i.level].func(i,t);if(3!==n&&4!==n||(i.status=_e),1===n||3===n)return 0===e.avail_out&&(i.last_flush=-1),se;if(2===n&&(t===ie?ee(i):t!==le&&(J(i,0,0,!1),t===ne&&(Ae(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),Te(e),0===e.avail_out))return i.last_flush=-1,se}return t!==ae?se:i.wrap<=0?re:(2===i.wrap?(ke(i,255&e.adler),ke(i,e.adler>>8&255),ke(i,e.adler>>16&255),ke(i,e.adler>>24&255),ke(i,255&e.total_in),ke(i,e.total_in>>8&255),ke(i,e.total_in>>16&255),ke(i,e.total_in>>24&255)):(Pe(i,e.adler>>>16),Pe(i,65535&e.adler)),Te(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?se:re)},He={deflateInit:(e,t)=>Ge(e,t,ye,15,8,ve),deflateInit2:Ge,deflateReset:Ye,deflateResetKeep:We,deflateSetHeader:(e,t)=>je(e)||2!==e.state.wrap?oe:(e.state.gzhead=t,se),deflate:Xe,deflateEnd:e=>{if(je(e))return oe;const t=e.state.status;return e.state=null,t===we?Ue(e,ue):se},deflateSetDictionary:(e,t)=>{let i=t.length;if(je(e))return oe;const n=e.state,a=n.wrap;if(2===a||1===a&&n.status!==Ee||n.lookahead)return oe;if(1===a&&(e.adler=G(e.adler,t,i,0)),n.wrap=0,i>=n.w_size){0===a&&(Ae(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(i-n.w_size,i),0),t=e,i=n.w_size}const l=e.avail_in,s=e.next_in,r=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,Oe(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=Se(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,Oe(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=s,e.input=r,e.avail_in=l,n.wrap=a,se},deflateInfo:"pako deflate (from Nodeca project)"};const $e=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var qe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const t in i)$e(i,t)&&(e[t]=i[t])}}return e},Ze=e=>{let t=0;for(let i=0,n=e.length;i<n;i++)t+=e[i].length;const i=new Uint8Array(t);for(let t=0,n=0,a=e.length;t<a;t++){let a=e[t];i.set(a,n),n+=a.length}return i};let Je=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Je=!1}const Ke=new Uint8Array(256);for(let e=0;e<256;e++)Ke[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Ke[254]=Ke[254]=1;var Qe=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,n,a,l,s=e.length,r=0;for(a=0;a<s;a++)i=e.charCodeAt(a),55296==(64512&i)&&a+1<s&&(n=e.charCodeAt(a+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),a++)),r+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(r),l=0,a=0;l<r;a++)i=e.charCodeAt(a),55296==(64512&i)&&a+1<s&&(n=e.charCodeAt(a+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),a++)),i<128?t[l++]=i:i<2048?(t[l++]=192|i>>>6,t[l++]=128|63&i):i<65536?(t[l++]=224|i>>>12,t[l++]=128|i>>>6&63,t[l++]=128|63&i):(t[l++]=240|i>>>18,t[l++]=128|i>>>12&63,t[l++]=128|i>>>6&63,t[l++]=128|63&i);return t},et=(e,t)=>{const i=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,a;const l=new Array(2*i);for(a=0,n=0;n<i;){let t=e[n++];if(t<128){l[a++]=t;continue}let s=Ke[t];if(s>4)l[a++]=65533,n+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&n<i;)t=t<<6|63&e[n++],s--;s>1?l[a++]=65533:t<65536?l[a++]=t:(t-=65536,l[a++]=55296|t>>10&1023,l[a++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Je)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let n=0;n<t;n++)i+=String.fromCharCode(e[n]);return i})(l,a)},tt=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+Ke[e[i]]>t?i:t};var it=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const nt=Object.prototype.toString,{Z_NO_FLUSH:at,Z_SYNC_FLUSH:lt,Z_FULL_FLUSH:st,Z_FINISH:rt,Z_OK:ot,Z_STREAM_END:ut,Z_DEFAULT_COMPRESSION:ht,Z_DEFAULT_STRATEGY:dt,Z_DEFLATED:ct}=q;function pt(e){this.options=qe({level:ht,method:ct,chunkSize:16384,windowBits:15,memLevel:8,strategy:dt},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new it,this.strm.avail_out=0;let i=He.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==ot)throw new Error($[i]);if(t.header&&He.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Qe(t.dictionary):"[object ArrayBuffer]"===nt.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=He.deflateSetDictionary(this.strm,e),i!==ot)throw new Error($[i]);this._dict_set=!0}}function mt(e,t){const i=new pt(t);if(i.push(e,!0),i.err)throw i.msg||$[i.err];return i.result}pt.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize;let a,l;if(this.ended)return!1;for(l=t===~~t?t:!0===t?rt:at,"string"==typeof e?i.input=Qe(e):"[object ArrayBuffer]"===nt.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(l===lt||l===st)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(a=He.deflate(i,l),a===ut)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),a=He.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===ot;if(0!==i.avail_out){if(l>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},pt.prototype.onData=function(e){this.chunks.push(e)},pt.prototype.onEnd=function(e){e===ot&&(this.result=Ze(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ft={Deflate:pt,deflate:mt,deflateRaw:function(e,t){return(t=t||{}).raw=!0,mt(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,mt(e,t)},constants:q};const vt=16209;var gt=function(e,t){let i,n,a,l,s,r,o,u,h,d,c,p,m,f,v,g,y,b,x,E,w,_,U,V;const A=e.state;i=e.next_in,U=e.input,n=i+(e.avail_in-5),a=e.next_out,V=e.output,l=a-(t-e.avail_out),s=a+(e.avail_out-257),r=A.dmax,o=A.wsize,u=A.whave,h=A.wnext,d=A.window,c=A.hold,p=A.bits,m=A.lencode,f=A.distcode,v=(1<<A.lenbits)-1,g=(1<<A.distbits)-1;e:do{p<15&&(c+=U[i++]<<p,p+=8,c+=U[i++]<<p,p+=8),y=m[c&v];t:for(;;){if(b=y>>>24,c>>>=b,p-=b,b=y>>>16&255,0===b)V[a++]=65535&y;else{if(!(16&b)){if(64&b){if(32&b){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=vt;break e}y=m[(65535&y)+(c&(1<<b)-1)];continue t}for(x=65535&y,b&=15,b&&(p<b&&(c+=U[i++]<<p,p+=8),x+=c&(1<<b)-1,c>>>=b,p-=b),p<15&&(c+=U[i++]<<p,p+=8,c+=U[i++]<<p,p+=8),y=f[c&g];;){if(b=y>>>24,c>>>=b,p-=b,b=y>>>16&255,16&b){if(E=65535&y,b&=15,p<b&&(c+=U[i++]<<p,p+=8,p<b&&(c+=U[i++]<<p,p+=8)),E+=c&(1<<b)-1,E>r){e.msg="invalid distance too far back",A.mode=vt;break e}if(c>>>=b,p-=b,b=a-l,E>b){if(b=E-b,b>u&&A.sane){e.msg="invalid distance too far back",A.mode=vt;break e}if(w=0,_=d,0===h){if(w+=o-b,b<x){x-=b;do{V[a++]=d[w++]}while(--b);w=a-E,_=V}}else if(h<b){if(w+=o+h-b,b-=h,b<x){x-=b;do{V[a++]=d[w++]}while(--b);if(w=0,h<x){b=h,x-=b;do{V[a++]=d[w++]}while(--b);w=a-E,_=V}}}else if(w+=h-b,b<x){x-=b;do{V[a++]=d[w++]}while(--b);w=a-E,_=V}for(;x>2;)V[a++]=_[w++],V[a++]=_[w++],V[a++]=_[w++],x-=3;x&&(V[a++]=_[w++],x>1&&(V[a++]=_[w++]))}else{w=a-E;do{V[a++]=V[w++],V[a++]=V[w++],V[a++]=V[w++],x-=3}while(x>2);x&&(V[a++]=V[w++],x>1&&(V[a++]=V[w++]))}break}if(64&b){e.msg="invalid distance code",A.mode=vt;break e}y=f[(65535&y)+(c&(1<<b)-1)]}}break}}while(i<n&&a<s);x=p>>3,i-=x,p-=x<<3,c&=(1<<p)-1,e.next_in=i,e.next_out=a,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=a<s?s-a+257:257-(a-s),A.hold=c,A.bits=p};const yt=15,bt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),xt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Et=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),wt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var _t=(e,t,i,n,a,l,s,r)=>{const o=r.bits;let u,h,d,c,p,m,f=0,v=0,g=0,y=0,b=0,x=0,E=0,w=0,_=0,U=0,V=null;const A=new Uint16Array(16),I=new Uint16Array(16);let S,T,C,k=null;for(f=0;f<=yt;f++)A[f]=0;for(v=0;v<n;v++)A[t[i+v]]++;for(b=o,y=yt;y>=1&&0===A[y];y--);if(b>y&&(b=y),0===y)return a[l++]=20971520,a[l++]=20971520,r.bits=1,0;for(g=1;g<y&&0===A[g];g++);for(b<g&&(b=g),w=1,f=1;f<=yt;f++)if(w<<=1,w-=A[f],w<0)return-1;if(w>0&&(0===e||1!==y))return-1;for(I[1]=0,f=1;f<yt;f++)I[f+1]=I[f]+A[f];for(v=0;v<n;v++)0!==t[i+v]&&(s[I[t[i+v]]++]=v);if(0===e?(V=k=s,m=20):1===e?(V=bt,k=xt,m=257):(V=Et,k=wt,m=0),U=0,v=0,f=g,p=l,x=b,E=0,d=-1,_=1<<b,c=_-1,1===e&&_>852||2===e&&_>592)return 1;for(;;){S=f-E,s[v]+1<m?(T=0,C=s[v]):s[v]>=m?(T=k[s[v]-m],C=V[s[v]-m]):(T=96,C=0),u=1<<f-E,h=1<<x,g=h;do{h-=u,a[p+(U>>E)+h]=S<<24|T<<16|C}while(0!==h);for(u=1<<f-1;U&u;)u>>=1;if(0!==u?(U&=u-1,U+=u):U=0,v++,0==--A[f]){if(f===y)break;f=t[i+s[v]]}if(f>b&&(U&c)!==d){for(0===E&&(E=b),p+=g,x=f-E,w=1<<x;x+E<y&&(w-=A[x+E],!(w<=0));)x++,w<<=1;if(_+=1<<x,1===e&&_>852||2===e&&_>592)return 1;d=U&c,a[d]=b<<24|x<<16|p-l}}return 0!==U&&(a[p+U]=f-E<<24|64<<16),r.bits=b,0};const{Z_FINISH:Ut,Z_BLOCK:Vt,Z_TREES:At,Z_OK:It,Z_STREAM_END:St,Z_NEED_DICT:Tt,Z_STREAM_ERROR:Ct,Z_DATA_ERROR:kt,Z_MEM_ERROR:Pt,Z_BUF_ERROR:Lt,Z_DEFLATED:Mt}=q,Ot=16180,Rt=16190,Nt=16191,Dt=16192,Ft=16194,zt=16199,Bt=16200,jt=16206,Wt=16209,Yt=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Gt(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Xt=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Ot||t.mode>16211?1:0},Ht=e=>{if(Xt(e))return Ct;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Ot,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,It},$t=e=>{if(Xt(e))return Ct;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ht(e)},qt=(e,t)=>{let i;if(Xt(e))return Ct;const n=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Ct:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,$t(e))},Zt=(e,t)=>{if(!e)return Ct;const i=new Gt;e.state=i,i.strm=e,i.window=null,i.mode=Ot;const n=qt(e,t);return n!==It&&(e.state=null),n};let Jt,Kt,Qt=!0;const ei=e=>{if(Qt){Jt=new Int32Array(512),Kt=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(_t(1,e.lens,0,288,Jt,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;_t(2,e.lens,0,32,Kt,0,e.work,{bits:5}),Qt=!1}e.lencode=Jt,e.lenbits=9,e.distcode=Kt,e.distbits=5},ti=(e,t,i,n)=>{let a;const l=e.state;return null===l.window&&(l.wsize=1<<l.wbits,l.wnext=0,l.whave=0,l.window=new Uint8Array(l.wsize)),n>=l.wsize?(l.window.set(t.subarray(i-l.wsize,i),0),l.wnext=0,l.whave=l.wsize):(a=l.wsize-l.wnext,a>n&&(a=n),l.window.set(t.subarray(i-n,i-n+a),l.wnext),(n-=a)?(l.window.set(t.subarray(i-n,i),0),l.wnext=n,l.whave=l.wsize):(l.wnext+=a,l.wnext===l.wsize&&(l.wnext=0),l.whave<l.wsize&&(l.whave+=a))),0};var ii=(e,t)=>{let i,n,a,l,s,r,o,u,h,d,c,p,m,f,v,g,y,b,x,E,w,_,U=0;const V=new Uint8Array(4);let A,I;const S=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Xt(e)||!e.output||!e.input&&0!==e.avail_in)return Ct;i=e.state,i.mode===Nt&&(i.mode=Dt),s=e.next_out,a=e.output,o=e.avail_out,l=e.next_in,n=e.input,r=e.avail_in,u=i.hold,h=i.bits,d=r,c=o,_=It;e:for(;;)switch(i.mode){case Ot:if(0===i.wrap){i.mode=Dt;break}for(;h<16;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(2&i.wrap&&35615===u){0===i.wbits&&(i.wbits=15),i.check=0,V[0]=255&u,V[1]=u>>>8&255,i.check=H(i.check,V,2,0),u=0,h=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",i.mode=Wt;break}if((15&u)!==Mt){e.msg="unknown compression method",i.mode=Wt;break}if(u>>>=4,h-=4,w=8+(15&u),0===i.wbits&&(i.wbits=w),w>15||w>i.wbits){e.msg="invalid window size",i.mode=Wt;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&u?16189:Nt,u=0,h=0;break;case 16181:for(;h<16;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(i.flags=u,(255&i.flags)!==Mt){e.msg="unknown compression method",i.mode=Wt;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=Wt;break}i.head&&(i.head.text=u>>8&1),512&i.flags&&4&i.wrap&&(V[0]=255&u,V[1]=u>>>8&255,i.check=H(i.check,V,2,0)),u=0,h=0,i.mode=16182;case 16182:for(;h<32;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}i.head&&(i.head.time=u),512&i.flags&&4&i.wrap&&(V[0]=255&u,V[1]=u>>>8&255,V[2]=u>>>16&255,V[3]=u>>>24&255,i.check=H(i.check,V,4,0)),u=0,h=0,i.mode=16183;case 16183:for(;h<16;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}i.head&&(i.head.xflags=255&u,i.head.os=u>>8),512&i.flags&&4&i.wrap&&(V[0]=255&u,V[1]=u>>>8&255,i.check=H(i.check,V,2,0)),u=0,h=0,i.mode=16184;case 16184:if(1024&i.flags){for(;h<16;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}i.length=u,i.head&&(i.head.extra_len=u),512&i.flags&&4&i.wrap&&(V[0]=255&u,V[1]=u>>>8&255,i.check=H(i.check,V,2,0)),u=0,h=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(p=i.length,p>r&&(p=r),p&&(i.head&&(w=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(l,l+p),w)),512&i.flags&&4&i.wrap&&(i.check=H(i.check,n,p,l)),r-=p,l+=p,i.length-=p),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===r)break e;p=0;do{w=n[l+p++],i.head&&w&&i.length<65536&&(i.head.name+=String.fromCharCode(w))}while(w&&p<r);if(512&i.flags&&4&i.wrap&&(i.check=H(i.check,n,p,l)),r-=p,l+=p,w)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===r)break e;p=0;do{w=n[l+p++],i.head&&w&&i.length<65536&&(i.head.comment+=String.fromCharCode(w))}while(w&&p<r);if(512&i.flags&&4&i.wrap&&(i.check=H(i.check,n,p,l)),r-=p,l+=p,w)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;h<16;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(4&i.wrap&&u!==(65535&i.check)){e.msg="header crc mismatch",i.mode=Wt;break}u=0,h=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=Nt;break;case 16189:for(;h<32;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}e.adler=i.check=Yt(u),u=0,h=0,i.mode=Rt;case Rt:if(0===i.havedict)return e.next_out=s,e.avail_out=o,e.next_in=l,e.avail_in=r,i.hold=u,i.bits=h,Tt;e.adler=i.check=1,i.mode=Nt;case Nt:if(t===Vt||t===At)break e;case Dt:if(i.last){u>>>=7&h,h-=7&h,i.mode=jt;break}for(;h<3;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}switch(i.last=1&u,u>>>=1,h-=1,3&u){case 0:i.mode=16193;break;case 1:if(ei(i),i.mode=zt,t===At){u>>>=2,h-=2;break e}break;case 2:i.mode=16196;break;case 3:e.msg="invalid block type",i.mode=Wt}u>>>=2,h-=2;break;case 16193:for(u>>>=7&h,h-=7&h;h<32;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",i.mode=Wt;break}if(i.length=65535&u,u=0,h=0,i.mode=Ft,t===At)break e;case Ft:i.mode=16195;case 16195:if(p=i.length,p){if(p>r&&(p=r),p>o&&(p=o),0===p)break e;a.set(n.subarray(l,l+p),s),r-=p,l+=p,o-=p,s+=p,i.length-=p;break}i.mode=Nt;break;case 16196:for(;h<14;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(i.nlen=257+(31&u),u>>>=5,h-=5,i.ndist=1+(31&u),u>>>=5,h-=5,i.ncode=4+(15&u),u>>>=4,h-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=Wt;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;h<3;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}i.lens[S[i.have++]]=7&u,u>>>=3,h-=3}for(;i.have<19;)i.lens[S[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,A={bits:i.lenbits},_=_t(0,i.lens,0,19,i.lencode,0,i.work,A),i.lenbits=A.bits,_){e.msg="invalid code lengths set",i.mode=Wt;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;U=i.lencode[u&(1<<i.lenbits)-1],v=U>>>24,g=U>>>16&255,y=65535&U,!(v<=h);){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(y<16)u>>>=v,h-=v,i.lens[i.have++]=y;else{if(16===y){for(I=v+2;h<I;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(u>>>=v,h-=v,0===i.have){e.msg="invalid bit length repeat",i.mode=Wt;break}w=i.lens[i.have-1],p=3+(3&u),u>>>=2,h-=2}else if(17===y){for(I=v+3;h<I;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}u>>>=v,h-=v,w=0,p=3+(7&u),u>>>=3,h-=3}else{for(I=v+7;h<I;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}u>>>=v,h-=v,w=0,p=11+(127&u),u>>>=7,h-=7}if(i.have+p>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=Wt;break}for(;p--;)i.lens[i.have++]=w}}if(i.mode===Wt)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=Wt;break}if(i.lenbits=9,A={bits:i.lenbits},_=_t(1,i.lens,0,i.nlen,i.lencode,0,i.work,A),i.lenbits=A.bits,_){e.msg="invalid literal/lengths set",i.mode=Wt;break}if(i.distbits=6,i.distcode=i.distdyn,A={bits:i.distbits},_=_t(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,A),i.distbits=A.bits,_){e.msg="invalid distances set",i.mode=Wt;break}if(i.mode=zt,t===At)break e;case zt:i.mode=Bt;case Bt:if(r>=6&&o>=258){e.next_out=s,e.avail_out=o,e.next_in=l,e.avail_in=r,i.hold=u,i.bits=h,gt(e,c),s=e.next_out,a=e.output,o=e.avail_out,l=e.next_in,n=e.input,r=e.avail_in,u=i.hold,h=i.bits,i.mode===Nt&&(i.back=-1);break}for(i.back=0;U=i.lencode[u&(1<<i.lenbits)-1],v=U>>>24,g=U>>>16&255,y=65535&U,!(v<=h);){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(g&&!(240&g)){for(b=v,x=g,E=y;U=i.lencode[E+((u&(1<<b+x)-1)>>b)],v=U>>>24,g=U>>>16&255,y=65535&U,!(b+v<=h);){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}u>>>=b,h-=b,i.back+=b}if(u>>>=v,h-=v,i.back+=v,i.length=y,0===g){i.mode=16205;break}if(32&g){i.back=-1,i.mode=Nt;break}if(64&g){e.msg="invalid literal/length code",i.mode=Wt;break}i.extra=15&g,i.mode=16201;case 16201:if(i.extra){for(I=i.extra;h<I;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}i.length+=u&(1<<i.extra)-1,u>>>=i.extra,h-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;U=i.distcode[u&(1<<i.distbits)-1],v=U>>>24,g=U>>>16&255,y=65535&U,!(v<=h);){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(!(240&g)){for(b=v,x=g,E=y;U=i.distcode[E+((u&(1<<b+x)-1)>>b)],v=U>>>24,g=U>>>16&255,y=65535&U,!(b+v<=h);){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}u>>>=b,h-=b,i.back+=b}if(u>>>=v,h-=v,i.back+=v,64&g){e.msg="invalid distance code",i.mode=Wt;break}i.offset=y,i.extra=15&g,i.mode=16203;case 16203:if(i.extra){for(I=i.extra;h<I;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}i.offset+=u&(1<<i.extra)-1,u>>>=i.extra,h-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=Wt;break}i.mode=16204;case 16204:if(0===o)break e;if(p=c-o,i.offset>p){if(p=i.offset-p,p>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=Wt;break}p>i.wnext?(p-=i.wnext,m=i.wsize-p):m=i.wnext-p,p>i.length&&(p=i.length),f=i.window}else f=a,m=s-i.offset,p=i.length;p>o&&(p=o),o-=p,i.length-=p;do{a[s++]=f[m++]}while(--p);0===i.length&&(i.mode=Bt);break;case 16205:if(0===o)break e;a[s++]=i.length,o--,i.mode=Bt;break;case jt:if(i.wrap){for(;h<32;){if(0===r)break e;r--,u|=n[l++]<<h,h+=8}if(c-=o,e.total_out+=c,i.total+=c,4&i.wrap&&c&&(e.adler=i.check=i.flags?H(i.check,a,c,s-c):G(i.check,a,c,s-c)),c=o,4&i.wrap&&(i.flags?u:Yt(u))!==i.check){e.msg="incorrect data check",i.mode=Wt;break}u=0,h=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;h<32;){if(0===r)break e;r--,u+=n[l++]<<h,h+=8}if(4&i.wrap&&u!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=Wt;break}u=0,h=0}i.mode=16208;case 16208:_=St;break e;case Wt:_=kt;break e;case 16210:return Pt;default:return Ct}return e.next_out=s,e.avail_out=o,e.next_in=l,e.avail_in=r,i.hold=u,i.bits=h,(i.wsize||c!==e.avail_out&&i.mode<Wt&&(i.mode<jt||t!==Ut))&&ti(e,e.output,e.next_out,c-e.avail_out),d-=e.avail_in,c-=e.avail_out,e.total_in+=d,e.total_out+=c,i.total+=c,4&i.wrap&&c&&(e.adler=i.check=i.flags?H(i.check,a,c,e.next_out-c):G(i.check,a,c,e.next_out-c)),e.data_type=i.bits+(i.last?64:0)+(i.mode===Nt?128:0)+(i.mode===zt||i.mode===Ft?256:0),(0===d&&0===c||t===Ut)&&_===It&&(_=Lt),_},ni={inflateReset:$t,inflateReset2:qt,inflateResetKeep:Ht,inflateInit:e=>Zt(e,15),inflateInit2:Zt,inflate:ii,inflateEnd:e=>{if(Xt(e))return Ct;let t=e.state;return t.window&&(t.window=null),e.state=null,It},inflateGetHeader:(e,t)=>{if(Xt(e))return Ct;const i=e.state;return 2&i.wrap?(i.head=t,t.done=!1,It):Ct},inflateSetDictionary:(e,t)=>{const i=t.length;let n,a,l;return Xt(e)?Ct:(n=e.state,0!==n.wrap&&n.mode!==Rt?Ct:n.mode===Rt&&(a=1,a=G(a,t,i,0),a!==n.check)?kt:(l=ti(e,t,i,i),l?(n.mode=16210,Pt):(n.havedict=1,It)))},inflateInfo:"pako inflate (from Nodeca project)"};var ai=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const li=Object.prototype.toString,{Z_NO_FLUSH:si,Z_FINISH:ri,Z_OK:oi,Z_STREAM_END:ui,Z_NEED_DICT:hi,Z_STREAM_ERROR:di,Z_DATA_ERROR:ci,Z_MEM_ERROR:pi}=q;function mi(e){this.options=qe({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new it,this.strm.avail_out=0;let i=ni.inflateInit2(this.strm,t.windowBits);if(i!==oi)throw new Error($[i]);if(this.header=new ai,ni.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Qe(t.dictionary):"[object ArrayBuffer]"===li.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=ni.inflateSetDictionary(this.strm,t.dictionary),i!==oi)))throw new Error($[i])}function fi(e,t){const i=new mi(t);if(i.push(e),i.err)throw i.msg||$[i.err];return i.result}mi.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let l,s,r;if(this.ended)return!1;for(s=t===~~t?t:!0===t?ri:si,"[object ArrayBuffer]"===li.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),l=ni.inflate(i,s),l===hi&&a&&(l=ni.inflateSetDictionary(i,a),l===oi?l=ni.inflate(i,s):l===ci&&(l=hi));i.avail_in>0&&l===ui&&i.state.wrap>0&&0!==e[i.next_in];)ni.inflateReset(i),l=ni.inflate(i,s);switch(l){case di:case ci:case hi:case pi:return this.onEnd(l),this.ended=!0,!1}if(r=i.avail_out,i.next_out&&(0===i.avail_out||l===ui))if("string"===this.options.to){let e=tt(i.output,i.next_out),t=i.next_out-e,a=et(i.output,e);i.next_out=t,i.avail_out=n-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(a)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(l!==oi||0!==r){if(l===ui)return l=ni.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},mi.prototype.onData=function(e){this.chunks.push(e)},mi.prototype.onEnd=function(e){e===oi&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ze(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var vi={Inflate:mi,inflate:fi,inflateRaw:function(e,t){return(t=t||{}).raw=!0,fi(e,t)},ungzip:fi,constants:q};const{Deflate:gi,deflate:yi,deflateRaw:bi,gzip:xi}=ft,{Inflate:Ei,inflate:wi,inflateRaw:_i,ungzip:Ui}=vi;var Vi={Deflate:gi,deflate:yi,deflateRaw:bi,gzip:xi,Inflate:Ei,inflate:wi,inflateRaw:_i,ungzip:Ui,constants:q};class VariableRegistry{constructor(e){Object.assign(this,e),this.CreateIfNotFound=!1}Clear(){Object.entries(this).forEach((([e,t])=>{"CreateIfNotFound"!==e&&delete this[e]}))}GenerateVariableId(){return this.VariableIncrement??=0,++this.VariableIncrement}GetVariableByReference(e){if(!e||"object"!=typeof e)return;let t;const i=e.name?.indexOf(".");if(-1!==(i??-1)){const n=e.name.substring(0,i);if(!this[n])return;t={name:e.name.substring(i+1)},t=this[n].find((i=>i.name===t.name&&(null==e.unit||i.unit===e.unit||null==i.unit&&"string"==typeof i.id)&&(null==e.type||null!=i.unit&&-1!==e.type.split("|").indexOf("float")||i.type?.split("|").some((t=>-1!==e.type.split("|").indexOf(t)))||null==i.type&&"string"==typeof i.id)))}else"object"==typeof this[e.name]?t=this[e.name]:(this[e.name],"number"==typeof this[e.name]&&(t={name:e.name,id:this[e.name]}));if(t){if("string"==typeof t.id){const i=this.GetVariableByReference({name:t.id,unit:e.unit??t.unit,type:e.type??t.type});if(i)return{...i,name:t.name}}return t}}GetVariableId(e){let t=this.GetVariableByReference(e);if(t)return t.id;if(!this.CreateIfNotFound)return;if(null==e||null==e.name)return;t={...e},t.id??=this.GenerateVariableId();const i=t.name.indexOf(".");if(-1!==i){const e=t.name.substring(0,i);this[e]??=[],t.name=t.name.substring(i+1),this[e].push(t)}else this[t.name]=t;return this.GetVariableId(e)}RegisterVariable(e){if(!e||"object"!=typeof e||!e.name)return;const t=(e={...e}).name.indexOf(".");if(-1!==t){const i=e.name.substring(0,t);this[i]??=[],e.name=e.name.substring(t+1);const n=this[i].findIndex((t=>t.name===e.name&&(null==e.unit||t.unit===e.unit||null==t.unit&&"string"==typeof t.id)&&(null==e.type||null!=t.unit&&-1!==e.type.split("|").indexOf("float")||null==t.type&&"string"==typeof t.id||t.type?.split("|").some((t=>-1!==e.type.split("|").indexOf(t))))));-1!==n&&(e.generatedID??=this[i][n].generatedID,e.id??=this[i][n].id,this[i].splice(n,1)),e.id??=e.generatedID??=this.GenerateVariableId(),this[i].push(e)}else e.id??=this.GenerateVariableId(),this[e.name]=e}GetVariableReferenceList(){var e={};for(var t in this)if(null!=this[t]&&"VariableIncrement"!==t&&"CreateIfNotFound"!==t&&0!==t.toLowerCase().indexOf("temp"))if(Array.isArray(this[t])){e[t]??=[];this[t];for(var i=0;i<this[t].length;i++){let n={...this[t][i]};n.name=`${t}.${n.name}`,e[t].push(this.GetVariableByReference(n))}}else e[t]=this.GetVariableByReference(this[t]);return e}GetSelections(e,t){var i=[];if(e?.length>0){var n=e;e[0].group||e[0].calculations||(n=[{group:"Calculations",calculations:e}]);for(var a=0;a<n.length;a++){var l={group:n[a].group,options:[]};e=n[a].calculations;for(var s=0;s<e.length;s++)t&&!t(e[s])||l.options.push({name:e[s].displayName,value:e[s].name});l.options.length>0&&i.push(l)}}for(var r in this)if(Array.isArray(this[r])){var o=this[r],u={group:r,options:[]};for(s=0;s<o.length;s++)t&&!t(o[s])||u.options.push({name:o[s].name,info:o[s].unit?`[${GetMeasurementNameFromUnitName(o[s].unit)}]`:"",value:{name:`${r}.${o[s].name}`,...null==o[s].type?void 0:{type:o[s].type},...null==o[s].unit?void 0:{unit:o[s].unit}}});u.options.length>0&&i.push(u)}return 1===i.length?i[0].options:i}}function Ai(e,t,i,n){const a=Ii(e,t,i,n);return function(e){return!e.type&&!e.unit&&a(e)}}function Ii(e,t,i,n){return function(a){if(a.type||a.unit){if(i?.length||n?.length)return!1;if(null!=e?.[0]){if(1!==e.length)return!1;if(GetMeasurementNameFromUnitName(a.unit)!==GetMeasurementNameFromUnitName(e[0]))return!1}else if(null!=t?.[0]){if(1!==t.length)return!1;if(null==a.unit&&null==a.type)return!1;if(null!=a.unit&&-1===t[0].split("|").indexOf("float"))return!1;if(null!=a.type&&!t[0].split("|").some((e=>-1!==a.type.split("|").indexOf(e))))return!1}return!0}if(null!=e||null!=t){if(0===(e?.length??t?.length??0)&&0!==(a.outputUnits?.length??a.outputTypes?.length))return!1;for(let i=0;i<(e?.length??t?.length??0);i++)if(null!=e?.[i]&&""!==e[i]){if(-1===(a.outputTypes?.[i]?.split("|").indexOf("float")??-1)&&e[i]!==a.outputUnits?.[i])return!1}else if(null!=t?.[i]){if(null==a.outputUnits?.[i]&&a.outputTypes,null!=a.outputUnits?.[i]&&-1===t[i].split("|").indexOf("float"))return!1;if(null!=a.outputTypes?.[i]&&!t[i].split("|").some((e=>-1!==a.outputTypes[i].split("|").indexOf(e))))return!1}}if(null!=n||null!=i){if(0===(n?.length??i?.length??0)&&0!==(a.inputUnits?.length??a.inputTypes?.length??0))return!1;for(let e=0;e<(n?.length??i?.length??0);e++)if(null!=n?.[e]){if(-1===(a.inputTypes?.[e]?.split("|").indexOf("float")??-1)&&n[e]!==a.inputUnits?.[e])return!1}else if(null!=i?.[e]){if(null==a.inputUnits?.[e]&&a.inputTypes,null!=a.inputUnits?.[e]&&-1===i[e].split("|").indexOf("float"))return!1;if(null!=a.inputTypes?.[e]&&!i[e].split("|").some((t=>-1!==a.inputTypes[e].split("|").indexOf(t))))return!1}}return!0}}async function Si(e,t=1e3){let i=0;for(;e()&&i++<Math.max(1,t/Math.max(t/10,10));)await new Promise((e=>setTimeout(e,Math.max(t/10,10))));return!e()}class Serial{#e;#t;#i;#n=new ArrayBuffer;#a;get options(){return this.#e}set options(e){this.#e=e,this.#i=void 0}get filters(){return this.#t}set filters(e){this.#t=e,this.#i=void 0}constructor(e,t){this.options=e??{baudRate:115200},this.filters=t}async#l(){if(null!=this.#i&&this.#i.readable&&this.#i.writable)return;if(!("serial"in navigator))throw"WebSerial not supported. please open in a supported browser";let e=await navigator.serial.getPorts({filter:this.filters});1!==e.length?this.#i=await navigator.serial.requestPort({filter:this.filters}):this.#i=e[0],await this.#i.open(this.options)}async read(e,t=1e3){async function i(e,t){if(!await Si((function(){return e.locked})))return{value:void 0,done:!1};const i=new TransformStream;e.pipeThrough(i,{preventClose:!0,preventCancel:!0});const n=i.readable.getReader();let a;const l=setTimeout((()=>{a={value:void 0,done:!1},n.cancel()}),t),s=await n.read();return clearTimeout(l),n.cancel(),a??s}await this.#l();let n=0;for(;null==e||this.#n.byteLength<e;){const{value:a,done:l}=await i(this.#i.readable,t);if(l)throw"Serial closed";if(!a&&n++>10)break;if(a&&(n=0,this.#n=this.#n.concatArray(a)),null==e)break}let a=null==e?this.#n:this.#n.slice(0,e);return this.#n=null==e?new ArrayBuffer:this.#n.slice(e),a}async write(e,t=1e3){await this.#l();const i=this.#i.writable;if(!await Si((function(){return i.locked})))return;const n=i.getWriter();await n.write(e),n.releaseLock()}async command(e,t,i=1e3){const n=this;if(!await Si((function(){return n.#a})))throw"Serial locked";let a;this.#a=!0;try{await this.write(e,i),a=this.read(t,i)}catch(e){throw e}finally{this.#a=!1}return a??new ArrayBuffer}}class EFIGenieLog{variableMetadata=void 0;logBytes=new ArrayBuffer;loggedVariableValues=[];get saveValue(){var e=Vi.gzip((new TextEncoder).encode(JSON.stringify(this.variableMetadata.GetVariableReferenceList()))).buffer;return new Uint32Array([e.byteLength]).buffer.concatArray(e).concatArray(LogBytes)}set saveValue(e){const t=new Uint32Array(e.slice(0,4))[0];this.variableMetadata=new VariableRegistry(JSON.parse(lzjs.decompressFromBase64(arrayBufferToBase64(e.slice(4,t+4))))),this.logBytes=e.slice(t+4)}}let Ti=new class EFIGenieCommunication extends EFIGenieLog{variableMetadata=void 0;variablesToPoll=[];liveUpdateEvents=[];previousVariableIds=[];async pollVariableMetadata(){if(null!=this.variableMetadata)return;await this._serial.read(1e3,10);let e=new ArrayBuffer,t=1;for(let i=0;i<Math.ceil(t);i++){const n=new Uint8Array([109]).buffer.concatArray(new Uint32Array([i]).buffer);let a=await this._serial.command(n,64);if(64!==a.byteLength)throw"Incorrect number of bytes returned when requesting metadata";if(0===i&&(t=new Uint32Array(a.slice(0,4))[0]/64,t>1e3))throw"Incorrect length returned when requesting metadata";e=e.concatArray(a)}t=new Uint32Array(e.slice(0,4))[0],e=e.slice(4,t+4);const i=Vi.ungzip(new Uint8Array(e),{to:"string"});this.variableMetadata=new VariableRegistry(JSON.parse(i)),b.RegisterVariables()}async pollVariables(){await this.pollVariableMetadata();var e=[];const t=this.variableMetadata.GetVariableId({name:"CurrentTick",type:"tick"});for(var i in t&&e.push(t),this.variablesToPoll){const t=this.variableMetadata.GetVariableId(this.variablesToPoll[i]);null!=t&&-1===e.indexOf(t)&&e.push(t)}if(e.length<1)return;if(e.length!=this.previousVariableIds?.length)this.logBytes=new ArrayBuffer,this.loggedVariableValues=[],this.previousVariableIds=e;else for(var n=0;n<e.length;n++)if(e[n]!==this.previousVariableIds[n]){this.logBytes=new ArrayBuffer,this.loggedVariableValues=[],this.previousVariableIds=e;break}function a(e){switch(e){case 0:return 0;case 1:case 5:case 11:return 1;case 2:case 6:return 2;case 3:case 7:case 9:return 4;case 4:case 8:case 10:return 8}}function l(e){switch(new Uint8Array(e)[0]){case 0:return;case 1:return new Uint8Array(e.slice(1))[0];case 2:return new Uint16Array(e.slice(1))[0];case 3:return new Uint32Array(e.slice(1))[0];case 5:return new Int8Array(e.slice(1))[0];case 6:return new Int16Array(e.slice(1))[0];case 7:return new Int32Array(e.slice(1))[0];case 9:return new Float32Array(e.slice(1))[0];case 10:return new Float64Array(e.slice(1))[0];case 11:return 1===new Uint8Array(e.slice(1))[0]}}let s=new ArrayBuffer;for(let t=0;t<e.length;t++)s=s.concatArray(new Uint8Array([103]).buffer.concatArray(new Uint32Array([e[t]]).buffer));await this._serial.write(s);let r=new ArrayBuffer,o={};for(let t=0;t<e.length;t++){let i=await this._serial.read(1);if(1!==i.byteLength)return;const n=a(new Uint8Array(i)[0]);if(n>0&&(i=i.concatArray(await this._serial.read(n))),i.byteLength!==n+1)return;o[e[t]]=l(i),r=r.concatArray(i)}this.logBytes=this.logBytes.concatArray(r),this.loggedVariableValues.push(o);const u=this;!async function(){u.#s(u)}()}#s=function(e){Object.entries(e.liveUpdateEvents).filter((function(e,t,i){return i.indexOf(e)===t})).forEach((([t,i])=>{i?.(e.variableMetadata,e.loggedVariableValues[e.loggedVariableValues.length-1])}))};async#r(e,t){const i=await this._serial.command(e,1);if(1!==i.byteLength)throw`Incorrect number of bytes returned when ${t}`;if(6!==new Uint8Array(i)[0])throw`Ack not returned when ${t}`}async stopExecution(){await this.#r(new Uint8Array([113]).buffer,"stopping execution")}async startExecution(){await this.#r(new Uint8Array([115]).buffer,"starting execution")}async writeToAddress(e,t,i=52,n=1e3){let a=t.byteLength,l=0;for(;a>0;){let n=Math.min(i,a);await this.#r(new Uint8Array([119]).buffer.concatArray(new Uint32Array([e+l,n]).buffer).concatArray(t.slice(l,l+n)),"writing data"),a-=n,l+=n}}async getConfigAddress(){const e=await this._serial.command(new Uint8Array([99]).buffer,4);if(4!==e.byteLength)throw"Incorrect number of bytes returned when requesting config address";return new Uint32Array(e)[0]}async burnBin(e){let t=this.connected;await this.disconnect(),await this.stopExecution();const i=await this.getConfigAddress();await this.writeToAddress(i,e),await this.startExecution(),t&&this.connect()}connect(){if(this.polling)return;this.polling=!0,this.connected=!0;const e=this;this.pollVariables().then((function(){e.polling=!1,e.connected&&e.connect()})).catch((function(t){console.log(t),e.variableMetadata=void 0,e.polling=!1,e.connected=!1}))}async disconnect(){this.connected=!1;const e=this;await Si((function(){return e.polling||e.connected}))}};function Ci(e){return Nn.find((t=>t.type===e.type)).toArrayBuffer.call(e)}var ki;n.Purple_Pill_W806={name:"Purple pill: W806",Overlay:"images/W806_Overlay.png",OverlayWidth:577,OverlayElementHeight:22,Pins:[{name:"PA_0",value:0,supportedModes:"digitalin digitalout digitalinterrupt analog pwm",overlayX:577,overlayY:220,align:"right"},{name:"PA_1",value:1,supportedModes:"digitalin digitalout digitalinterrupt analog pwm",overlayX:577,overlayY:242,align:"right"},{name:"PA_2",value:2,supportedModes:"digitalin digitalout digitalinterrupt analog pwm",overlayX:577,overlayY:264,align:"right"},{name:"PA_3",value:3,supportedModes:"digitalin digitalout digitalinterrupt analog pwm",overlayX:577,overlayY:286,align:"right"},{name:"PA_4",value:4,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:308,align:"right"},{name:"PA_5",value:5,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:330,align:"right"},{name:"PA_6",value:6,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:352,align:"right"},{name:"PA_7",value:7,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:374,align:"right"},{name:"PA_8",value:8,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:440,align:"left"},{name:"PA_9",value:9,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:418,align:"left"},{name:"PA_10",value:10,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:396,align:"left"},{name:"PA_11",value:11,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:374,align:"left"},{name:"PA_12",value:12,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:352,align:"left"},{name:"PA_13",value:13,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:352,align:"left"},{name:"PA_14",value:14,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:352,align:"left"},{name:"PA_15",value:15,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:330,align:"left"},{name:"PB_0",value:32,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:396,align:"right"},{name:"PB_1",value:33,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:418,align:"right"},{name:"PB_2",value:34,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:440,align:"right"},{name:"PB_3",value:35,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:308,align:"left"},{name:"PB_27",value:59,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:462,align:"right"},{name:"PB_4",value:36,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:286,align:"left"},{name:"PB_5",value:37,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:264,align:"left"},{name:"PB_6",value:38,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:242,align:"left"},{name:"PB_7",value:39,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:220,align:"left"},{name:"PB_8",value:40,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:198,align:"left"},{name:"PB_9",value:41,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:176,align:"left"},{name:"PB_10",value:42,supportedModes:"digitalin digitalout digitalinterrupt",overlayX:577,overlayY:462,align:"right"},{name:"PB_12",value:44,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:528,align:"left"},{name:"PB_15",value:47,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:462,align:"left"},{name:"PB_14",value:46,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:484,align:"left"},{name:"PB_13",value:45,supportedModes:"digitalin digitalout digitalinterrupt pwm",overlayX:577,overlayY:506,align:"left"}],Type:"TopEngine",Burn:function(e){!function(e,t){const i=JSON.stringify(e.saveValue),n=buildConfig({...e.value,type:t});window.localStorage.setItem("config",i),Ti.burnBin(n).then((function(){alert("Bin Burned!")})).catch((function(e){alert(e)}))}(e,this.Type)}};let Pi=1e4,Li=0,Mi=1,Oi=2,Ri=3,Ni=4,Di=5,Fi=10,zi=11,Bi=12,ji=13,Wi=14,Yi=15,Gi=16,Xi=17,Hi=18,$i=19,qi=20,Zi=21,Ji=22,Ki=2e4,Qi=1,en=2,tn=3,nn=4,an=5,ln=6,sn=7,rn=8,on=9,un=14,hn=15,dn=16,cn=17,pn=18,mn=3e4,fn=1,vn=2,gn=3,yn=4e4,bn=1,xn=3,En=4,wn=5,_n=6,Un=7,Vn=8;Uint8Array.prototype.toHex=function(){for(var e=Array.prototype.map.call(new Uint8Array(this),(e=>("00"+e.toString(16)).slice(-2))),t=`${e[0]}`,i=1;i<e.length;i++)t+=i%16==0?"\n":i%8==0?"  ":" ",t+=e[i];return t};let An=[];for(let e=0;e<256;++e){let t=e;for(let e=0;e<8;++e)t=1&t?3988292384^t>>>1:t>>>1;An[e]=t}function In(e){for(var t=9e15,i=-9e15,n=0;n<e.length;n++){if(e[n]%1!=0)return"FLOAT";e[n]<t&&(t=e[n]),e[n]>i&&(i=e[n])}return"boolean"==typeof e[0]?"BOOL":Sn(t<0?i<0||t<-i?t:-i:i)}function Sn(e){if(null==e)return"VOID";if(Array.isArray(e))return In(e);if("boolean"==typeof e)return"BOOL";if(e%1!=0)return"FLOAT";if(e<0){if(e<128&&e>-129)return"INT8";if(e<32768&&e>-32759)return"INT16";if(e<2147483648&&e>-2147483649)return"INT32";if(e<0x8000000000000000&&e>-0x8000000000000000)return"INT64";throw"number too big"}if(e<128)return"INT8";if(e<256)return"UINT8";if(e<32768)return"INT16";if(e<65536)return"UINT16";if(e<2147483648)return"INT32";if(e<4294967295)return"UINT32";if(e<0x8000000000000000)return"INT64";if(e<0x10000000000000000)return"UINT64";throw"number too big"}function Tn(e){switch(e){case"VOID":return 0;case"UINT8":return 1;case"UINT16":return 2;case"UINT32":return 3;case"UINT64":return 4;case"INT8":return 5;case"INT16":return 6;case"INT32":return 7;case"INT64":return 8;case"FLOAT":return 9;case"DOUBLE":return 10;case"BOOL":return 11}}ArrayBuffer.prototype.crc32=function(){var e=-1;let t=new Uint8Array(this);for(let i=0;i<t.length;++i)e=An[255&(e^t[i])]^e>>>8;return e^=-1},ArrayBuffer.prototype.concatArray=function(e){var t=new Uint8Array(this.byteLength+e.byteLength);return this.byteLength>0&&t.set(new Uint8Array(this),0),t.set(new Uint8Array(e),this.byteLength),t.buffer},ArrayBuffer.prototype.pad=function(e,t){null==t&&(t=255);for(var i=[],n=0;n<e;n++)i[n]=t;return this.concatArray(new Uint8Array(i).buffer)},ArrayBuffer.prototype.align=function(e,t){return this.byteLength%e>0?this.pad(e-this.byteLength%e,t):this};let Cn=[{type:"INT8",align:1},{type:"INT16",align:2},{type:"INT32",align:4},{type:"INT64",align:8},{type:"BOOL",align:1},{type:"UINT8",align:1},{type:"UINT16",align:2},{type:"UINT32",align:4},{type:"UINT64",align:8},{type:"FLOAT",align:4},{type:"DOUBLE",align:8}],kn=[{type:"INT8",align:1},{type:"INT16",align:2},{type:"INT32",align:4},{type:"INT64",align:8},{type:"BOOL",align:1},{type:"UINT8",align:1},{type:"UINT16",align:2},{type:"UINT32",align:4},{type:"UINT64",align:8},{type:"FLOAT",align:4},{type:"DOUBLE",align:8}];function Pn(e,t){return t={...t},t.outputVariables??=[],t.outputUnits=(null==t.unit?t.outputUnits:[t.unit])??[],delete t.unit,t.outputVariables=t.outputVariables?.map(((e,i)=>{if("string"!=typeof e)return e;let n=e.substring(e.indexOf("(")>-1?e.indexOf("(")+1:e.length);return n.indexOf(")")>0&&(n=n.substring(0,n.indexOf(")")),t.outputUnits[i]??=n),e.substring(0,e.indexOf("(")>-1?e.indexOf("("):e.length)})),t.inputVariables??=[],t.outputVariables&&t.outputVariables.some((e=>null!=e))||t.inputVariables&&t.inputVariables.some((e=>null!=e))?(e.type="Package",e.outputVariables=t.outputVariables,e.outputUnits=t.outputUnits,e.inputVariables=t.inputVariables,{type:"definition",value:[e]}):e}function Ln(e,t=2){return(this.outputVariables||this.inputVariables)&&(this.inputVariables??=2===t?[0,0]:[0],this.outputVariables??=[0]),Pn({type:"definition",value:[{type:"UINT32",value:Pi+e}]},this)}function Mn(e){const t={name:this.outputVariables?.[0]?.name,type:"Record"};return{type:"Group",value:[{...this,type:"Input_DigitalRecord",outputVariables:[t]},Pn(e,{...this,inputVariables:[t,{name:"CurrentTick",type:"tick"}]})]}}function On(e){const t=this.types?.find((t=>t.type==e.type));if((e={...e,...t}).definition)return e.definition;e.types??=[];for(let t in this.types)null==e.types.find((e=>e.type===this.types[t].type))&&e.types.push(this.types[t]);if(e.toDefinition){let t=e.toDefinition.call(e);if(null==t)return;return"definition"!==t.type&&(t={type:"definition",value:[t]}),t.value.flatMap((t=>On.call(e,t)))}return e}function Rn(){return{type:"definition",value:this.value.flatMap((e=>On.call(this,e))),types:this.types}}let Nn=[{type:"definition",toDefinition:Rn,toArrayBuffer:function(){let e=Rn.call(this);var t=new ArrayBuffer;for(var i in e.value)if(null!=e.value[i]){var n=e.types.find((t=>t.type===e.value[i].type)),a=e.value[i].align;null==a&&null!=n&&(a=n.align),a&&(t=t.align(a));var l=e.value[i].toArrayBuffer;null==l&&null!=n&&"definition"!==e.value[i].type&&(l=n.toArrayBuffer),null!=l&&(t=t.concatArray(l.call(e.value[i])))}return t}},{type:"INT8",toArrayBuffer(){return new Int8Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"INT16",toArrayBuffer(){return new Int16Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"INT32",toArrayBuffer(){return new Int32Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"INT64",toArrayBuffer(){return new BigInt64Array(Array.isArray(this.value)?this.value:[BigInt(this.value)]).buffer}},{type:"BOOL",toArrayBuffer(){return new Uint8Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"UINT8",toArrayBuffer(){return new Uint8Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"UINT16",toArrayBuffer(){return new Uint16Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"UINT32",toArrayBuffer(){return new Uint32Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"UINT64",toArrayBuffer(){return new BigUint64Array(Array.isArray(this.value)?this.value:[BigInt(this.value)]).buffer}},{type:"FLOAT",toArrayBuffer(){return new Float32Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"DOUBLE",toArrayBuffer(){return new Float64Array(Array.isArray(this.value)?this.value:[this.value]).buffer}},{type:"CompressedObject",toArrayBuffer(){return Vi.gzip((new TextEncoder).encode(JSON.stringify(this.value))).buffer}},{type:"VariableId",toDefinition(){return{type:"definition",value:[{type:"UINT32",value:"number"==typeof this.value?this.value:ki.GetVariableId(this.value)}]}}},{type:"Package",toDefinition(){this.value.unshift({type:"UINT32",value:Pi+Li});const e=this;for(let t in this.outputVariables)e.value.push({type:"VariableId",value:this.outputVariables?.[t]});return delete this.outputUnits,delete this.outputVariables,this.inputVariables?.forEach((t=>{e.value.push({type:"VariableId",value:t??0})})),delete this.inputVariables,this.type="definition",this}},{type:"Group",toDefinition(){let e=[];const t=this,i=[...this.types.filter((e=>"Group"===e.type||"Package"===e.type))];return this.types=this.types.filter((e=>!("Group"===e.type||"Package"===e.type))),this.value.forEach((function i(n){if(function(e){for(var t in e)if(null!=e[t]&&Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(n))return;let a=On.call(t,n);for(Dn in Array.isArray(a)||(a=[a]),a)if(null!=a[Dn])if("Group"===a[Dn].type){for(var l in a[Dn].types){null==t.types.find((e=>e.type===a[Dn].types[l].type))&&t.types.push(a[Dn].types[l])}a[Dn].value.forEach(i)}else"Package"===a[Dn].type?e.push(a[Dn]):"definition"!==e[e.length-1]?.type?e.push({type:"definition",value:[a[Dn]]}):e.push(a[Dn])})),this.types=[...this.types,...i],e.unshift({type:"UINT16",value:e.length}),e.unshift({type:"UINT32",value:Pi+Mi}),this.value=e,this.type="definition",Pn(this,this)}},{type:"Calculation_Static",toDefinition(){var e=Sn(this.value),t=Tn(e);return Pn({type:"definition",value:[{type:"UINT32",value:Pi+Di},{type:"UINT8",value:t},{type:e,value:this.value}]},this)}},{type:"Calculation_2AxisTable",inputs:2,toDefinition(){this.inputVariables??=[void 0,void 0],this.XSelection&&(this.inputVariables[0]=this.XSelection),this.YSelection&&(this.inputVariables[1]=this.YSelection);const e=In(this.table.value),t=Tn(e);return Pn({type:"definition",value:[{type:"UINT32",value:Pi+Oi},{type:"UINT8",value:this.table.xAxis.length},{type:"UINT8",value:this.table.yAxis.length},{type:"UINT8",value:t},{type:"FLOAT",value:this.table.xAxis},{type:"FLOAT",value:this.table.yAxis},{type:e,value:this.table.value}]},this)}},{type:"Calculation_LookupTable",inputs:1,toDefinition(){this.parameterSelection&&(this.inputVariables=[this.parameterSelection]);const e=In(this.table.value),t=Tn(e);return Pn({type:"definition",value:[{type:"UINT32",value:Pi+Ri},{type:"UINT8",value:this.table.xAxis.length},{type:"UINT8",value:t},{type:"FLOAT",value:this.table.xAxis},{type:e,value:this.table.value}]},this)}},{type:"Calculation_Polynomial",inputs:1,toDefinition(){return Pn({type:"definition",value:[{type:"UINT32",value:Pi+Ni},{type:"FLOAT",value:this.minValue},{type:"FLOAT",value:this.maxValue},{type:"UINT8",value:this.coeffecients.length},{type:"FLOAT",value:this.coeffecients}]},this)}},{type:"Calculation_UnitConversion",inputs:1,toDefinition(){const e=GetUnitFromName(this.inputVariables?.[0]?.unit),t=GetUnitFromName(this.outputVariables?.[0]?.unit),i=t.SIMultiplier/e.SIMultiplier,n=-e.SIOffset*i+t.SIOffset;return Pn({type:"definition",value:[{type:"UINT32",value:Pi+Ji},{type:"FLOAT",value:i},{type:"FLOAT",value:n}]},this)}},{type:"CalculationOrVariableSelection",toDefinition(){if(this.calculation)return{...this,..."object"==typeof this.calculation?this.calculation:{value:this.calculation},type:this.selection};if(!this.selection)return;const e=this.outputVariables?.[0]?.unit??this.outputUnits?.[0];if(ki.RegisterVariable({...this.selection,...this.outputVariables?.[0],...null!=this.selection?.name&&{id:this.selection.name},...null!=e&&{unit:e}}),null!=e&&this.selection.unit!=e&&!ki.GetVariableByReference({...this.selection,unit:e})){const t=ki.GetVariableByReference(this.selection);return{outputVariables:[{...t,unit:e}],inputVariables:[t],type:"Calculation_UnitConversion"}}}},{type:"GenericCalculation",toDefinition(){const e=`${this.outputVariables?.[0]?.name??""}${this.name}`;return{...this,type:"CalculationOrVariableSelection",name:e,outputVariables:void 0!==this.outputUnits?.[0]||void 0!==this.outputTypes?.[0]?[{name:e,unit:this.outputUnits?.[0],type:this.outputTypes?.[0]}]:void 0}}},{type:"Calculation_Add",inputs:2,toDefinition(){return Ln.call(this,Fi)}},{type:"Calculation_Subtract",inputs:2,toDefinition(){return Ln.call(this,zi)}},{type:"Calculation_Multiply",inputs:2,toDefinition(){return Ln.call(this,Bi)}},{type:"Calculation_Divide",inputs:2,toDefinition(){return Ln.call(this,ji)}},{type:"Calculation_And",inputs:2,toDefinition(){return Ln.call(this,Wi)}},{type:"Calculation_Or",inputs:2,toDefinition(){return Ln.call(this,Yi)}},{type:"Calculation_GreaterThan",inputs:2,toDefinition(){return Ln.call(this,Gi)}},{type:"Calculation_LessThan",inputs:2,toDefinition(){return Ln.call(this,Xi)}},{type:"Calculation_Equal",inputs:2,toDefinition(){return Ln.call(this,Hi)}},{type:"Calculation_GreaterThanOrEqual",inputs:2,toDefinition(){return Ln.call(this,$i)}},{type:"Calculation_LessThanOrEqual",inputs:2,toDefinition(){return Ln.call(this,qi)}},{type:"Calculation_Not",inputs:1,toDefinition(){return Ln.call(this,Zi,1)}},{type:"Calculation_Formula",toDefinition(){let e=["!","*","/","+","-",">=","<=",">","<","=","&","|"];let t=this.formula.replaceAll(" ","");for(let i in e){let n=e[i];t=t.split(n).join(",")}let i=t.split(","),n=this.formula.replaceAll(" ","");for(let e=0;e<i.length;e++){let t=n.indexOf(i[e]);n=n.substring(0,t)+","+n.substring(t+i[e].length)}n=n.split(","),t="";for(let e=0;e<i.length;e++)if(""!==t&&(t+=","),t+=i[e],i[e].match(/[^,][(]/)&&")"!==i[e][i[e].length-1])for(;++e<i.length&&(t+=n[e]+i[e],")"!==i[e][i[e].length-1]););if(t=t.split(","),t=t.map((e=>"("===e[0]?e.substring(1):e)),t=t.map((e=>{for(;")"===e[e.length-1]&&e.split(")").length>e.split("(").length;)e=e.substring(0,e.length-1);return e})),t=t.filter((e=>!e.match(/^[0-9]*$/))),t=t.filter((e=>0!==e.length)),0===t.length)return;const a=function(t,i){t=t.replaceAll(" ","");for(let e=0;e<i.length;e++)t=t.replaceAll(i[e],`param${e}`);let n,a=[],l=0;if(t.split(")").length!==t.split("(").length)return"Parenthesis start and end not matching";for(;t.split(")").flatMap((e=>e.split("("))).filter((t=>e.some((e=>t.indexOf(e)>-1)))).length>1;){l++;let i=t.split(")").filter((t=>e.some((e=>t.split("(").pop()?.indexOf(e)>-1))))[0].split("(").pop();a.push({resultInto:`$temp${l}`,parameters:[i]}),t=t.replace(`(${i})`,`$temp${l}`)}function s(t){for(let i in e){let n=e[i];t=t.split(n).join(",")}return t.split(",")}"("===t[0]&&")"===t[t.length-1]&&(t=t.substring(1,t.length-1)),a.push({resultInto:"return",parameters:[t]});for(let t in e){let i,n=e[t];for(;(i=a.findIndex((e=>e.parameters.find((e=>e.indexOf(n)>-1)))))>-1;){const e=a[i],t=e.parameters.findIndex((e=>e.indexOf(n)>-1)),r=e.parameters[t],o=s(r.split(n)[0]).pop(),u=s(r.split(n)[1])[0];e.parameters.length>1||s(e.parameters[0].replace(`${o}${n}${u}`,"temp")).length>1?(l++,e.parameters[t]=r.replace(`${o}${n}${u}`,`$temp${l}`),a.splice(i,0,{operator:n,resultInto:`$temp${l}`,parameters:[o,u]})):(a[i].operator=n,a[i].parameters=[o,u])}}for(;(n=a.findIndex((e=>"s"!==e.operator&&e.parameters.find((e=>e.match(/^[0-9]+$/))))))>-1;){const e=a[n],t=e.parameters.findIndex((e=>e.match(/^[0-9]+$/))),i=e.parameters[t];l++,a[n].parameters[t]=`$temp${l}`,a.splice(n,0,{operator:"s",resultInto:`$temp${l}`,parameters:[i]})}l=0;for(let e in a){e=parseInt(e);let t,i=a[e];0===i.resultInto.indexOf("$temp")&&(a.filter((e=>e.parameters.findIndex((e=>e===i.resultInto))>-1)).length<2&&(t=a[e+1]?.parameters?.findIndex((e=>e===i.resultInto)))>-1?a[e+1].parameters[t]=i.resultInto="temp":(l++,a.filter((e=>e.parameters.findIndex((e=>e===i.resultInto))>-1)).forEach((e=>{for(let t in e.parameters)e.parameters[t]===i.resultInto&&(e.parameters[t]=`temp${l}`)})),i.resultInto=`temp${l}`))}for(let e=0;e<a.length;e++){a[e].parameters;for(let t=0;t<a[e].parameters.length;t++)0===a[e].parameters[t].indexOf("param")&&(a[e].parameters[t]=i[parseInt(a[e].parameters[t].substring(5))])}return a}(this.formula,t);if(0==a.length||1==a.length&&null==a[0].operator)return{...this.parameterValues[t[0]],type:"CalculationOrVariableSelection",outputVariables:this.outputVariables};var l={type:"Group",value:[]};let s=this.outputVariables?.[0]?.name;t.forEach((e=>{let t=0===e.indexOf("temp")?e:`${s}_${e}`;t=t.substring(0,-1!==t.indexOf("(")?t.indexOf("("):t.length),l.value.push({...this.parameterValues[e],type:"CalculationOrVariableSelection",outputVariables:[{name:t}]})}));for(let e in a){let t=a[e],i={outputVariables:"return"===t.resultInto?this.outputVariables:[{name:t.resultInto}]};const n=e=>{if("self"===e)return this.outputVariables[0];const t=0===e.indexOf("temp")?e:`${s}_${e}`;return{name:t.substring(0,-1!==t.indexOf("(")?t.indexOf("("):t.length)}};if("s"===t.operator)i.type="Calculation_Static",i.value=t.parameters[0];else if("!"===t.operator)i.type="Calculation_Not",i.inputVariables=[n(t.parameters[1])];else switch(i.inputVariables=t.parameters.map(n),t.operator){case"*":i.type="Calculation_Multiply";break;case"/":i.type="Calculation_Divide";break;case"+":i.type="Calculation_Add";break;case"-":i.type="Calculation_Subtract";break;case">=":i.type="Calculation_GreaterThanOrEqual";break;case"<=":i.type="Calculation_LessThanOrEqual";break;case">":i.type="Calculation_GreaterThan";break;case"<":i.type="Calculation_LessThan";break;case"=":i.type="Calculation_Equal";break;case"&":i.type="Calculation_And";break;case"|":i.type="Calculation_Or"}l.value.push(i)}return l}},{type:"CAN_ReadData",toDefinition(){return{type:"definition",value:[{type:"UINT32",value:Ki+hn},{type:"UINT32",value:this.canBus<<29|this.canID},{type:"UINT32",value:Pi+Li},{type:"UINT32",value:Ki+cn},{type:"UINT8",value:this.parseData.length},...this.parseData.map((e=>{const t=e.bitLength<2;return{type:"definition",value:[{type:"FLOAT",value:e.multiplier},{type:"FLOAT",value:e.adder},{type:"UINT8",value:e.bitLocation},{type:"UINT8",value:e.bitLength},{type:"UINT8",value:0|t}]}})),...this.parseData.map((e=>{const t=e.bitLength<2;return{type:"VariableId",value:{name:`${this.name}.${e.name}`,type:t?"bool":void 0,unit:t?void 0:e.unit}}})),{type:"UINT32",value:0}]}}},{type:"CAN_WriteData",toDefinition(){let e=0;const t=this.packData.map((t=>{t.variable.outputVariables=[{name:"temp"+e++}]}));return{type:"definition",value:[{type:"UINT32",value:Ki+un},{type:"FLOAT",value:1/this.interval},{type:"Group",value:[...t.map((e=>({...e.variable,type:"CalculationOrVariableSelection"}))),{type:"definition",value:[{type:"UINT32",value:Pi+Li},{type:"UINT32",value:Ki+pn},{type:"UINT64",value:0},{type:"UINT8",value:this.packData.length},...t.map((e=>{const t=e.bitLength<2;return{type:"definition",value:[{type:"FLOAT",value:e.multiplier},{type:"FLOAT",value:e.adder},{type:"UINT8",value:e.bitLocation},{type:"UINT8",value:e.bitLength},{type:"UINT8",value:t}]}})),{type:"VariableId",value:{name:"temp"}},...t.map((e=>({type:"VariableId",value:e.variable.outputVariables[0]})))]},{type:"definition",value:[{type:"UINT32",value:Pi+Li},{type:"UINT32",value:Ki+dn},{type:"UINT32",value:this.canBus<<29|this.canID},{type:"VariableId",value:{name:"temp"}}]}]}]}}},{type:"Input_Analog",outputUnits:["V"],toDefinition(){return Pn({type:"definition",value:[{type:"UINT32",value:Ki+Qi},{type:"UINT16",value:this.pin}]},this)}},{type:"Input_AnalogPolynomial",toDefinition(){const e={name:this.outputVariables[0].name,unit:"V"};return{type:"Group",value:[{...this.analogInput,type:"Input_Analog",outputVariables:[e]},{...this.polynomial,type:"Calculation_Polynomial",outputVariables:this.outputVariables,inputVariables:[e]}]}}},{type:"Input_Digital",toDefinition(){return Pn({type:"definition",value:[{type:"UINT32",value:Ki+en},{type:"UINT16",value:this.pin},{type:"BOOL",value:this.inverted}]},this)}},{type:"Input_DigitalRecord",toDefinition(){return Pn({type:"definition",value:[{type:"UINT32",value:Ki+tn},{type:"UINT16",value:this.pin},{type:"BOOL",value:this.inverted},{type:"UINT16",value:this.length}]},this)}},{type:"Input_DutyCycle",outputUnits:["%"],toDefinition(){return Pn({type:"definition",value:[{type:"UINT32",value:Ki+nn},{type:"UINT16",value:this.pin},{type:"UINT16",value:this.minFrequency}]},this)}},{type:"Input_Frequency",outputUnits:["Hz"],toDefinition(){return Pn({type:"definition",value:[{type:"UINT32",value:Ki+an},{type:"UINT16",value:this.pin},{type:"UINT16",value:this.minFrequency}]},this)}},{type:"Input_PulseWidth",outputUnits:["s"],toDefinition(){return Pn({type:"definition",value:[{type:"UINT32",value:Ki+ln},{type:"UINT16",value:this.pin},{type:"UINT16",value:this.minFrequency}]},this)}},{type:"Output_Digital",toDefinition(){return Pn({type:"definition",value:[{type:"UINT32",value:Ki+sn},{type:"UINT16",value:this.pin},{type:"UINT8",value:this.inverted|(this.highZ?2:0)}]},this)}},{type:"Output_PWM",toDefinition(){return this.inputVariables??=[void 0,void 0],this.inputVariables[0]={name:"temp0",unit:"s"},this.inputVariables[1]={name:"temp1",unit:"s"},{type:"Group",value:[{...this.period,type:"CalculationOrVariableSelection",outputVariables:[this.inputVariables[0]]},{...this.pulseWidth,type:"CalculationOrVariableSelection",outputVariables:[this.inputVariables[1]]},Pn({type:"definition",value:[{type:"UINT32",value:Ki+rn},{type:"UINT16",value:this.pin},{type:"UINT16",value:this.minFrequency}]},this)]}}},{type:"Reluctor_GM24x",toDefinition(){return Mn.call(this,{type:"definition",value:[{type:"UINT32",value:mn+fn}]})}},{type:"Reluctor_Universal1x",toDefinition(){let e={type:"definition",value:[{type:"UINT32",value:mn+vn},{type:"UINT8",value:this.mode}]};return 0!==this.mode&&1!==this.mode||e.value.push({type:"FLOAT",value:this.risingPosition}),0!==this.mode&&1!==this.mode||e.value.push({type:"FLOAT",value:this.fallingPosition}),Mn.call(this,e)}},{type:"Reluctor_UniversalMissingTeeth",toDefinition(){return Mn.call(this,{type:"definition",value:[{type:"UINT32",value:mn+gn},{type:"FLOAT",value:this.firstToothPosition},{type:"FLOAT",value:this.toothWidth},{type:"UINT8",value:this.numberOfTeeth},{type:"UINT8",value:this.numberOfTeethMissing}]})}},{type:"TPS_Linear",toDefinition(){return this.type="Input_AnalogPolynomial",this}},{type:"MAP_GM1Bar",toDefinition(){return this.type="Input_AnalogPolynomial",this}},{type:"MAP_GM2Bar",toDefinition(){return this.type="Input_AnalogPolynomial",this}},{type:"MAP_GM3Bar",toDefinition(){return this.type="Input_AnalogPolynomial",this}},{type:"Input",toDefinition(){if(null==this.translationConfig)return;const e={name:`Inputs.${this.name}`,unit:this.translationConfig.outputUnits?.[0],type:this.translationConfig.outputTypes?.[0]};if(0===(this.translationConfig.inputTypes?.length??0)&&0===(this.translationConfig.inputUnits?.length??0))return{...this.translationConfig,type:"CalculationOrVariableSelection",outputVariables:[e]};const t={name:`Inputs.${this.name}`,unit:this.rawConfig.outputUnits?.[0],type:this.rawConfig.outputTypes?.[0]};return this.rawConfig={...this.rawConfig,type:"CalculationOrVariableSelection",outputVariables:[t]},{type:"Group",value:[{...this.rawConfig,type:"CalculationOrVariableSelection"},{...this.translationConfig,type:"CalculationOrVariableSelection",outputVariables:[e],inputVariables:[t]}]}}},{type:"Inputs",toDefinition(){return{type:"ConfigList",value:this.value,itemType:"Input"}}},{type:"CylinderAirmass_AlphaN",outputUnits:["g"],toDefinition(){return{...this.Airmass,type:"CalculationOrVariableSelection",outputVariables:this.outputVariables}}},{type:"CylinderAirmass_SpeedDensity",outputUnits:["g"],toDefinition(){return this.inputVariables=[{name:"EngineParameters.Cylinder Air Temperature"},{name:"EngineParameters.Manifold Absolute Pressure"},{name:"EngineParameters.Volumetric Efficiency"}],Pn({type:"definition",value:[{type:"UINT32",value:yn+bn},{type:"FLOAT",value:this.CylinderVolume}]},this)}},{type:"InjectorPulseWidth_DeadTime",outputUnits:["s"],toDefinition(){return{type:"Group",value:[{...this.FlowRate,type:"CalculationOrVariableSelection",outputVariables:[{name:"FuelParameters.Injector Flow Rate"}]},{...this.DeadTime,type:"CalculationOrVariableSelection",outputVariables:[{name:"FuelParameters.Injector Dead Time"}]},{type:"Calculation_Static",value:2,outputVariables:[{name:"SquirtsPerCycle"}]},{type:"Calculation_Subtract",outputVariables:[{name:"SquirtsPerCycle"}],inputVariables:[{name:"SquirtsPerCycle"},{name:"EngineSequentialId"}]},Pn({type:"definition",value:[{type:"UINT32",value:yn+Vn},{type:"FLOAT",value:this.MinInjectorFuelMass}]},{...this,inputVariables:[{name:"SquirtsPerCycle"},{name:"FuelParameters.Cylinder Fuel Mass"},{name:"FuelParameters.Injector Flow Rate"},{name:"FuelParameters.Injector Dead Time"}]})]}}},{type:"ConfigList",toDefinition(){return{type:"Group",value:this.value.map((e=>{const t=Object.keys(e),i=this.staticItems?.find((e=>e.name===t[0]));return 1===t.length&&void 0!==i?Array.isArray(e[i.name])||"object"!=typeof e[i.name]?{value:e[i.name],type:i.type}:{...e[i.name],type:i.type}:{...e,type:this.itemType}})),staticItems:void 0,itemType:void 0}}},{type:"Fuel",toDefinition(){return{types:[{type:"Fuel_InjectorOutput",toDefinition(){return{type:"definition",value:[{type:"Package",value:[{type:"UINT32",value:yn+Un},{type:"FLOAT",value:this.TDC},{...this,type:"CalculationOrVariableSelection"}],outputVariables:[{name:"temp"},{name:"temp"}],inputVariables:[{name:"EnginePositionId"},{name:"FuelParameters.Injector Enable"},{name:"FuelParameters.Injector Pulse Width"},{name:"FuelParameters.Injector End Position"}]}]}}},{type:"Fuel_AFR",toDefinition(){return{type:"Group",value:[{...this,type:"Fuel_GenericCalculation"},{type:"Calculation_Divide",outputVariables:[{name:"FuelParameters.Cylinder Fuel Mass"}],inputVariables:[{name:"EngineParameters.Cylinder Air Mass"},{name:"FuelParameters.Air Fuel Ratio"}]}]}}},{type:"Fuel_InjectorProperties",toDefinition(){return{type:"Group",value:[{...this.InjectorEnable,type:"CalculationOrVariableSelection",outputVariables:[{name:"FuelParameters.Injector Enable"}]},{...this.InjectorPulseWidth,type:"CalculationOrVariableSelection",outputVariables:[{name:"FuelParameters.Injector Pulse Width"}]},{...this.InjectorEndPosition,type:"CalculationOrVariableSelection",outputVariables:[{name:"FuelParameters.Injector End Position"}]}]}}},{type:"Fuel_InjectorOutputs",toDefinition(){return{type:"Group",value:this.value.map((e=>({...e,type:"Fuel_InjectorOutput"})))}}},{type:"Fuel_GenericCalculation",toDefinition(){return{...this,type:"GenericCalculation",outputVariables:[{name:"FuelParameters."}]}}}],type:"ConfigList",value:this.value,itemType:"Fuel_GenericCalculation",staticItems:[{name:"AFR",type:"Fuel_AFR"},{name:"InjectorProperties",type:"Fuel_InjectorProperties"},{name:"InjectorOutputs",type:"Fuel_InjectorOutputs"}]}}},{type:"Ignition",toDefinition(){return{types:[{type:"Ignition_IgnitionOutput",toDefinition(){return{type:"definition",value:[{type:"Package",value:[{type:"UINT32",value:yn+_n},{type:"FLOAT",value:this.TDC},{...this,type:"CalculationOrVariableSelection"}],outputVariables:[{name:"temp"},{name:"temp"}],inputVariables:[{name:"EnginePositionId"},{name:"IgnitionParameters.Ignition Enable"},{name:"IgnitionParameters.Ignition Dwell"},{name:"IgnitionParameters.Ignition Advance"},{name:"IgnitionParameters.Ignition Dwell Deviation"}]}]}}},{type:"Ignition_IgnitionProperties",toDefinition(){return{type:"Group",value:[{...this.IgnitionEnable,type:"CalculationOrVariableSelection",outputVariables:[{name:"IgnitionParameters.Ignition Enable"}]},{...this.IgnitionAdvance,type:"CalculationOrVariableSelection",outputVariables:[{name:"IgnitionParameters.Ignition Advance"}]},{...this.IgnitionDwell,type:"CalculationOrVariableSelection",outputVariables:[{name:"IgnitionParameters.Ignition Dwell"}]},{...this.IgnitionDwellDeviation,type:"CalculationOrVariableSelection",outputVariables:[{name:"IgnitionParameters.Ignition Dwell Deviation"}]}]}}},{type:"Ignition_IgnitionOutputs",toDefinition(){return{type:"Group",value:this.value.map((e=>({...e,type:"Ignition_IgnitionOutput"})))}}},{type:"Ignition_GenericCalculation",toDefinition(){return{...this,type:"GenericCalculation",outputVariables:[{name:"IgnitionParameters."}]}}}],type:"ConfigList",value:this.value,itemType:"Ignition_GenericCalculation",staticItems:[{name:"IgnitionProperties",type:"Ignition_IgnitionProperties"},{name:"IgnitionOutputs",type:"Ignition_IgnitionOutputs"}]}}},{type:"Engine",toDefinition(){return{types:[{type:"Engine_EngineSensors",toDefinition(){let e={type:"Group",value:[{...this.CrankPosition,type:"CalculationOrVariableSelection",outputVariables:[{name:"EngineParameters.Crank Position"}]},{...this.CamPosition,type:"CalculationOrVariableSelection",outputVariables:[{name:"EngineParameters.Cam Position"}]},{type:"Package",value:[{type:"UINT32",value:yn+(this.CrankPriority?xn:En)}],outputVariables:[{name:"EnginePositionId"}],inputVariables:[{name:"EngineParameters.Crank Position"},{name:"EngineParameters.Cam Position"}]},{type:"Package",value:[{type:"UINT32",value:yn+wn}],outputVariables:[{name:"EngineParameters.Engine Speed"},{name:"EngineSequentialId"},{name:"EngineSyncedId"}],inputVariables:[{name:"EnginePositionId"}]}]};return void 0!==this.ManifoldAbsolutePressure&&e.value.push({...this.ManifoldAbsolutePressure,type:"CalculationOrVariableSelection",outputVariables:[{name:"EngineParameters.Manifold Absolute Pressure"}]}),void 0!==this.ThrottlePosition&&e.value.push({...this.ThrottlePosition,type:"CalculationOrVariableSelection",outputVariables:[{name:"EngineParameters.Throttle Position"}]}),void 0!==this.CylinderAirTemperature&&e.value.push({...this.CylinderAirTemperature,type:"CalculationOrVariableSelection",outputVariables:[{name:"EngineParameters.Cylinder Air Temperature"}]}),e}},{type:"Engine_EngineCalculations",toDefinition(){let e={type:"Group",value:[]};return void 0!==this.VolumetricEfficiency&&e.value.push({...this.VolumetricEfficiency,type:"CalculationOrVariableSelection",outputVariables:[{name:"EngineParameters.Volumetric Efficiency"}]}),e.value.push({...this.CylinderAirmass,type:"CalculationOrVariableSelection",outputVariables:[{name:"EngineParameters.Cylinder Air Mass"}]}),e}},{type:"Engine_GenericCalculation",toDefinition(){return{...this,type:"GenericCalculation",outputVariables:[{name:"EngineParameters."}]}}}],type:"ConfigList",value:this.value,itemType:"Engine_GenericCalculation",staticItems:[{name:"EngineSensors",type:"Engine_EngineSensors"},{name:"EngineCalculations",type:"Engine_EngineCalculations"}]}}},{type:"CAN",toDefinition(){return{types:[{type:"CAN_GenericCalculation",toDefinition(){return{...this,type:"GenericCalculation",outputVariables:[{name:"CANParameters."}]}}}],type:"ConfigList",value:this.value,itemType:"CAN_GenericCalculation"}}},{type:"Outputs",toDefinition(){return{types:[{type:"Output_GenericCalculation",toDefinition(){return{...this,type:"GenericCalculation",outputVariables:[{name:"Outputs."}]}}}],type:"ConfigList",value:this.value,itemType:"Output_GenericCalculation"}}},{type:"TopEngine",toDefinition(){return(ki=new VariableRegistry).CreateIfNotFound=!0,{type:"definition",value:[{type:"UINT32",value:0},{type:"Group",value:[{type:"Package",value:[{type:"UINT32",value:Ki+on}],outputVariables:[{name:"CurrentTick",type:"tick"}]},{type:"Inputs",value:this.Inputs},{type:"CAN",value:this.CAN},{type:"Engine",value:this.Engine}]},{type:"Group",value:[]},{type:"Group",value:[{type:"Calculation_Static",value:!1,outputVariables:[{name:"temp"}]},{type:"Calculation_Or",inputVariables:[{name:"EngineSyncedId"},{name:"temp"}]}]},{type:"Group",value:[{type:"Fuel",value:this.Fuel},{type:"Ignition",value:this.Ignition}]}]}},toArrayBuffer(){let e=Ci({type:"definition",value:[this],types:Nn});e=new Uint32Array([e.byteLength]).buffer.concatArray(e),e=e.concatArray(new Uint32Array([e.crc32()]).buffer);let t=Vi.gzip((new TextEncoder).encode(JSON.stringify(ki.GetVariableReferenceList()))).buffer;return t=new Uint32Array([t.byteLength]).buffer.concatArray(t),t=t.concatArray(new Uint32Array([t.crc32()]).buffer),e.concatArray(t)}},{type:"TopExpander",toDefinition(){return(ki=new VariableRegistry).CreateIfNotFound=!0,{type:"definition",value:[{type:"UINT32",value:0},{type:"Group",value:[{type:"Package",value:[{type:"UINT32",value:Ki+on}],outputVariables:[{name:"CurrentTick",type:"tick"}]},{type:"Inputs",value:this.Inputs},{type:"CAN",value:this.CAN},{type:"Outputs",value:this.Outputs}]}]}},toArrayBuffer(){let e=Ci({type:"definition",value:[this],types:Nn});e=new Uint32Array([e.byteLength]).buffer.concatArray(e),e=e.concatArray(new Uint32Array([e.crc32()]).buffer),console.log(ki.GetVariableReferenceList());let t=Vi.gzip((new TextEncoder).encode(JSON.stringify(ki.GetVariableReferenceList()))).buffer;return t=new Uint32Array([t.byteLength]).buffer.concatArray(t),t=t.concatArray(new Uint32Array([t.crc32()]).buffer),e.concatArray(t)}}];for(var Dn in Cn){var Fn=Nn.find((e=>e.type==kn[Dn].type));Fn&&(Fn.align=kn[Dn].align)}class UITemplate extends HTMLSpanElement{constructor(e){super(),e&&this.Setup(e)}Setup(e){e??={};const t=e.saveValue,i=e.value;delete e.saveValue,delete e.value,Object.assign(this,e),null!=t&&(this.saveValue=t),null!=i&&(this.value=i);let n=Object.entries(this);const a=this.template??this.constructor.template;this.innerHTML=a,this.querySelectorAll("[data-element]").forEach((e=>{let t=n.find((([t,i])=>e.dataset.element===t));if(!t)return;let[i,a]=t;e.replaceWith(a)}))}get saveValue(){let e={};if(Object.entries(this).forEach((([t,i])=>{null!=i?.saveValue&&(e[t]=i.saveValue)})),0!==Object.keys(e).length)return e}set saveValue(e){null!=e&&Object.entries(this).forEach((([t,i])=>{null!=e[t]&&"object"==typeof i&&Object.keys(i).indexOf("saveValue")&&(i.saveValue=e[t])}))}get value(){let e={};if(Object.entries(this).forEach((([t,i])=>{null!=i?.value&&(e[t]=i.value)})),0!==Object.keys(e).length)return e}set value(e){null!=e&&Object.entries(this).forEach((([t,i])=>{null!=e[t]&&"object"==typeof i&&(i.value=e[t])}))}}customElements.define("ui-template",UITemplate,{extends:"span"});class UINumber extends HTMLInputElement{#o;get value(){return this.#o}set value(e){if(e=parseFloat(e),parseFloat(this.value)===e)return;const t=this.value;super.value=isNaN(e)?"":e,this.#o=e,t===this.value||isNaN(t)&&isNaN(this.value)||super.dispatchEvent(new Event("change",{bubbles:!0}))}get min(){return super.min}set min(e){super.min=e,null!=e&&null!=this.value&&this.value<parseFloat(e)&&(this.value=e)}get max(){return super.max}set max(e){super.max=e,null!=e&&null!=this.value&&this.value>parseFloat(e)&&(this.value=e)}get saveValue(){return this.value}set saveValue(e){this.value=e}constructor(e){super(),this.type="number",this.class="ui number",Object.assign(this,e),this.addEventListener("change",(()=>{this.#o=parseFloat(super.value);const e=parseFloat(super.min),t=parseFloat(super.max);!isNaN(this.#o)&&!isNaN(e)&&this.#o<e&&(this.#o=e),!isNaN(this.#o)&&!isNaN(t)&&this.#o>t&&(this.#o=t)}))}}function zn(e,t=6){return e=parseFloat(e),isNaN(e)?"&nbsp;":Math.abs(e)<1?parseFloat(e.toFixed(t-1)):parseFloat(e.toPrecision(t))}function Bn(e,t=1){let i=18e18,n=-9e18;for(let t=0;t<e.length;t++){let a=e[t];a<i&&(i=a),a>n&&(n=a)}return t&&n===i&&(n=i+t),[i,n]}function jn(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("number"==typeof e&&isNaN(e)&&isNaN(t))return!0;var i=Wn(e);if(i!=Wn(t))return!1;if("[object Boolean]"==i||"[object String]"==i||"[object Number]"==i)return e.valueOf()==t.valueOf();if("[object RegExp]"==i||"[object Date]"==i||"[object Error]"==i)return e.toString()==t.toString();if("object"==typeof e||"function"==typeof e){if("[object Function]"==i&&e.toString()!=t.toString())return!1;var n=Object.keys(e),a=Object.keys(t);return n.length==a.length&&(!!n.every((function(e){return t.hasOwnProperty(e)}))&&n.every((function(i){return jn(e[i],t[i])})))}return!1}function Wn(e){return Object.prototype.toString.call(e)}customElements.define("ui-number",UINumber,{extends:"input"});class UISelection extends HTMLDivElement{static ParseValue(e,t){switch(e){case"number":return parseFloat(t);case"boolean":if("number"==typeof t)return 0!==t;if("boolean"==typeof t)return t;if("string"==typeof t)return"true"===t||"True"===t||"1"===t;if("object"==typeof t)return!!t;case"string":if("number"==typeof t||"boolean"==typeof t)return`${t}`;if("string"==typeof t)return t;if("object"==typeof t)return JSON.stringify(t);case"object":if("number"==typeof t||"boolean"==typeof t||"object"==typeof t)return t;if("string"==typeof t)return JSON.parse(t)}}#u=!1;get selectDisabled(){return this.#u}set selectDisabled(e){this.#u=e,this.selectHidden||Yn(this.#h,{name:this.selectName,disabled:this.selectDisabled,value:this.selectValue})}#d="select";get selectName(){return this.#d}set selectName(e){this.#d!==e&&(this.#d=e,null==this.selectedOption&&(this.selectedElement.textContent=this.selectName),this.selectHidden||Yn(this.#h,{name:this.selectName,disabled:this.selectDisabled,value:this.selectValue}))}#c=void 0;get selectValue(){return this.#c}set selectValue(e){this.#c!==e&&(this.#c=e,null==this.selectedOption&&(this.selectedElement.value=UISelection.ParseValue("string",e),this.selectedElement.type=typeof e),this.selectHidden||Yn(this.#h,{name:this.selectName,disabled:this.selectDisabled,value:this.selectValue}))}#h;#p=!1;get selectHidden(){return this.#p}set selectHidden(e){this.#p!==e&&(this.#p=e,this.selectHidden?null!=this.contextMenuElement.children[0]&&this.contextMenuElement.removeChild(this.contextMenuElement.children[0]):Yn(this.#h,{name:this.selectName,disabled:this.selectDisabled,value:this.selectValue}))}collapse=20;#m(){const e=this.selectedElement;this.contextMenuElement.querySelectorAll(".selectoption, .selectgroup").length>=this.collapse&&this.collapse>0?this.contextMenuElement.classList.add("collapsible"):this.contextMenuElement.classList.remove("collapsible");let t=!1;[...this.contextMenuElement.children].forEach((i=>{let n=!1;[...i.children].forEach((i=>{null==e.value||i.value!==e.value?i.classList.remove("selected"):(i.classList.add("selected"),t=!0,n=!0)})),n?i.classList.remove("collapsed"):i.classList.add("collapsed"),i.value!==e.value?i.classList.remove("selected"):(i.classList.add("selected"),t=!0)}));const i=this.selectedOption?.selectedName??this.selectedOption?.name??this.selectName;e.textContent!==i&&(e.textContent=i),t||this.#h.classList.add("selected"),this.options.map((e=>e.options?.length??1)).reduce(((e,t)=>e+t),0)<(this.selectHidden?2:1)?e.classList.add("single"):e.classList.remove("single")}#e=[];get options(){return this.#e}set options(e){if(null==e&&(e=[]),jn(this.#e,e))return;this.#e=e;const t=e.length+(this.selectHidden?0:1);for(;t<this.contextMenuElement.children.length;)this.contextMenuElement.removeChild(this.contextMenuElement.children[t]);this.selectHidden||(this.#h=this.contextMenuElement.children[0],null==this.#h&&(this.#h=this.contextMenuElement.appendChild(document.createElement("div"))),Yn(this.#h,{name:this.selectName,disabled:this.selectDisabled,value:this.selectValue})),e.forEach(((e,t)=>{let i=this.contextMenuElement.children[t+(this.selectHidden?0:1)];null==i&&(i=this.contextMenuElement.appendChild(document.createElement("div"))),Yn(i,e)})),this.#m()}get selectedOption(){const e=this.selectedElement.value;let t=this.options.find((t=>UISelection.ParseValue("string",t.value)===e||t.options?.findIndex((t=>UISelection.ParseValue("string",t.value)===e))>-1));return t?.group&&(t=t.options.find((t=>UISelection.ParseValue("string",t.value)===e))),t}set selectedOption(e){this.value=e.value}get value(){return UISelection.ParseValue(this.selectedElement.type,this.selectedElement.value)}set value(e){if(this.selectHidden&&null==this.value&&1===this.options.length&&(e=this.options[0].value),jn(this.value,e))return;const t=this.selectedElement;t.type=typeof e,t.value=UISelection.ParseValue("string",e),this.#m(),this.dispatchEvent(new Event("change",{bubbles:!0}))}get saveValue(){return this.value}set saveValue(e){this.value=e}constructor(e){super(),this.class="ui select",this.selectedElement=this.appendChild(document.createElement("div")),this.selectedElement.class="ui selected",this.contextMenuElement=document.createElement("div"),this.contextMenuElement.class="ui context-menu",this.#h=document.createElement("div"),this.contextMenuElement.prepend(this.#h),Yn(this.#h,{name:this.selectName,disabled:this.selectDisabled,value:this.selectValue}),Object.assign(this,e);let t=!1,i=!1;this.selectedElement.addEventListener("click",(()=>{if(this.#m(),t)return;if(this.selectHidden&&this.options.length<2)return;if(this.selectedElement.classList.contains("single"))return;const e=()=>{if(i)return i=!1;t&&(this.removeChild(this.contextMenuElement),document.removeEventListener("click",e),t=!1)};document.addEventListener("click",e),window.setTimeout((()=>{this.append(this.contextMenuElement),t=!0}),1)})),this.contextMenuElement.addEventListener("click",(e=>{if(!e.target.classList.contains("selectdisabled"))return e.target.classList.contains("selectgroup")&&this.contextMenuElement.classList.contains("collapsible")?(e.target.parentElement.classList.contains("collapsed")?e.target.parentElement.classList.remove("collapsed"):e.target.parentElement.classList.add("collapsed"),void(i=!0)):void(e.target.classList.contains("selectoption")&&(this.value=UISelection.ParseValue(e.target.type,e.target.value)))})),this.#m()}}function Yn(e,t){if(e.removeAttribute("class"),t.group){delete e.type,delete e.value;let i=document.createElement("div");e.replaceChildren(i),i.classList.add("selectgroup"),i.textContent=t.group,t.options.forEach((t=>{Yn(e.appendChild(document.createElement("div")),t)}))}else e.classList.add("selectoption"),t.disabled&&e.classList.add("selectdisabled"),e.type=typeof t.value,e.value=UISelection.ParseValue("string",t.value),e.textContent=t.name+(t.info?` ${t.info}`:"")}customElements.define("ui-selection",UISelection,{extends:"div"});let Gn=[{name:"",SIMultiplier:1,SIOffset:0}],Xn=[{name:"%",SIMultiplier:100,SIOffset:0},{name:"[0.0-1.0]",SIMultiplier:1,SIOffset:0}],Hn=Xn.map((e=>({name:e.name+"/s",SIMultiplier:e.SIMultiplier,SIOffset:e.SIOffset})));let $n={"No Unit":Gn,Voltage:[{name:"V",SIMultiplier:1,SIOffset:0},{name:"mV",SIMultiplier:1e3,SIOffset:0}],Temperature:[{name:"°C",SIMultiplier:1,SIOffset:0},{name:"°F",SIMultiplier:1.8,SIOffset:32}],Pressure:[{name:"Bar",SIMultiplier:1,SIOffset:0},{name:"kPa",SIMultiplier:100,SIOffset:0},{name:"PSI",SIMultiplier:14.5038,SIOffset:0}],Mass:[{name:"g",SIMultiplier:1,SIOffset:0},{name:"mg",SIMultiplier:1e3,SIOffset:0},{name:"kg",SIMultiplier:.001,SIOffset:0}],MassFlow:[{name:"g/s",SIMultiplier:1,SIOffset:0},{name:"g/min",SIMultiplier:60,SIOffset:0}],Volume:[{name:"L",SIMultiplier:1,SIOffset:0},{name:"mL",SIMultiplier:1e3,SIOffset:0}],Speed:[{name:"KPH",SIMultiplier:1,SIOffset:0},{name:"MPH",SIMultiplier:1.61,SIOffset:0}],Time:[{name:"s",SIMultiplier:1,SIOffset:0},{name:"ms",SIMultiplier:1e3,SIOffset:0},{name:"us",SIMultiplier:1e6,SIOffset:0},{name:"ns",SIMultiplier:1e9,SIOffset:0}],Frequency:[{name:"Hz",SIMultiplier:1,SIOffset:0},{name:"KHz",SIMultiplier:.001,SIOffset:0},{name:"MHz",SIMultiplier:1e-6,SIOffset:0}],Percentage:Xn,PercentageAcceleration:Hn,Lambda:[{name:"λ",SIMultiplier:1,SIOffset:0}],Angle:[{name:"°",SIMultiplier:1,SIOffset:0}],AngularSpeed:[{name:"RPM",SIMultiplier:1,SIOffset:0}],Ratio:[{name:":1",SIMultiplier:1,SIOffset:0}],Resistance:[{name:"Ω",SIMultiplier:1,SIOffset:0},{name:"kΩ",SIMultiplier:.001,SIOffset:0}]};function qn(e){switch(e){case"%":return{min:0,max:100,step:10,lowRedline:void 0,highRedline:void 0};case"[0.0-1.0]":return{min:0,max:1,step:.1,lowRedline:void 0,highRedline:void 0};case"RPM":return{min:0,max:8e3,step:1e3,lowRedline:void 0,highRedline:6500};case"Bar":return{min:.2,max:3,step:.2,lowRedline:.25,highRedline:void 0};case"kPa":return{min:20,max:300,step:20,lowRedline:25,highRedline:void 0};case"V":return{min:0,max:5,step:1,lowRedline:void 0,highRedline:void 0};case"mV":return{min:0,max:5e3,step:1e3,lowRedline:void 0,highRedline:void 0}}}function Zn(e){return null==e?void 0:$n[Jn(e)]?.find((t=>t.name===e))??$n[Jn(e)]?.find((t=>t.name===`°${e}`))??Gn[0]}function Jn(e){if(Array.isArray(e))return e.map((e=>Jn(e)));for(let t in $n)for(let i in $n[t])if(e===$n[t][i].name)return t;for(let t in $n)for(let i in $n[t])if(`°${e}`===$n[t][i].name)return t;return"None"}function Kn(e,t,i){let n=Jn(t);t=Zn(t);let a=Jn(i);return i=Zn(i),null==e||null==t||null==i||n!==a||t===i?e:Array.isArray(e)?e.map((e=>null==e?e:(e-t.SIOffset)/t.SIMultiplier*i.SIMultiplier+i.SIOffset)):(e-t.SIOffset)/t.SIMultiplier*i.SIMultiplier+i.SIOffset}class UIUnit extends UISelection{static allMeasurementOptions=Object.keys($n).map((e=>0===$n[e].length||1===$n[e].length&&""===$n[e][0].name?{name:e,value:""}:1===$n[e].length?{selectedName:$n[e][0].name,name:`${e} [${$n[e][0].name}]`,value:$n[e][0].name}:{group:e,options:$n[e]?.map((e=>({selectedName:e.name,name:`${e.name}`,value:e.name})))}));_hidden=!1;get hidden(){return this._hidden}set hidden(e){this._hidden=e,e||0===this.options.length?super.hidden=!0:super.hidden=!1}get value(){return super.value}set value(e){super.value=e}_measurement;get measurement(){return Array.isArray(this._measurement)?this._measurement.find((e=>e===Jn(this.value))):this._measurement}set measurement(e){jn(this._measurement,e)||(e?(this._measurement=e,Jn(this.default)!==e&&(this.default=function(e){return Array.isArray(e)&&(e=e[0]),$n[e]?.[0]?.name}(e)),Array.isArray(e)||(e=[e]),e.length>1?this.options=UIUnit.allMeasurementOptions.filter((t=>-1!==e.indexOf(t.group)||e.some((e=>0===t.name?.indexOf(e))))).map((e=>e.group?{group:e.group,options:e.options.map((e=>({...e,selectedName:void 0})))}:{...e,selectedName:""===e.value?e.selectedName:e.value})):this.options=$n[e[0]]?.map((e=>({name:e.name,value:e.name}))),null==this.selectedOption&&(this.value=this.default)):(this.options=UIUnit.allMeasurementOptions,this.default=""),null!=this.value&&""!==this.value&&null!==this.value||(this.value=this.default),0===this.options.length?super.hidden=!0:this.hidden||(super.hidden=!1))}get saveValue(){if(this.value!==this.default)return super.saveValue}set saveValue(e){null!=e&&""!==e&&(super.saveValue=e)}constructor(e){e??={},e.options??=UIUnit.allMeasurementOptions,super(e),(e?.measurement||e?.value)&&(this.default=this.value),this.class="ui unit",this.selectHidden=!0}}customElements.define("ui-unit",UIUnit,{extends:"div"});class UINumberWithUnit extends UITemplate{static template='<div data-element="displayValueElement"></div><div data-element="displayUnitElement"></div>';get measurement(){return this.displayUnitElement.measurement}set measurement(e){this.displayUnitElement.measurement=e}get displayUnit(){return this.displayUnitElement.value}set displayUnit(e){this.displayUnitElement.value=e??this._valueUnit}get displayValue(){return this.displayValueElement.value}set displayValue(e){this.displayValueElement.value=e}_valueUnit;get valueUnit(){return this._valueUnit??this.displayUnit}set valueUnit(e){if(this._valueUnit===e)return;let t=Kn(this.value,this._valueUnit,e);this._valueUnit=e,this.measurement=Jn(e),this.displayUnit??=e,this.value=t}#o;get value(){return this.#o}set value(e){this.#o!==e&&(this.#o=e,this.UpdateDisplayValue())}set class(e){this.displayValueElement.class=e}#f;get min(){return this.#f}set min(e){this.#f!==e&&(this.#f=e,this.UpdateDisplayValue())}#v;get max(){return this.#v}set max(e){this.#v!==e&&(this.#v=e,this.UpdateDisplayValue())}#g;get step(){return this.#g}set step(e){this.#g!==e&&(this.#g=e,this.UpdateDisplayValue())}constructor(e){super(),this.displayUnitElement=new UIUnit({measurement:e?.measurement,value:e?.displayUnit??e?.valueUnit}),this.displayUnitElement.addEventListener("change",(()=>{this.UpdateDisplayValue()})),this.displayValueElement=new UINumber,this.displayValueElement.addEventListener("change",(()=>{null!=this.displayValue&&(this.#o=Kn(this.displayValue,this.displayUnit,this.valueUnit))})),this.Setup(e)}#y=!1;get unitHidden(){return this.#y}set unitHidden(e){this.#y=e,void 0!==this.measurement?this.displayUnitElement.hidden=e:this.displayUnitElement.hidden=!0}get saveValue(){return{displayUnit:this.displayUnitElement.saveValue,value:this.value}}set saveValue(e){"object"==typeof e?(null!=e.displayUnit&&(this.displayUnitElement.saveValue=e.displayUnit),this.value=e.value??e.value):this.value=e}UpdateDisplayValue(){const e=this.displayUnit,t=this.valueUnit,i=i=>void 0!==i&&e?Kn(i,t,e):i,n=this.value;this.displayValueElement.min=i(this.min)??this.displayValueElement.min,this.displayValueElement.max=i(this.max)??this.displayValueElement.max,this.displayValueElement.step=i(this.step)??this.displayValueElement.step,this.displayValue=i(n)}}customElements.define("ui-numberwithunit",UINumberWithUnit,{extends:"span"});class UIDisplayNumberWithUnit extends UINumberWithUnit{static template='<div data-element="displayElement"></div><div data-element="displayUnitElement"></div>';ZeroesToAdd=1e7;displayElement=document.createElement("div");constructor(e){super(),this.displayUnitElement.addEventListener("change",(()=>{this.ZeroesToAdd=1e7,this.UpdateDisplayValue()})),this.displayElement.style.display=this.displayUnitElement.style.display="inline-block",this.ZeroesToAdd=1e7,this.Setup(e)}get saveValue(){return this.displayUnitElement.saveValue}set saveValue(e){this.displayUnitElement.saveValue=e}#o;get value(){return this.#o}set value(e){if(this.#o===e)return;this.#o=e;const t=this.displayUnit,i=this.valueUnit;let n=(e=>null!=e&&t?Kn(e,i,t):e)(e);if(null==n)return;n=`${parseFloat(parseFloat(parseFloat(n).toFixed(5)).toPrecision(6))}`;const a=n.indexOf(".");let l=Math.max(0,6-(n.length-a));-1===a&&(l=6),l<this.ZeroesToAdd&&(this.ZeroesToAdd=l),l-=this.ZeroesToAdd,l>0&&a<0&&(n+=".");for(let e=0;e<l;e++)n+="0";this.displayElement.textContent=n}}customElements.define("ui-displaynumberwithunit",UIDisplayNumberWithUnit,{extends:"span"});var Qn=0;function ea(){return"GUID"+Qn++}class UIDisplayLiveUpdate extends UIDisplayNumberWithUnit{GUID=ea();get superHidden(){return super.hidden}set superHidden(e){super.hidden=e}get hidden(){return this._stickyHidden}set hidden(e){this._stickyHidden=e,e&&(super.hidden=e)}RegisterVariables(e){let t=VariableRegister.GetVariableByReference(e);t??=e,(t?.unit||-1!==t?.type?.split("|")?.indexOf("float"))&&(this.measurement=Jn(t.unit),this.valueUnit=t.unit,-1===Ti.variablesToPoll.indexOf(e)&&Ti.variablesToPoll.push(e),Ti.liveUpdateEvents[this.GUID]=(t,i)=>{if(e){const n=t?.GetVariableId(e);null!=i?.[n]?(this.superHidden=!1,this.value=i[n],this.superHidden||(this.superHidden&&(this.superHidden=!1),this.TimeoutHandle&&window.clearTimeout(this.TimeoutHandle),this.TimeoutHandle=window.setTimeout((()=>{this.value=void 0,this.superHidden=!0}),5e3))):this.superHidden=!0}})}constructor(e){super(e??{}),this.superHidden=!0,this.displayElement.class="livevalue"}}customElements.define("ui-displayliveupdate",UIDisplayLiveUpdate,{extends:"span"});class UIButton extends HTMLSpanElement{get value(){}set value(e){}get saveValue(){}set saveValue(e){}get label(){return this.textContent}set label(e){this.textContent=e}constructor(e){super(),this.class="ui button",Object.assign(this,e)}}customElements.define("ui-button",UIButton,{extends:"span"});class UIDialog extends HTMLSpanElement{get value(){}set value(e){}get saveValue(){}set saveValue(e){}content=document.createElement("div");#b=new UIButton;#x=document.createElement("dialog");#E=document.createElement("div");#w=document.createElement("div");#_=document.createElement("div");get title(){return this.#w.textContent}set title(e){this.#w.textContent=e}get buttonLabel(){return this.#b.label}set buttonLabel(e){this.#b.label=e}get title(){return this.#w.innerText}set title(e){this.#w.innerText=e}show(){this.#x.style.top||(this.#x.style.top=`${this.#b.getBoundingClientRect().top+window.scrollY}px`),this.#x.show()}close(){this.#x.close()}constructor(e){super(),this.title="Dialog",this.buttonLabel,this.append(this.#b),this.#x.class="ui dialog",document.getElementsByTagName("body")[0].append(this.#x),this.#E.class="titlebar",this.#x.append(this.#E),this.content.class="content",this.#x.append(this.content),this.#w.class="title",this.#E.append(this.#w),this.#_.class="close",this.#E.append(this.#_),Object.assign(this,e),this.#b.addEventListener("click",(()=>{this.show()})),this.#_.addEventListener("click",(()=>{this.close()})),this.#E.addEventListener("mousedown",(e=>{const t=window.getComputedStyle(this.#x);console.log(t.left),this.#x.style.left=t.left,this.#x.style.top=t.top;let i=e.pageX,n=e.pageY,a=parseFloat(this.#x.style.left),l=parseFloat(this.#x.style.top);const s=e=>{let t=e.pageX-i,s=e.pageY-n;this.#x.style.left=`${a+t}px`,this.#x.style.top=`${l+s}px`},r=()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",r)}))}}customElements.define("ui-dialog",UIDialog,{extends:"span"});class UIParameterWithUnit extends UITemplate{static template='<div data-element="parameterSelection"></div><div data-element="unitSelection"></div>';get selectName(){return this.parameterSelection.selectName}set selectName(e){this.parameterSelection.selectName=e}parameterSelection=new UISelection;unitSelection=new UIUnit;constructor(e){super(),this.style.display="inline-flex",this.style.alignItems="center",this.parameterSelection.addEventListener("change",(()=>{const e=this.units;this.unitSelection.measurement=Jn(e),this.unitSelection.hidden=void 0===e||this.unitHidden})),this.Setup(e)}#y=!1;get unitHidden(){return this.#y}set unitHidden(e){this.#y=e,void 0!==this.units?this.unitSelection.hidden=e:this.unitSelection.hidden=!0}get selectHidden(){return this.parameterSelection.selectHidden}set selectHidden(e){this.parameterSelection.selectHidden=e}get selectDisabled(){return this.parameterSelection.selectDisabled}set selectDisabled(e){this.parameterSelection.selectDisabled=e}get selectValue(){return this.parameterSelection.selectValue}set selectValue(e){this.parameterSelection.selectValue=e}get selectedOption(){return"object"==typeof this.parameterSelection.selectedOption&&void 0!==this.optionUnits[this.parameterSelection.selectedOption.name]?{...this.parameterSelection.selectedOption,unit:this.unitSelection.selectedOption}:this.parameterSelection.selectedOption}set selectedOption(e){"object"==typeof e?(void 0!==this.optionUnits[e.name]&&(this.unitSelection.selectedOption=e.unit),delete e.unit,this.parameterSelection.selectedOption=e):this.parameterSelection.selectedOption=e}get value(){return"object"==typeof this.parameterSelection.value&&void 0!==this.optionUnits[this.parameterSelection.value.name]?{...this.parameterSelection.value,unit:this.unit}:this.parameterSelection.value}set value(e){"object"==typeof e?(e={...e},void 0!==this.optionUnits[e.name]&&(this.unitSelection.value=e.unit),delete e.unit,this.parameterSelection.value=e):this.parameterSelection.value=e}get saveValue(){return"object"==typeof this.parameterSelection.saveValue&&void 0!==this.optionUnits[this.parameterSelection.saveValue.name]?{...this.parameterSelection.saveValue,unit:this.unit}:this.parameterSelection.saveValue}set saveValue(e){"object"==typeof e?(e={...e},void 0!==this.optionUnits[e.name]&&(this.unitSelection.saveValue=e.unit),delete e.unit,this.parameterSelection.saveValue=e):this.parameterSelection.saveValue=e}get units(){return null!=this.parameterSelection.value?.name?this.optionUnits[this.parameterSelection.value.name]:void 0}get unit(){return this.units?.find((e=>Jn(e)===Jn(this.unitSelection.value)))}get displayUnit(){return this.unitSelection.value}set displayUnit(e){this.unitSelection.value=e}optionUnits={};get options(){const e=t=>{let i=[];for(const n in t){let a={...t[n]};if(a.group)a.options=e(a.options),i.push(a);else if("object"==typeof a.value&&void 0!==this.optionUnits[a.value.name])for(const e in this.optionUnits[a.value.name]){a={...t[n]},a.value={...a.value};const l=this.optionUnits[a.value.name][e];a.value.unit=l,a.info=`[${Jn(l)}]`,i.push(a)}else i.push(a)}return i};return e(this.parameterSelection.options)}set options(e){const t=e=>{let i=[];for(const n in e){let a=e[n];if(a.group)i.push({...a,options:t(a.options)});else if("object"==typeof a.value&&void 0!==a.value.unit){this.optionUnits[a.value.name]??=[],a.disabled||this.optionUnits[a.value.name].push(a.value.unit);const e=i.filter((e=>e?.value?.name===a.value.name));e.length<1?i.push({...a,value:{...a.value,unit:void 0},info:void 0}):e[0].disabled&=a.disabled}else i.push(a)}return i};this.optionUnits={},this.parameterSelection.options=t(e);const i=this.units;this.unitSelection.measurement=Jn(i),this.unitSelection.hidden=void 0===i||this.unitHidden}}customElements.define("ui-parameterwithunit",UIParameterWithUnit,{extends:"span"});class UITextArea extends HTMLTextAreaElement{#o="";get value(){return this.#o}set value(e){this.#o!==e&&(super.value=this.#o=e,super.dispatchEvent(new Event("change",{bubbles:!0})))}get saveValue(){return this.value}set saveValue(e){this.value=e}constructor(e){super(),this.class="ui text",this.addEventListener("change",(()=>{this.#o=super.value})),Object.assign(this,e)}}customElements.define("ui-textarea",UITextArea,{extends:"textarea"});class UIText extends HTMLInputElement{#o="";get value(){return this.#o}set value(e){this.#o!==e&&(super.value=this.#o=e,super.dispatchEvent(new Event("change",{bubbles:!0})))}get saveValue(){return this.value}set saveValue(e){this.value=e}constructor(e){super(),this.class="ui text",this.addEventListener("change",(()=>{this.#o=super.value})),Object.assign(this,e)}}customElements.define("ui-text",UIText,{extends:"input"});class CalculationOrVariableSelection_CalculationOrVariableSelection extends UITemplate{static template='<label><span data-element="labelElement"></span>:</label><div data-element="selection"></div><div data-element="liveUpdate"></div><span data-element="calculationContent"></span>';calculationContent=document.createElement("span");calculationValues=[];calculationSaveValueCache=[];get required(){return this.selection.selectDisabled}set required(e){this.selection.selectHidden=this.selection.selectDisabled=e}get selectName(){return this.selection.selectName}set selectName(e){this.selection.selectName=e}labelElement=document.createElement("span");get label(){return this.labelElement.textContent}set label(e){this.label!==e&&(this.labelElement.textContent=e,Object.keys(this.calculationValues).map((e=>this.calculationValues[e])).forEach((t=>{t.label=e})))}_xLabel="X";get xLabel(){return this._xLabel}set xLabel(e){this._xLabel!==e&&(this._xLabel=e,Object.keys(this.calculationValues).map((e=>this.calculationValues[e])).forEach((t=>{t.xLabel=e})))}_yLabel="Y";get yLabel(){return this._yLabel}set yLabel(e){this._yLabel!==e&&(this._yLabel=e,Object.keys(this.calculationValues).map((e=>this.calculationValues[e])).forEach((t=>{t.yLabel=e})))}selectionFilter=Ii;get outputTypes(){return this._outputUnits?void 0:this._outputTypes??this.GetSubConfigProperty("outputTypes")??(void 0!==this.selection.value?.unit||null==this.selection.value?.type?void 0:[this.selection.value?.type])}set outputTypes(e){this._outputTypes=e,Object.keys(this.calculationValues).map((e=>this.calculationValues[e])).forEach((t=>{"outputTypes"in t&&(t.outputTypes=e)})),this.options=VariableRegister.GetSelections(this.calculations,this.selectionFilter(this._outputUnits,this._outputTypes,this._inputTypes,this._inputUnits))}get outputUnits(){return this._outputUnits??this.GetSubConfigProperty("outputUnits")??(null!=this.selection.displayUnit?[this.selection.displayUnit]:void 0)}set outputUnits(e){this._outputUnits=e,Object.keys(this.calculationValues).map((e=>this.calculationValues[e])).forEach((t=>{"outputUnits"in t&&(t.outputUnits=e)})),this.options=VariableRegister.GetSelections(this.calculations,this.selectionFilter(this._outputUnits,this._outputTypes,this._inputTypes,this._inputUnits))}get inputTypes(){return this._inputUnits?void 0:this._inputTypes??this.GetSubConfigProperty("inputTypes")}set inputTypes(e){this._inputTypes=e,Object.keys(this.calculationValues).map((e=>this.calculationValues[e])).forEach((t=>{"inputTypes"in t&&(t.inputTypes=e)})),this.options=VariableRegister.GetSelections(this.calculations,this.selectionFilter(this._outputUnits,this._outputTypes,this._inputTypes,this._inputUnits))}get inputUnits(){return this._inputUnits??this.GetSubConfigProperty("inputUnits")}set inputUnits(e){this._inputUnits=e,Object.keys(this.calculationValues).map((e=>this.calculationValues[e])).forEach((t=>{"inputUnits"in t&&(t.inputUnits=e)})),this.options=VariableRegister.GetSelections(this.calculations,this.selectionFilter(this._outputUnits,this._outputTypes,this._inputTypes,this._inputUnits))}get options(){return this.selection.options}set options(e){this.selection.options=e,void 0===this.selection.selectedOption&&(this.selection.value=this.selection.selectValue)}selection=new UIParameterWithUnit({selectDisabled:!1,selectName:"None"});constructor(e){super(),e??={},this.liveUpdate=new UIDisplayLiveUpdate({valueUnit:e.outputUnits?.[0],displayUnit:e.displayUnits?.[0]}),this.liveUpdate.style.float="right",this.selection.addEventListener("change",(()=>{this.calculationContent.replaceChildren(this.SubConfig??""),this.liveUpdate.measurement=Jn(this.outputUnits?.[0]),null==this._outputUnits?.[0]?this.selection.unitHidden=!1:this.selection.unitHidden=!0})),this.style.display="block",this.Setup(e)}Setup(...e){super.Setup(...e),this.options=VariableRegister.GetSelections(this.calculations,this.selectionFilter(this._outputUnits,this._outputTypes,this._inputTypes,this._inputUnits))}static SaveOnlyActive=!1;get saveValue(){let e=super.saveValue??{};if(e.calculationValues={},CalculationOrVariableSelection_CalculationOrVariableSelection.SaveOnlyActive){let t=subConfig?.saveValue;null!=t&&(e.calculationValues[this.selection.value]=t)}else{for(const t in this.calculationValues)e.calculationValues[t]=this.calculationValues[t].saveValue;for(const t in this.calculationSaveValueCache)e.calculationValues[t]=this.calculationSaveValueCache[t]}return Object.keys(e.calculationValues).length<1&&delete e.calculationValues,"string"!=typeof this.selection.value&&(e.displayUnit=this.selection.displayUnit),e}set saveValue(e){if(e??={},Array.isArray(e.calculationValues))for(const t in e.calculationValues){const i=e.calculationValues[t]?.className;null!=i&&(this.calculationValues[i]?this.calculationValues[i].saveValue=e.calculationValues[t]:this.calculationSaveValueCache[i]=e.calculationValues[t])}else if(e.calculationValues)for(const t in e.calculationValues)this.calculationValues[t]?this.calculationValues[t].saveValue=e.calculationValues[t]:this.calculationSaveValueCache[t]=e.calculationValues[t];super.saveValue=e,this.selection.displayUnit=e.displayUnit}get value(){const e=this.SubConfig;return{...super.value,...void 0!==this.outputTypes&&this.outputTypes?.length>0&&{outputTypes:this.outputTypes},...void 0!==this.outputUnits&&this.outputUnits?.length>0&&{outputUnits:this.outputUnits},...void 0!==this.inputTypes&&this.inputTypes?.length>0&&{inputTypes:this.inputTypes},...void 0!==this.inputUnits&&this.inputUnits?.length>0&&{inputUnits:this.inputUnits},...null!=e&&{calculation:e.value}}}set value(e){this.selection.value=e?.selection;const t=this.SubConfig;t&&(t.value=e?.calculation),this.selection.displayUnit=e?.outputUnits?.[0]}RegisterVariables(e){if(e={...e},this.options=VariableRegister.GetSelections(this.calculations,this.selectionFilter(this._outputUnits,this._outputTypes,this._inputTypes,this._inputUnits)),!this.selection.value||!e)return;e.unit=this.outputUnits?.[0]??e.unit,e.unit?delete e.type:(delete e.unit,e.type=this.outputTypes?.[0]??e.type);const t=this.SubConfig;if(null!=t){const i=this.GetSubConfigProperty("outputUnits")??this.GetSubConfigProperty("outputTypes");void 0!==i&&i.length>0&&VariableRegister.RegisterVariable(e),t.RegisterVariables?.(e)}else e={...this.selection.value,name:e.name,id:this.selection.value.name},VariableRegister.RegisterVariable(e);this.liveUpdate.RegisterVariables(e)}get SubConfig(){if("string"!=typeof this.selection.value||!this.calculations)return;if(this.calculationValues[this.selection.value])return this.calculationValues[this.selection.value];let e=this.calculations;this.calculations[0]?.group||this.calculations[0]?.calculations||(e=[{group:"Calculations",calculations:this.calculations}]);for(const t in e){const i=e[t].calculations;for(const e in i)if(null!=i[e]&&i[e].name===this.selection.value)return this.calculationValues[this.selection.value]=new i[e],this.calculationValues[this.selection.value].Setup({noParameterSelection:this.noParameterSelection,label:this.label,xLabel:this.xLabel,yLabel:this.yLabel,...this._outputUnits&&{outputUnits:this._outputUnits},displayUnits:this.displayUnits,calculations:this.calculations}),null!=this.calculationSaveValueCache[this.selection.value]&&(this.calculationValues[this.selection.value].saveValue=this.calculationSaveValueCache[this.selection.value]),delete this.calculationSaveValueCache[this.selection.value],this.calculationValues[this.selection.value]}}GetSubConfigProperty(e){const t=this.SubConfig;return t?.[e]??t?.constructor?.[e]}}customElements.define("calculation-orvariableselection",CalculationOrVariableSelection_CalculationOrVariableSelection,{extends:"span"});const ta=[];const ia=[];class Calculation_Static extends UITemplate{static displayName="Static";static outputTypes=["float"];static template='<div data-element="numberElement"></div>';constructor(e){super(),this.numberElement=new UINumberWithUnit({valueUnit:e?.outputUnits?.[0],displayUnit:e?.displayUnits?.[0]}),this.Setup(e)}set class(e){this.numberElement.class=e}get min(){return this.numberElement.min}set min(e){this.numberElement.min=e}get max(){return this.numberElement.max}set max(e){this.numberElement.max=e}get step(){return this.numberElement.step}set step(e){this.numberElement.step=e}get displayUnit(){return this.numberElement.displayUnit}set displayUnit(e){this.numberElement.displayUnit=e}get displayValue(){return this.numberElement.displayValue}set displayValue(e){this.numberElement.displayValue=e}get measurement(){return this.numberElement.measurement}set measurement(e){this.numberElement.measurement=e}get valueUnit(){return this.numberElement.valueUnit}set valueUnit(e){this.numberElement.valueUnit=e}get value(){return this.numberElement.value}set value(e){this.numberElement.value=e}get saveValue(){return this.numberElement.saveValue}set saveValue(e){this.numberElement.saveValue=e}get outputUnits(){return[this.valueUnit]}set outputUnits(e){this.valueUnit=e?.[0],null!=e?.[0]&&(this.measurement=Jn(e?.[0]))}get displayUnits(){return[this.displayUnit]}set displayUnits(e){this.displayUnit=e?.[0]}}ia.push(Calculation_Static),customElements.define("calculation-static",Calculation_Static,{extends:"span"});class UITableBase extends HTMLDivElement{get value(){return[...this._valueElement.children].map((e=>e.value))}set value(e){if(null==e)return;if(e.length!==this.xResolution*this.yResolution)return;let t=!0;const i=this.value;for(let n=0;n<i.length;n++)if(!(i[n]===e[n]||isNaN(i[n])&&isNaN(e[n]))){t=!1;break}if(!t){for(let t=0;t<this._valueElement.children.length;t++)this._valueElement.children[t].value=e[t];this.dispatchEvent(new Event("change",{bubbles:!0}))}}get saveValue(){return{value:this.value,xAxis:this.xAxis,yAxis:this.yAxis}}set saveValue(e){if(null==e)return;e.value??=e.Value,e.xAxis??=e.XAxis,e.xResolution??=e.XResolution,e.yAxis??=e.YAxis,e.yResolution??=e.YResolution;const t=e.xResolution??e.Resolution,i=e.MaxX??e.Max,n=e.MinX??e.Min;if(t&&null!=i&&null!=n&&null!==i&&null!==n){e.xAxis=new Array(t);const a=(i-n)/(t-1);for(let i=0;i<t;i++)e.xAxis[i]=n+a*i}if(e.yResolution&&null!=e.MaxY&&null!=e.MinY&&null!==e.MaxY&&null!==e.MinY){e.yAxis=new Array(e.yResolution);const t=(e.MaxY-e.MinY)/(e.yResolution-1);for(let i=0;i<e.yResolution;i++)e.yAxis[i]=e.MinY+t*i}null!=e.xAxis&&(this.xAxis=e.xAxis),null!=e.yAxis&&(this.yAxis=e.yAxis),null!=e.value&&Array.isArray(e.value)&&(this.value=e.value)}get xResolution(){return Math.max(1,this._xAxisElement.children.length)}set xResolution(e){if(isNaN(e)||e===this._xAxisElement.children.length)return;const t=this.value;let i=new Array(e*this.yResolution);for(let n=0;n<e;n++)for(let a=0;a<this.yResolution;a++){let l=n+this.xResolution*a,s=n+e*a;if(n>=this.xResolution){let t=n-1+e*a,l=n-2+e*a;n>1&&(i[s]=i[t]+(i[t]-i[l]))}else i[s]=t[l];isNaN(i[s])&&(i[s]=0)}this._xResolutionElement&&(this._xResolutionElement.value=e),this._resolutionChanged(this._xAxisElement,e),this.value=i,this.dispatchEvent(new Event("change",{bubbles:!0}))}get xAxis(){return[...this._xAxisElement.children].map((e=>e.value))}set xAxis(e){jn(this.xAxis,e)||(this.xResolution=e.length,e.forEach(((e,t)=>{this._xAxisElement.children[t].value=e})),this.dispatchEvent(new Event("change",{bubbles:!0})))}get yResolution(){return Math.max(1,this._yAxisElement.children.length)}set yResolution(e){if(isNaN(e)||e===this._yAxisElement.children.length)return;const t=this.value;let i=new Array(this.xResolution*e);for(let n=0;n<this.xResolution;n++)for(let a=0;a<e;a++){let e=n+this.xResolution*a;if(a>=this.yResolution){let t=n+this.xResolution*(a-1),l=n+this.xResolution*(a-2);a>1&&(i[e]=i[t]+(i[t]-i[l]))}else i[e]=t[e];isNaN(i[e])&&(i[e]=0)}this._yResolutionElement&&(this._yResolutionElement.value=e),this._resolutionChanged(this._yAxisElement,e),this.value=i,this.dispatchEvent(new Event("change",{bubbles:!0}))}get yAxis(){return[...this._yAxisElement.children].map((e=>e.value))}set yAxis(e){jn(this.yAxis,e)||(this.yResolution=e.length,e.forEach(((e,t)=>{this._yAxisElement.children[t].value=e})),this.dispatchEvent(new Event("change",{bubbles:!0})))}#U;get selecting(){return this.#U}set selecting(e){if(this.#U=e,this._valueElement.querySelectorAll(".selected").forEach((e=>{e.classList.remove("selected")})),this._xAxisElement.querySelectorAll(".selected").forEach((e=>{e.classList.remove("selected")})),this._yAxisElement.querySelectorAll(".selected").forEach((e=>{e.classList.remove("selected")})),e){let t=this._valueElement.children;isNaN(e.startX)&&(t=this._yAxisElement.children),isNaN(e.startY)&&(t=this._xAxisElement.children);for(let i=0;i<t.length;i++){let n=t[i];Math.min(e.endX,e.startX)>parseInt(n.x)||Math.max(e.endX,e.startX)<parseInt(n.x)||Math.min(e.endY,e.startY)>parseInt(n.y)||Math.max(e.endY,e.startY)<parseInt(n.y)||n.classList.add("selected")}}this.dispatchEvent(new Event("select"))}#V;get _valueMin(){return isNaN(this.#V)?18e18:this.#V}set _valueMin(e){e=parseFloat(e),this.#V!==e&&(this.#V=e,this.style.setProperty("--valuemin",e))}#A;get _valueMax(){return this.#A-this.#V==0?1:isNaN(this.#A)?-9e18:this.#A}set _valueMax(e){e=parseFloat(e),this.#A!==e&&(this.#A=e,this.style.setProperty("--valuemax",e))}_boundAxis(e){if(e!==this._xAxisElement&&e!==this._yAxisElement)return;let t,i;e===this._xAxisElement?(t=Math.max(this.selecting.endX,this.selecting.startX),i=Math.max(this.selecting.endX,this.selecting.startX)):(t=Math.max(this.selecting.endY,this.selecting.startY),i=Math.max(this.selecting.endY,this.selecting.startY));let n=e.children[i].value;for(let t=i+1;t<e.children.length;t++)e.children[t].value<n&&(e.children[t].value=n),n=e.children[t].value;n=e.children[t].value;for(let i=t-1;i>=0;i--)e.children[i].value>n&&(e.children[i].value=n),n=e.children[i].value}attachToTable(e){e.addEventListener("change",(()=>{this.xAxis=e.xAxis,this.yAxis=e.yAxis,this.value=e.value})),e.addEventListener("select",(()=>{this.selecting=e.selecting}))}}class UIGraph2D extends UITableBase{get xAxis(){return super.xAxis}set xAxis(e){super.xAxis=e,this._valueElement.update(),this.#I.update(),this._xAxisElement.update(),this._yAxisElement.update()}get yAxis(){return super.yAxis}set yAxis(e){super.yAxis=e,this._valueElement.update(),this.#I.update(),this._xAxisElement.update(),this._yAxisElement.update()}get axis(){return this.xResolution<2?this.yAxis:this.xAxis}set axis(e){this.xResolution<2?this.yAxis=e:this.xAxis=e}get selecting(){return super.selecting}set selecting(e){if(!jn(this.selecting,e)){if(this.#I.querySelectorAll(".selected").forEach((e=>{e.classList.remove("selected")})),e&&null!=e.startX&&null!=e.endX&&null!=e.startY&&null!=e.endY)for(let t=0;t<this.#I.children.length;t++){let i=this.#I.children[t];Math.min(e.endX,e.startX)>parseInt(i.x1)||Math.max(e.endX,e.startX)<parseInt(i.x2)||Math.min(e.endY,e.startY)>parseInt(i.y1)||Math.max(e.endY,e.startY)<parseInt(i.y3)||i.classList.add("selected")}super.selecting=e}}get width(){return this.#S.getAttribute("width")??this.offsetWidth??300}set width(e){this.#S.setAttribute("width",e);const t=e/(7.5*Math.max(this.xResolution,this.yResolution)),i=t/2;this.#T=5*t,this.#C=i+t,this.#k=i,this.#P=i,[...this._valueElement.children].forEach((e=>{e.textSize=t,e.setAttribute("r",i.toFixed(10)),e.update()})),[...this._xAxisElement.children].forEach((e=>{e.textSize=t,e.r=i,e.update()})),[...this._yAxisElement.children].forEach((e=>{e.textSize=t,e.r=i,e.update()})),[...this.#L.children].forEach((e=>{e.textSize=t,e.r=i,e.update()}))}get height(){return this.#S.getAttribute("height")??this.offsetHeight??150}set height(e){this.#S.setAttribute("height",e),[...this._valueElement.children].forEach((e=>{e.update()})),[...this._xAxisElement.children].forEach((e=>{e.update()})),[...this._yAxisElement.children].forEach((e=>{e.update()})),[...this.#L.children].forEach((e=>{e.update()}))}#L=document.createElementNS("http://www.w3.org/2000/svg","g");_xAxisElement=document.createElementNS("http://www.w3.org/2000/svg","g");_yAxisElement=document.createElementNS("http://www.w3.org/2000/svg","g");_valueElement=document.createElementNS("http://www.w3.org/2000/svg","g");#I=document.createElementNS("http://www.w3.org/2000/svg","g");#S=document.createElementNS("http://www.w3.org/2000/svg","svg");trail(e,t=0,i){}get _valueMin(){return super._valueMin}set _valueMin(e){super._valueMin=e,this._valueElement.update(),this.#I.update(),this.#L.update()}get _valueMax(){return super._valueMax}set _valueMax(e){super._valueMax=e,this._valueElement.update(),this.#I.update(),this.#L.update()}constructor(e){function t(){[...this.children].forEach((e=>{e.update()}))}super(),this.class="ui graph2d",this.append(this.#S),this.#S.setAttribute("overflow","visible"),this.#S.append(this._xAxisElement),this.#S.append(this._yAxisElement),this.#S.append(this.#L),this.#S.append(this.#I),this.#S.append(this._valueElement),this._xAxisElement.update=t,this._yAxisElement.update=t,this.#L.update=t,this._valueElement.update=t,this.#I.update=t;const i=e.value;delete e.value,Object.assign(this,e),this.#M(),this.value=i}#T=75;#C=25;#P=25;#k=25;#O(e,t,i){if(isNaN(i))return;const n=this.axis,a=this.xResolution<2?t:e,l=n[n.length-1],s=n[0];let r=this.#T+(this.width-this.#T-this.#P)*(n[a]-s)/(l-s);isNaN(r)&&(r=0);let o=this.height-(this.#C+(this.height-this.#C-this.#k)*(i-this._valueMin)/(this._valueMax-this._valueMin));return isNaN(o)&&(o=0),[r,o]}#R(e,t){const i=null==e?this.yAxis:this.xAxis,n=null==e?t:e,a=i[i.length-1],l=i[0];let s=this.#T+(this.width-this.#T-this.#P)*(i[n]-l)/(a-l);isNaN(s)&&(s=0);return[[s,this.height-this.#C],[s,this.#k]]}#N(e){const t=this.#T,i=this.width-this.#P,n=this.height-(this.#C+(this.height-this.#C-this.#k)*(e-this._valueMin)/(this._valueMax-this._valueMin));return[[t,n],[i,n]]}_resolutionChanged(e,t){const i=this,n=this.width/(7.5*Math.max(this.xResolution,this.yResolution,t)),a=n/2;for(this.#T=5*n,this.#C=a+n,this.#k=a,this.#P=a;t<e.children.length;)e.removeChild(e.lastChild);for(let n=e.children.length;n<t;n++){const t=e.appendChild(document.createElementNS("http://www.w3.org/2000/svg","g"));t.append(document.createElementNS("http://www.w3.org/2000/svg","line"));t.appendChild(document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("alignment-baseline","hanging"),t.update=function(){const e=i.#R(this.x,this.y);this.children[0].setAttribute("x1",e[0][0]),this.children[0].setAttribute("y1",e[0][1]),this.children[0].setAttribute("x2",e[1][0]),this.children[0].setAttribute("y2",e[1][1]),this.children[1].setAttribute("x",e[0][0]),this.children[1].setAttribute("y",e[0][1]+this.r),this.children[1].setAttribute("font-size",this.textSize.toFixed(10)),this.children[1].textContent=zn(this.value)};const a=e.children[n-1]?.value,l=e.children[n-2]?.value;let s=0;null!=a&&null!=l&&(s=a+(a-l)),t.value=s,e===this._xAxisElement?t.x=n:t.y=n}for(let e=0;e<this._xAxisElement.children.length;e++){const t=this._xAxisElement.children[e];t.textSize=n,t.children[1]?.setAttribute("text-anchor","middle"),t.r=a}for(let e=0;e<this._yAxisElement.children.length;e++){const t=this._yAxisElement.children[e];t.textSize=n,t.children[1]?.setAttribute("text-anchor","middle"),t.r=a}this._xAxisElement.lastChild?.children[1]?.setAttribute("text-anchor","end"),this._yAxisElement.lastChild?.children[1]?.setAttribute("text-anchor","end"),this._xAxisElement.firstChild?.children[1]?.setAttribute("text-anchor","start"),this._yAxisElement.firstChild?.children[1]?.setAttribute("text-anchor","start"),this.xResolution<2?(this._xAxisElement.hidden=!0,this._yAxisElement.hidden=!1):(this._yAxisElement.hidden=!0,this._xAxisElement.hidden=!1);const l=parseInt(1.5+Math.max(this.xResolution,this.yResolution));for(;l<this.#L.children.length;)this.#L.removeChild(this.#L.lastChild);for(let e=0;e<l;e++){let t=this.#L.children[e];if(!t){t=this.#L.appendChild(document.createElementNS("http://www.w3.org/2000/svg","g")),t.append(document.createElementNS("http://www.w3.org/2000/svg","line"));t.appendChild(document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("text-anchor","end"),t.update=function(){let e=(i._valueMax-i._valueMin)/(this.zResolution-1)*this.z+i._valueMin;this.z===this.zResolution-1&&(e=i._valueMax);let t=i.#N(e);this.children[0].setAttribute("x1",t[0][0]),this.children[0].setAttribute("y1",t[0][1]),this.children[0].setAttribute("x2",t[1][0]),this.children[0].setAttribute("y2",t[1][1]),this.children[1].setAttribute("x",t[0][0]-this.r),this.children[1].setAttribute("y",t[0][1]),this.children[1].setAttribute("font-size",this.textSize.toFixed(10)),this.children[1].textContent=zn(e)}}0===e?t.children[1].setAttribute("alignment-baseline","normal"):e===l-1?t.children[1].setAttribute("alignment-baseline","hanging"):t.children[1].setAttribute("alignment-baseline","middle"),t.textSize=n,t.zResolution=l,t.r=a,t.z=e}function s(e){let t=`v${e}`;return{get:function(){return parseFloat(this.dataset[t])},set:function(e){e=parseFloat(e),this[t]!==e&&(this.dataset[t]=e,this.value=(parseFloat(this.v1)+parseFloat(this.v2))/2)}}}for(this.style.setProperty("--xresolution",this.xResolution),this.style.setProperty("--yresolution",this.yResolution);Math.max(0,(this.xResolution-1)*this.yResolution)<this.#I.children.length;)this.#I.removeChild(this.#I.lastChild);for(let e=0;e<(this.xResolution-1)*this.yResolution;e++){let t=this.#I.children[e];t||(t=this.#I.appendChild(document.createElementNS("http://www.w3.org/2000/svg","line")),Object.defineProperty(t,"value",{get:function(){return this._value},set:function(e){e=parseFloat(e),this._value!==e&&(this._value=e,this.style.setProperty("--data-value",e))}}),t.update=function(){this.p1&&this.p2&&(this.setAttribute("x1",this.p1[0]),this.setAttribute("y1",this.p1[1]),this.setAttribute("x2",this.p2[0]),this.setAttribute("y2",this.p2[1]))},Object.defineProperty(t,"v1",s(1)),Object.defineProperty(t,"v2",s(2))),t.xp1=t.xp2=e%(this.xResolution-1),t.xp1+1<this.xResolution&&t.xp2++,t.yp1=t.yp2=Math.trunc(e/(this.xResolution-1))}const r=[...this.#I.children];for(;this.xResolution*this.yResolution<this._valueElement.children.length;)this._valueElement.removeChild(this._valueElement.lastChild);for(let e=0;e<this.xResolution*this.yResolution;e++){let t=this._valueElement.children[e];t||(t=this._valueElement.appendChild(document.createElementNS("http://www.w3.org/2000/svg","circle")),Object.defineProperty(t,"value",{get:function(){return this._value},set:function(e){e=parseFloat(e),this._value!==e&&(this._value=e,e<i._valueMin&&(i._valueMin=e),e>i._valueMax&&(i._valueMax=e),this.style.setProperty("--data-value",e),this.update(),this.vl1&&(this.vl1.v1=e),this.vl2&&(this.vl2.v2=e))}}),Object.defineProperty(t,"p",{get:function(){return this.dataset.p?JSON.parse(this.dataset.p):void 0},set:function(e){if(!e)return;const t=JSON.stringify(e);t!==this.dataset.p&&(this.dataset.p=t,e[0]=e[0].toFixed(10),e[1]=e[1].toFixed(10),this.vl1&&(this.vl1.p1=e,this.vl1.v1=this.value),this.vl2&&(this.vl2.p2=e,this.vl2.v2=this.value))}}),t.update=function(){if(!(this.p=i.#O(this.x,this.y,this.value)))return;const e=this.p;this.setAttribute("cx",e[0]),this.setAttribute("cy",e[1])}),t.x=e%this.xResolution,t.y=Math.trunc(e/this.xResolution),t.vl1=r.find((e=>e.xp1===t.x&&e.yp1===t.y)),t.vl2=r.find((e=>e.xp2===t.x&&e.yp2===t.y)),t.setAttribute("r",a.toFixed(10))}}#M(){const e=()=>{const e=Bn(this.value);this._valueMin=e[0],this._valueMax=e[1]};this.addEventListener("change",e),e(),this.#S.addEventListener("mousedown",(e=>{var t=this.#S.getBoundingClientRect(),i=e.pageX-t.left,n=e.pageY-t.top;let a,l;if([...this._valueElement.children].sort(((e,t)=>e.depth-t.depth)).forEach(((e,t)=>{let l=e.p[0]-i,s=e.p[1]-n;e.dist=Math.sqrt(l*l+s*s),(null==a||e.dist<a.dist)&&(a=e)})),a&&0===e.button){const t=a.x,i=a.y;this.selecting={startX:t,startY:i,endX:t,endY:i};const n=this.axis,s=this.xResolution<2?this._yAxisElement.children[a.y]:this._xAxisElement.children[a.x];l={pageX:e.pageX,pageY:e.pageY,closestCircle:a,value:a.value,mag:(this._valueMax-this._valueMin)/(this.height-this.#k-this.#C),axisElement:s,axisValue:s.value,axisMag:(n[n.length-1]-n[0])/(this.width-this.#T-this.#P)}}if(l){const e=e=>{l.closestCircle.value=l.value+(l.pageY-e.pageY)*l.mag,l.axisElement.value=l.axisValue+(e.pageX-l.pageX)*l.axisMag,this._boundAxis(l.axisElement.parentElement),this.dispatchEvent(new Event("change",{bubbles:!0}))},t=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",t)}}))}}customElements.define("ui-graph-2d",UIGraph2D,{extends:"div"});class UITable extends UITableBase{get selecting(){return super.selecting}set selecting(e){if(jn(this.selecting,e))return;this.#D.querySelectorAll("input")?.forEach((e=>{e.parentElement.textContent=zn(e.parentElement.value)}));let t=[...this._valueElement.children].find((t=>t.x===e.startX&&t.y===e.startY));isNaN(e.startX)&&(t=[...this._yAxisElement.children].find((t=>t.y===e.startY))),isNaN(e.startY)&&(t=[...this._xAxisElement.children].find((t=>t.x===e.startX))),t&&this.#F.parentElement!==t&&(this.#F.value=t.value,t.replaceChildren(this.#F)),super.selecting=e}get xResolutionModifiable(){return!this.#z.hidden}set xResolutionModifiable(e){this.#z.hidden=!e,this._xResolutionElement.hidden=!e,this.yResolutionModifiable&&e?this.#B.hidden=!1:this.#B.hidden=!0,this.yResolutionModifiable||e?(this.#j.hidden=!1,this.#W.hidden=!1):(this.#j.hidden=!0,this.#W.hidden=!0)}get yResolutionModifiable(){return!this.#Y.hidden}set yResolutionModifiable(e){this.#Y.hidden=!e,this._yResolutionElement.hidden=!e,this.xResolutionModifiable&&e?this.#B.hidden=!1:this.#B.hidden=!0,this.xResolutionModifiable||e?(this.#j.hidden=!1,this.#W.hidden=!1):(this.#j.hidden=!0,this.#W.hidden=!0)}get xLabel(){return this.#G}set xLabel(e){this.#G!==e&&(this.#G=e,this.#X.replaceChildren(e??""))}get yLabel(){return this.#H}set yLabel(e){this.#H!==e&&(this.#H=e,this.#$.replaceChildren(e??""))}get zLabel(){return this.#q}set zLabel(e){this.#q!==e&&(this.#q=e,this.#Z.replaceChildren(e??""))}get step(){return this.#F.step}set step(e){this.#F.step=e}get min(){return this.#F.min}set min(e){this.#F.min=e}get max(){return this.#F.max}set max(e){this.#F.max=e}trailTime=2e3;#J=document.createElement("div");#K=document.createElement("div");#Q=document.createElement("div");#ee=document.createElement("div");#te=document.createElement("div");#ie=document.createElement("div");#ne=document.createElement("div");#ae=document.createElement("input");#le=document.createElement("div");#se=document.createElement("div");#re=document.createElement("div");#oe=document.createElement("div");#W=document.createElement("div");_xResolutionElement=document.createElement("input");_yResolutionElement=document.createElement("input");#B=document.createElement("span");#ue=document.createElement("div");#he=document.createElement("div");#de=document.createElement("div");#ce=document.createElement("div");#pe=document.createElement("div");#me=document.createElement("div");#fe=document.createElement("div");#ve=document.createElement("div");#ge=document.createElement("div");#ye=document.createElement("div");#be=document.createElementNS("http://www.w3.org/2000/svg","svg");#D=document.createElement("table");#X=document.createElement("div");#G=void 0;#$=document.createElement("div");#H=void 0;#Z=document.createElement("div");#q=void 0;#j=document.createElement("td");#z=document.createElement("td");#Y=document.createElement("td");_xAxisElement=document.createElement("div");_yAxisElement=document.createElement("div");_valueElement=document.createElement("div");#F=document.createElement("input");constructor(e){if(super(),this.class="ui",this.append(this.#ve),this.#ve.class="toolbar",this.#ve.append(this.#ye),this.#ye.class="lefttoolbar",this.#ve.append(this.#ge),this.#ge.class="righttoolbar",this.#ye.append(this.#W),this.#W.class="resolution container",this.#W.append(this._xResolutionElement),this.#W.append(this.#B),this.#W.append(this._yResolutionElement),this._xResolutionElement.type="number",this._xResolutionElement.class="resolution-value",this._yResolutionElement.type="number",this._yResolutionElement.class="resolution-value",this.#B.textContent="X",this.#ye.append(this.#ue),this.#ue.class="paste container",this.#ue.append(this.#he),this.#ue.append(this.#de),this.#ue.append(this.#ce),this.#ue.append(this.#pe),this.#ue.append(this.#me),this.#ue.append(this.#fe),this.#he.class="paste-button equal selected",this.#he.value="equal",this.#de.class="paste-button add",this.#de.value="add",this.#ce.class="paste-button subtract",this.#ce.value="subtract",this.#pe.class="paste-button multiply",this.#pe.value="multiply",this.#me.class="paste-button multiplyp",this.#me.value="multiply%",this.#fe.class="paste-button multiplyp2",this.#fe.value="multiply%/2",this.#fe.innerHTML="<span><sup>%</sup>&frasl;<sub>2</sub></span>",this.#ge.append(this.#J),this.#J.class="modify container",this.#J.append(this.#ae),this.#J.append(this.#K),this.#J.append(this.#Q),this.#J.append(this.#ee),this.#J.append(this.#te),this.#J.append(this.#ie),this.#J.append(this.#ne),this.#ae.type="number",this.#ae.class="modify-value",this.#K.class="modify-button add",this.#Q.class="modify-button subtract",this.#ee.class="modify-button multiply",this.#te.class="modify-button divide",this.#ie.class="modify-button percent",this.#ne.class="modify-button equal",this.#Q.hidden=!0,this.#te.hidden=!0,this.#ie.hidden=!0,this.#ge.append(this.#le),this.#le.class="interpolate container",this.#le.append(this.#se),this.#le.append(this.#re),this.#le.append(this.#oe),this.#se.class="modify-button interpolatex",this.#re.class="modify-button interpolatey",this.#oe.class="modify-button interpolatexy",this.#be.style='position:absolute; pointer-events: none;" z-index="100',this.#be.setAttribute("overflow","visible"),this.#be.setAttribute("width",100),this.#be.setAttribute("height",60),this.#be.classList.add("trail"),this.append(this.#D),this.#D.class="numerictable",this.#X.class="xLabel",this.#$.class="yLabel",this.#Z.class="zLabel",this._xAxisElement.class="xAxis",this._yAxisElement.class="yAxis",this._valueElement.class="value",this.#F.type="number",this.#z.class="xdrag",this.#z.rowSpan=2,this.#Y.class="ydrag",this.#Y.colSpan=2,this.#j.class="xydrag",e){const t=e.value;delete e.value,Object.assign(this,e),this.value=t}this.#xe(),this.#Ee(),this.#we(),this.#_e()}static#Ue={get:function(){return this._value},set:function(e){if(e=parseFloat(e),this._value===e)return;this._value=e,this.style.setProperty("--data-value",e);const t=this.children[0];"INPUT"===t?.tagName?t.value=e:this.textContent=zn(e)}};trail(e,t=0,i){const n=this.xAxis,a=this.yAxis,l=this._valueElement.firstChild.offsetWidth,s=this._valueElement.firstChild.offsetHeight,r=this._valueElement.firstChild.offsetLeft,o=this._valueElement.firstChild.offsetTop;let u=n.findIndex((t=>t>e));u<0?u=n.length-1:u>0&&u<n.length-1&&(u+=(e-n[u-1])/(n[u]-n[u-1])-1);let h,d=a.findIndex((e=>e>t));if(d<0?d=a.length-1:d>0&&d<a.length-1&&(d+=(t-a[d-1])/(a[d]-a[d-1])-1),e=r+u*l+l/2,t=o+d*s+s/2,this.#be.children.length>0){h=this.#be.firstChild;let i=document.createElementNS("http://www.w3.org/2000/svg","line");i.setAttribute("x1",h.getAttribute("cx")),i.setAttribute("y1",h.getAttribute("cy")),i.setAttribute("x2",e),i.setAttribute("y2",t),this.#be.children.length>1?this.#be.insertBefore(i,this.#be.children[1]):this.#be.append(i)}else h=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),this.#be.append(h);h.setAttribute("rx",l/2),h.setAttribute("ry",s/2),h.setAttribute("cx",e),h.setAttribute("cy",t),setTimeout((()=>{let e=this.#be.lastChild;e&&this.#be.removeChild(e)}),this.trailTime)}#xe(){let e=[];const t=this._xAxisElement.children.length,i=this._yAxisElement.children.length;if(t>1&&i>1){const t=document.createElement("tr");e.push(t);t.appendChild(document.createElement("td")).colSpan=3;const i=t.appendChild(document.createElement("td"));i.class="xtrans",i.append(this.#X)}const n=document.createElement("tr");if(e.push(n),t>1){const e=n.appendChild(document.createElement("td"));e.class="xztrans",i>1?(e.colSpan=3,e.append(this.#Z)):e.append(this.#X);n.appendChild(document.createElement("td")).append(this._xAxisElement),n.append(this.#z)}else if(i>1){n.appendChild(document.createElement("td")).append(this.#$);n.appendChild(document.createElement("td")).append(this.#Z)}const a=document.createElement("tr");e.push(a);const l=document.createElement("tr");if(e.push(l),i>1){if(t>1){a.appendChild(document.createElement("td")).style="width: auto; min-width: 2em;";const e=a.appendChild(document.createElement("td"));e.class="ytrans",e.append(this.#$),l.appendChild(document.createElement("td")).colSpan=2}const e=a.appendChild(document.createElement("td"));e.class="yAxis",e.append(this._yAxisElement),l.append(this.#Y),l.append(this.#j)}else if(t>1){const e=a.appendChild(document.createElement("td"));e.class="xztrans",e.append(this.#Z)}const s=a.appendChild(document.createElement("td"));s.append(this.#be),s.append(this._valueElement),this.#D.replaceChildren(...e)}_resolutionChanged(e,t){for(;t<e.children.length;)e.removeChild(e.lastChild);for(let i=e.children.length;i<t;i++){const t=e.appendChild(document.createElement("div"));Object.defineProperty(t,"value",UITable.#Ue);const n=e.children[i-1]?.value,a=e.children[i-2]?.value;let l=0;null!=n&&null!=a&&(l=n+(n-a)),t.value=l,e===this._xAxisElement?t.x=i:t.y=i}for(this.style.setProperty("--xresolution",this.xResolution),this.style.setProperty("--yresolution",this.yResolution);this.xResolution*this.yResolution<this._valueElement.children.length;)this._valueElement.removeChild(this._valueElement.lastChild);for(let e=0;e<this.xResolution*this.yResolution;e++){const t=this._valueElement.children[e]??this._valueElement.appendChild(document.createElement("div"));Object.defineProperty(t,"value",UITable.#Ue),t.x=e%this.xResolution,t.y=Math.trunc(e/this.xResolution)}this.xResolution>1?(this.yResolution>1?(this.#le.classList.add("interpolatexy"),this.#oe.hidden=!1):(this.#le.classList.remove("interpolatexy"),this.#oe.hidden=!0),this.#se.hidden=!1):(this.#le.classList.remove("interpolatexy"),this.#oe.hidden=!0,this.#se.hidden=!0),this.yResolution>1?this.#re.hidden=!1:this.#re.hidden=!0,this.#xe()}#Ee(){const e=()=>{const e=Bn(this.value);this._valueMin=e[0],this._valueMax=e[1]};this.addEventListener("change",e),e(),this.#ue.addEventListener("click",(e=>{let t=e.target;for(let e=0;e<2;e++)t.value||(t=t.parentElement);t.value&&(this.#ue.querySelectorAll(".selected").forEach((e=>{e.classList.remove("selected")})),t.classList.add("selected"))})),this._xResolutionElement.addEventListener("change",(e=>{this.xResolution=parseInt(e.target.value)})),this._yResolutionElement.addEventListener("change",(e=>{this.yResolution=parseInt(e.target.value)}));const t=()=>{if(!this.#F.parentElement)return;let e=parseInt(this.#F.parentElement.x),t=parseInt(this.#F.parentElement.y);const i=parseFloat(this.#F.parentElement.value);let n=parseFloat(this.#F.value);if(isNaN(n)||n===i||null==e&&null==t)return;let a=this._valueElement;isNaN(t)?a=this._xAxisElement:isNaN(e)&&(a=this._yAxisElement);a.querySelectorAll(".selected").forEach((e=>{e.value=n})),this._boundAxis(a)};this.#F.addEventListener("change",t),this.#F.addEventListener("copy",(e=>{let t,i="";this.#D.querySelectorAll(".selected").forEach((e=>{if(isNaN(parseFloat(e.value)))return;if(null==e.y&&null==e.x)return;let n=parseInt(e.y??-1);null!=t&&(i+=t!==n?"\n":"\t"),i+=e.value,t=n})),e.clipboardData.setData("text/plain",i),e.preventDefault()})),this.#F.addEventListener("paste",(e=>{var t=e.clipboardData.getData("text/plain");const i=t.split("\n").length,n=t.split("\t").length;let a=parseInt(e.target.parentElement.x),l=parseInt(e.target.parentElement.y),s=this._valueElement;if(isNaN(a)){if(n>1)return;a=0,s=this._yAxisElement}if(isNaN(l)){if(i>1)return;l=0,s=this._xAxisElement}let r=this.#ue.querySelector(".selected")?.value;t.split("\n").forEach(((e,t)=>{var i=l+t;i>this.yResolution-1||(s===this._valueElement&&(i*=this.xResolution),e.split("\t").forEach(((e,t)=>{var n=a+t;if(n>this.xResolution-1)return;var l=parseFloat(e);let o=s.children[n+i];switch(r){case"add":o.value+=l;break;case"subtract":o.value-=l;break;case"multiply":o.value*=l;break;case"multiply%":o.value*=1+l/100;break;case"multiply%/2":o.value*=1+l/200;break;case"average":o.value+=l,o.value/=2;break;default:o.value=l}})))})),this.selecting={startX:a,startY:l,endX:a+t.split("\n")[0].split("\t").length-1,endY:l+t.split("\n").length-1},e.preventDefault(),this._boundAxis(s),this.dispatchEvent(new Event("change",{bubbles:!0}))})),this.#D.addEventListener("dragstart",(e=>{e.preventDefault()}));let i=!1,n=!1,a=!1;const l=e=>{r(e.pageX,e.pageY)},s=e=>{var t=e.touches[e.touches.length-1];r(t.pageX,t.pageY)},r=(e,t)=>{if(i){var l=this._xAxisElement.firstChild.offsetWidth;let t=(e-i.startPageX)/l;const n=t/Math.abs(t);t=parseInt((Math.abs(t)+.5)*n);let a=i.startXResolution+t;a<2&&(a=2),this.xResolution=a}if(n){var s=this._yAxisElement.firstChild.offsetHeight;let e=(t-n.startPageY)/s;const i=e/Math.abs(e);e=parseInt((Math.abs(e)+.5)*i);let a=n.startYResolution+e;a<2&&(a=2),this.yResolution=a}if(a){var r=a.startElement.getBoundingClientRect();let i=e-r.left;i<0&&(i-=r.width);let n=t-r.top;n<0&&(n-=r.height),i=parseInt(i/r.width),n=parseInt(n/r.height),a.endX=Math.min(this.xResolution-1,Math.max(0,a.startX+i)),a.endY=Math.min(this.yResolution-1,Math.max(0,a.startY+n)),(Math.abs(i)>0||Math.abs(n)>0)&&(a.selectOnMove=!1),a.selectOnMove||(this.selecting={startX:a.startX,startY:a.startY,endX:a.endX,endY:a.endY})}};let o=!1;const u=()=>{if(i=!1,n=!1,a){const e=null!=a.startElement.x||null!=a.startElement.y;o&&e&&this.#F.select()}a=!1,document.removeEventListener("touchmove",s),document.removeEventListener("mousemove",l)};document.addEventListener("mouseup",u),document.addEventListener("touchend",u);const h=e=>{o=!1;const i=null!=e.target.x||null!=e.target.y,n=null!=e.target.parentElement.x||null!=e.target.parentElement.y;(i||n)&&(a={startElement:i?e.target:e.target.parentElement,selectOnMove:n},a.startX=parseInt(a.startElement.x),a.startY=parseInt(a.startElement.y),i&&(t(),a.selectOnMove||(this.selecting={startX:a.startX,startY:a.startY,endX:a.startX,endY:a.startY})),"number"!==e.target.type&&(o=!0)),document.addEventListener("touchmove",s),document.addEventListener("mousemove",l)};this.#D.addEventListener("mousedown",(e=>{2===e.button?(h(e),e.target.select?.(),u(),e.preventDefault()):0==e.button&&h(e)})),this.#D.addEventListener("contextmenu",(e=>{h(e),e.preventDefault()})),this.#j.addEventListener("mousedown",(e=>{i={startPageX:e.pageX,startXResolution:this.xResolution},n={startPageY:e.pageY,startYResolution:this.yResolution},document.addEventListener("mousemove",l)})),this.#z.addEventListener("mousedown",(e=>{i={startPageX:e.pageX,startXResolution:this.xResolution},document.addEventListener("mousemove",l)})),this.#Y.addEventListener("mousedown",(e=>{n={startPageY:e.pageY,startYResolution:this.yResolution},document.addEventListener("mousemove",l)}))}#we(){this.#F.addEventListener("keypress",(e=>{"+"===e.key&&(e.preventDefault(),this.#ae.select(),this.#K.classList.add("selected")),!e.shiftKey||"-"!==e.key&&"_"!==e.key||(e.preventDefault(),this.#K.hidden=!0,this.#Q.hidden=!1,this.#ae.select(),this.#Q.classList.add("selected")),"*"===e.key&&(e.preventDefault(),this.#ae.select(),this.#ee.classList.add("selected")),"/"===e.key&&(e.preventDefault(),this.#ee.hidden=!0,this.#te.hidden=!1,this.#ae.select(),this.#te.classList.add("selected")),"%"===e.key&&(e.preventDefault(),this.#ee.hidden=!0,this.#ie.hidden=!1,this.#ae.select(),this.#ie.classList.add("selected")),"="===e.key&&(e.preventDefault(),this.#ae.select(),this.#ne.classList.add("selected"))}));const e=e=>{const t=parseFloat(this.#ae.value);if(isNaN(t))return;let i=this._valueElement;null==this.#F.parentElement.x&&(i=this._yAxisElement),null==this.#F.parentElement.y&&(i=this._xAxisElement),i.querySelectorAll(".selected").forEach((i=>{switch(e){case"equal":i.value=t;break;case"add":i.value+=t;break;case"subtract":i.value-=t;break;case"multiply":i.value*=t;break;case"divide":i.value/=t;break;case"percent":i.value*=1+t/100;break;default:return}})),this._boundAxis(i),this.dispatchEvent(new Event("change",{bubbles:!0}))},t=()=>{this.#K.hidden=!1,this.#Q.hidden=!0,this.#ee.hidden=!1,this.#te.hidden=!0,this.#ie.hidden=!0;for(let e=0;e<this.#J.children.length;e++)this.#J.children[e].classList.remove("selected")};this.#ae.addEventListener("blur",t),this.#ae.addEventListener("keypress",(e=>{"Enter"===e.key&&(this.#J.querySelector(".selected")?.dispatchEvent(new Event("click")),t(),this.#F.select())})),this.#ne.addEventListener("click",(()=>{e("equal")})),this.#K.addEventListener("click",(()=>{e("add")})),this.#Q.addEventListener("click",(()=>{e("subtract")})),this.#ee.addEventListener("click",(()=>{e("multiply")})),this.#te.addEventListener("click",(()=>{e("divide")})),this.#ie.addEventListener("click",(()=>{e("percent")}))}#_e(){const e=()=>{let e=this._valueElement.querySelectorAll(".selected");if(e.length<3&&(e=this._xAxisElement.querySelectorAll(".selected"),e.length<3))return;let t=18e18,i=-9e18;e.forEach((e=>{const n=parseInt(e.x);n<t&&(t=n),n>i&&(i=n)}));const n=this.xAxis,a=n[i]-n[t];if(isNaN(e[0].y)){const l=a/(i-t);e.forEach((e=>{const i=parseInt(e.x);e.value=n[t]+l*(i-t)}))}else{const l=this.xResolution,s=this.value;e.forEach((e=>{const r=parseInt(e.x),o=parseInt(e.y);if(!isNaN(r)&&!isNaN(o)){const u=s[t+o*l];let h=u+(s[i+o*l]-u)/a*(n[r]-n[t]);e.value=h}}))}this.dispatchEvent(new Event("change",{bubbles:!0}))},t=()=>{let e=this._valueElement.querySelectorAll(".selected");if(e.length<3&&(e=this._yAxisElement.querySelectorAll(".selected"),e.length<3))return;let t=18e18,i=-9e18;e.forEach((e=>{const n=parseInt(e.y);n<t&&(t=n),n>i&&(i=n)}));const n=this.yAxis,a=n[i]-n[t];if(isNaN(e[0].x)){const l=a/(i-t);e.forEach((e=>{const i=parseInt(e.y);e.value=n[t]+l*(i-t)}))}else{const l=this.xResolution,s=this.value;e.forEach((e=>{const r=parseInt(e.x),o=parseInt(e.y);if(!isNaN(r)&&!isNaN(o)){const u=s[r+t*l];let h=u+(s[r+i*l]-u)/a*(n[o]-n[t]);e.value=h}}))}this.dispatchEvent(new Event("change",{bubbles:!0}))};this.#oe.addEventListener("click",(()=>{if(this._valueElement.querySelectorAll(".selected").length<5)return this._xAxisElement.querySelectorAll(".selected").length>2&&e(),void(this._yAxisElement.querySelectorAll(".selected").length>2&&t());e(),t()})),this.#se.addEventListener("click",e),this.#re.addEventListener("click",t)}}customElements.define("ui-table",UITable,{extends:"div"});class UITableWithUnit extends UITemplate{static template='<div data-element="displayValueElement">';get zLabel(){return this.#q}set zLabel(e){this.#q!==e&&(this.#q=e,this.#Z.replaceChildren(e??""))}get measurement(){return this.displayUnitElement.measurement}set measurement(e){this.displayUnitElement.measurement=e}get displayUnit(){return this.displayUnitElement.value}set displayUnit(e){this.displayUnitElement.value=e??this._valueUnit}get displayValue(){return this.displayValueElement.value}set displayValue(e){this.displayValueElement.value=e}_valueUnit;get valueUnit(){return this._valueUnit??this.displayUnit}set valueUnit(e){if(this._valueUnit===e)return;let t=Kn(this.value,this._valueUnit,e);this._valueUnit=e,this.displayUnit??=e,this.value=t}#o;get value(){return this.#o}set value(e){jn(this.#o,e)||(this.#o=e,this.displayValue=Kn(e,this.valueUnit,this.displayUnit),this.UpdateDisplayValue())}get xResolutionModifiable(){return this.displayValueElement.xResolutionModifiable}set xResolutionModifiable(e){this.displayValueElement.xResolutionModifiable=e}get xResolution(){return this.displayValueElement.xResolution}set xResolution(e){this.displayValueElement.xResolution=e}get xLabel(){return this.#G}set xLabel(e){this.#G!==e&&(this.#G=e,this.#X.replaceChildren(e??""))}get xMeasurement(){return this.xDisplayUnitElement.measurement}set xMeasurement(e){this.xDisplayUnitElement.measurement=e}get xDisplayUnit(){return this.xDisplayUnitElement.value}set xDisplayUnit(e){this.xDisplayUnitElement.value=e}get xDisplayAxis(){return this.displayValueElement.xAxis}set xDisplayAxis(e){this.displayValueElement.xAxis=e}_xUnit;get xUnit(){return Array.isArray(this._xUnit)?this._xUnit.find((e=>Jn(e)===Jn(this.xDisplayUnit))):this._xUnit??this.xDisplayUnit}set xUnit(e){if(jn(this._xUnit,e))return;const t=Array.isArray(e)?e.find((e=>Jn(e)===Jn(this.xDisplayUnit))):e,i=Kn(this.xAxis,this.xUnit,t);this._xUnit=e,this.xDisplayUnit??=Array.isArray(e)?e[0]:e,this.xAxis=i}#Ve;get xAxis(){return this.#Ve}set xAxis(e){jn(this.#Ve,e)||(this.#Ve=e,this.xDisplayAxis=Kn(e,this.xUnit,this.xDisplayUnit),this.UpdateDisplayValue())}get yResolutionModifiable(){return this.displayValueElement.yResolutionModifiable}set yResolutionModifiable(e){this.displayValueElement.yResolutionModifiable=e}get yResolution(){return this.displayValueElement.yResolution}set yResolution(e){this.displayValueElement.yResolution=e}get yLabel(){return this.#H}set yLabel(e){this.#H!==e&&(this.#H=e,this.#$.replaceChildren(e??""))}get yMeasurement(){return this.yDisplayUnitElement.measurement}set yMeasurement(e){this.yDisplayUnitElement.measurement=e}get yDisplayUnit(){return this.yDisplayUnitElement.value}set yDisplayUnit(e){this.yDisplayUnitElement.value=e}get yDisplayAxis(){return this.displayValueElement.yAxis}set yDisplayAxis(e){this.displayValueElement.yAxis=e}_yUnit;get yUnit(){return Array.isArray(this._yUnit)?this._yUnit.find((e=>Jn(e)===Jn(this.yDisplayUnit))):this._yUnit??this.yDisplayUnit}set yUnit(e){if(jn(this._yUnit,e))return;const t=Array.isArray(e)?e.find((e=>Jn(e)===Jn(this.yDisplayUnit))):e,i=Kn(this.yAxis,this.yUnit,t);this._yUnit=e,this.yDisplayUnit??=Array.isArray(e)?e[0]:e,this.yAxis=i}#Ae;get yAxis(){return this.#Ae}set yAxis(e){jn(this.#Ae,e)||(this.#Ae=e,this.yDisplayAxis=Kn(e,this.yUnit,this.yDisplayUnit),this.UpdateDisplayValue())}get selecting(){return this.displayValueElement.selecting}set selecting(e){this.displayValueElement.selecting=e}#f;get min(){return this.#f}set min(e){this.#f!==e&&(this.#f=e,this.UpdateDisplayValue())}#v;get max(){return this.#v}set max(e){this.#v!==e&&(this.#v=e,this.UpdateDisplayValue())}#g;get step(){return this.#g}set step(e){this.#g!==e&&(this.#g=e,this.UpdateDisplayValue())}#Ie=document.createElement("div");#X=document.createElement("span");#G="X";#Se=document.createElement("div");#$=document.createElement("span");#H="Y";#Te=document.createElement("div");#Z=document.createElement("span");#q=void 0;constructor(e){super(),this.displayValueElement=new UITable,this.displayUnitElement=new UIUnit({measurement:e?.measurement,value:e?.displayUnit??e?.valueUnit});let t=this.displayUnit;this.displayUnitElement.addEventListener("change",(()=>{null!=this.displayValue&&(this.displayValue=Kn(this.displayValue,t,this.displayUnit)),t=this.displayUnit})),this.xDisplayUnitElement=new UIUnit({measurement:e?.xMeasurement,value:e?.xDisplayUnit??e?.xUnit});let i=this.xDisplayUnit;this.xDisplayUnitElement.addEventListener("change",(()=>{null!=this.xDisplayAxis&&(this.xDisplayAxis=Kn(this.xDisplayAxis,i,this.xDisplayUnit)),i=this.xDisplayUnit})),this.yDisplayUnitElement=new UIUnit({measurement:e?.yMeasurement,value:e?.yDisplayUnit??e?.yUnit});let n=this.yDisplayUnit;if(this.yDisplayUnitElement.addEventListener("change",(()=>{null!=this.yDisplayAxis&&(this.yDisplayAxis=Kn(this.yDisplayAxis,n,this.yDisplayUnit)),n=this.yDisplayUnit})),this.displayValueElement.addEventListener("change",(()=>{null!=this.displayValue&&(this.value=Kn(this.displayValue,this.displayUnit,this.valueUnit)),null!=this.xDisplayAxis&&(this.xAxis=Kn(this.xDisplayAxis,this.xDisplayUnit,this.xUnit)),null!=this.yDisplayAxis&&(this.yAxis=Kn(this.yDisplayAxis,this.yDisplayUnit,this.yUnit))})),this.#Ie.append(this.#X),this.#Ie.append(this.xDisplayUnitElement),this.displayValueElement.xLabel=this.#Ie,this.#Se.append(this.#$),this.#Se.append(this.yDisplayUnitElement),this.displayValueElement.yLabel=this.#Se,this.#Te.append(this.#Z),this.#Te.append(this.displayUnitElement),this.displayValueElement.zLabel=this.#Te,e){const t=e.value;delete e.value,Object.assign(this,e),this.value=t}this.Setup(e)}get saveValue(){return{...this.displayValueElement.saveValue,value:this.value,xAxis:this.xAxis,yAxis:this.yAxis,...null!=this.displayUnitElement.saveValue&&{displayUnit:this.displayUnitElement.saveValue},...null!=this.xDisplayUnitElement.saveValue&&{xDisplayUnit:this.xDisplayUnitElement.saveValue},...null!=this.yDisplayUnitElement.saveValue&&{yDisplayUnit:this.yDisplayUnitElement.saveValue}}}set saveValue(e){this.displayValueElement.saveValue={...e,value:void 0,xAxis:void 0,yAxis:void 0},null!=e.displayUnit&&(this.displayUnitElement.saveValue=e.displayUnit),null!=e.xDisplayUnit&&(this.xDisplayUnitElement.saveValue=e.xDisplayUnit),null!=e.yDisplayUnit&&(this.yDisplayUnitElement.saveValue=e.yDisplayUnit),null!=e.xAxis&&(this.xAxis=e.xAxis),null!=e.yAxis&&(this.yAxis=e.yAxis),this.value=e.value}UpdateDisplayValue(){const e=this.displayUnit,t=this.valueUnit;null!=this.value&&this.value.length===this.displayValue.length&&(this.displayValue=Kn(this.value,t,e)),this.displayValueElement.min=Kn(this.min,t,e)??this.displayValueElement.min,this.displayValueElement.max=Kn(this.max,t,e)??this.displayValueElement.max,this.displayValueElement.step=Kn(this.step,t,e)??this.displayValueElement.step,null!=this.xAxis&&this.xAxis.length===this.xDisplayAxis.length&&(this.xDisplayAxis=Kn(this.xAxis,this.xUnit,this.xDisplayUnit)),null!=this.yAxis&&this.yAxis.length===this.yDisplayAxis.lengt&&(this.yDisplayAxis=Kn(this.yAxis,this.yUnit,this.yDisplayUnit))}attachToTable(e){this.displayValueElement.attachToTable(e),e.attachToTable(this.displayValueElement)}trail(e,t,i){this.displayValueElement.trail(e,t,i)}}customElements.define("ui-tablewithunit",UITableWithUnit,{extends:"span"});class Calculation_LookupTable extends UITemplate{static displayName="Lookup Table";static outputTypes=["float"];static inputTypes=["float"];static template='<div data-element="dialog"></div>';GUID=ea();dialog=new UIDialog({buttonLabel:"Edit Table"});table=new UITableWithUnit({xAxis:[1,2,3,4,5,6,7,8],yResolution:1,yResolutionModifiable:!1});graph=new UIGraph2D({width:Math.min(Math.max(600,100*this.table.xResolution),1e3),height:450});constructor(e){super(),this.graph.addEventListener("change",(()=>{this.graph.width=Math.min(Math.max(600,75*this.graph.xResolution),1e3)})),this.table.addEventListener("change",(()=>{this.parameterSelection&&(this.parameterSelection.displayUnit=this.table.xDisplayUnit)})),this.table.attachToTable(this.graph),this.dialog.content.append(this.graph),this.dialog.content.append(document.createElement("br")),this.dialog.content.append(this.table),this.noParameterSelection=!1,this.label="Value",this.Setup(e)}get label(){return this.table.zLabel}set label(e){this.table.zLabel=e,this.dialog.title=e}get xResolutionModifiable(){return this.table.xResolutionModifiable}set xResolutionModifiable(e){this.table.xResolutionModifiable=e}get xResolution(){return this.table.xResolution}set xResolution(e){this.table.xResolution=e}_xLabel="X";get xLabel(){return this._xLabel}set xLabel(e){this._xLabel!==e&&(this._xLabel=e,this.parameterSelection||(this.table.xLabel=e))}get xMeasurement(){return this.table.xMeasurement}set xMeasurement(e){this.table.xMeasurement=e}get xDisplayUnit(){return this.table.xDisplayUnit}set xDisplayUnit(e){this.table.xDisplayUnit=e}get xDisplayAxis(){return this.table.xDisplayAxis}set xDisplayAxis(e){this.table.xDisplayAxis=e}get xUnit(){return this.table.xUnit}set xUnit(e){this.table.xUnit=e}get xAxis(){return this.table.xAxis}set xAxis(e){this.table.xAxis=e}get xOptions(){return this.parameterSelection?.options}set xOptions(e){if(!this.parameterSelection)return;this.parameterSelection.options=e;const t=this.parameterSelection.units;this.xMeasurement=Jn(t),this.xUnit=t}get noParameterSelection(){return!this.parameterSelection}set noParameterSelection(e){if(e)return this.parameterSelection=void 0,void(this.table.xLabel=this.xLabel);this.parameterSelection?null==this._inputUnits?.[0]&&(this.xMeasurement=void 0):(this.parameterSelection=new UIParameterWithUnit({options:VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[0],["float"])),selectHidden:!0}),this.parameterSelection.unitHidden=!0,this.parameterSelection.addEventListener("change",(()=>{if(null==this._inputUnits?.[0]){const e=this.parameterSelection.units;this.xMeasurement=Jn(e),this.xUnit=e}})),this.table.xLabel=this.parameterSelection)}get min(){return this.table.min}set min(e){this.table.min=e}get max(){return this.table.max}set max(e){this.table.max=e}get step(){return this.table.step}set step(e){this.table.step=e}get displayUnit(){return this.table.displayUnit}set displayUnit(e){this.table.displayUnit=e}get displayValue(){return this.table.displayValue}set displayValue(e){this.table.displayValue=e}get measurement(){return this.table.measurement}set measurement(e){this.table.measurement=e}get valueUnit(){return this.table.valueUnit}set valueUnit(e){this.table.valueUnit=e}get value(){return{...super.value,table:this.table.saveValue,graph:void 0}}set value(e){const t=(e={...e}).table;delete e.table,null!=e.parameterSelection?.unit&&(this.xUnit=e.parameterSelection?.unit),super.value=e,this.table.saveValue=t}get saveValue(){let e=super.saveValue;return delete e.graph,e}set saveValue(e){const t=e.table;delete(e={...e}).table,null!=e.parameterSelection?.unit&&(this.xUnit=e.parameterSelection?.unit),super.saveValue=e,void 0!==t&&(this.table.saveValue=t)}_inputUnits;get inputUnits(){return[this.xUnit]}set inputUnits(e){this._inputUnits=e?.[0],this.xOptions=VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[0],["float"])),this.xUnit=e?.[0],null!=e?.[0]&&(this.xMeasurement=Jn(e?.[0]))}get outputUnits(){return[this.valueUnit]}set outputUnits(e){this.valueUnit=e?.[0],null!=e?.[0]&&(this.measurement=Jn(e?.[0]))}get displayUnits(){return[this.displayUnit]}set displayUnits(e){this.displayUnit=e?.[0]}RegisterVariables(){this.xOptions=VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[0],["float"])),-1===Ti.variablesToPoll.indexOf(this.parameterSelection?.value)&&Ti.variablesToPoll.push(this.parameterSelection?.value),Ti.liveUpdateEvents[this.GUID]=(e,t)=>{if(this.parameterSelection?.value){const i=e?.GetVariableId(this.parameterSelection?.value);null!=t?.[i]&&this.table.trail(t[i])}}}}ia.push(Calculation_LookupTable),customElements.define("calculation-lookuptable",Calculation_LookupTable,{extends:"span"});class Calculation_Polynomial extends HTMLDivElement{static displayName="Polynomial";static outputTypes=["float"];static inputTypes=["float"];#Ce=document.createElement("div");#ke=new UINumberWithUnit({value:0});#Pe=new UINumberWithUnit({value:1});#Le=new UINumber({min:2,max:100,step:1,value:0});constructor(e){super(),this.class="configContainer";const t=document.createElement("label");t.textContent="Minimum Value:",this.append(t),this.#ke.displayUnitElement.hidden=!0,this.append(this.#ke),this.append(document.createElement("br"));const i=document.createElement("label");this.append(i),this.#Pe.displayUnitElement.hidden=!0,i.textContent="Maximum Value:",this.append(this.#Pe),this.append(document.createElement("br"));const n=document.createElement("label");n.textContent="Degree:",this.append(n),this.append(this.#Le),this.append(document.createElement("br")),this.#Le.addEventListener("change",(()=>{for(;this.#Ce.children.length>this.degree;)this.#Ce.removeChild(this.#Ce.lastChild);for(let e=this.#Ce.children.length;e<this.degree;e++){let t=this.#Ce.appendChild(document.createElement("div"));t.appendChild(0===e?new UINumberWithUnit({value:0}):new UINumber({value:0}));if(0!==e){t.appendChild(document.createElement("span")).innerHTML=`x<sup>${e}</sup> +`}t.style.display="inline",Object.defineProperty(t,"value",{get:function(){return this.firstChild.value},set:function(e){this.firstChild.value=e}})}})),this.degree=2,this.append(this.#Ce),this.#Ce.style.display="flex",this.#Ce.style.flexDirection="row-reverse",this.#Ce.style.alignItems="flex-start",this.#Ce.style.justifyContent="flex-end",this.#Ce.firstChild.addEventListener("change",(()=>{this.displayUnits=this.displayUnits})),this.Setup(e)}Setup(e){Object.assign(this,e)}get coeffecients(){return[...this.#Ce.children].map(((e,t)=>e.value))}set coeffecients(e){this.degree=e.length;for(let t=0;t<this.#Ce.children.length;t++)this.#Ce.children[t].value=e[t]}get minValue(){return this.#ke.value}set minValue(e){this.#ke.value=e}get maxValue(){return this.#Pe.value}set maxValue(e){this.#Pe.value=e}get degree(){return this.#Le.value}set degree(e){this.#Le.value=e}get displayUnit(){return this.#Ce.firstChild.firstChild.displayUnit}set displayUnit(e){this.#Ce.firstChild.firstChild.displayUnit=this.#Ce.firstChild.firstChild.valueUnit=e,this.#ke.displayUnit=this.#Pe.valueUnit=e,this.#Pe.displayUnit=this.#Pe.valueUnit=e,this.#Ce.firstChild.firstChild.displayUnit=e}get measurement(){return this.#Ce.firstChild.firstChild.measurement}set measurement(e){this.#Ce.firstChild.firstChild.measurement=e}get valueUnit(){return this.#Ce.firstChild.firstChild.valueUnit}set valueUnit(e){this.#Ce.firstChild.firstChild.displayUnit=this.#Ce.firstChild.firstChild.valueUnit=e,this.#ke.displayUnit=this.#Pe.valueUnit=e,this.#Pe.displayUnit=this.#Pe.valueUnit=e,this.#Ce.firstChild.firstChild.displayUnit=e}get value(){return{minValue:this.minValue,maxValue:this.maxValue,coeffecients:this.coeffecients,unit:this.valueUnit}}set value(e){e&&(this.minValue=e.minValue,this.maxValue=e.maxValue,this.coeffecients=e.coeffecients,this._outputUnits||(this.numberElement.displayUnit=e.unit))}get saveValue(){return{minValue:this.#ke.saveValue,maxValue:this.#Pe.saveValue,coeffecients:this.coeffecients,unit:this.displayUnit}}set saveValue(e){e&&(this.#ke.saveValue=e.minValue,this.#Pe.saveValue=e.maxValue,this.coeffecients=e.coeffecients,this.displayUnit=e.unit)}_outputUnits;get outputUnits(){return this._outputUnits??[this.valueUnit]}set outputUnits(e){this._outputUnits=e,this.valueUnit=e?.[0],null!=this.valueUnit&&(this.measurement=Jn(this.valueUnit))}get displayUnits(){return[this.displayUnit]}set displayUnits(e){this.displayUnit=e?.[0]}}customElements.define("ui-polynomial",Calculation_Polynomial,{extends:"div"});const na=[{group:"Generic Pin Input",calculations:ta},{group:"Custom Input",calculations:[Calculation_Static,Calculation_LookupTable,Calculation_Polynomial]}];class Input extends UITemplate{static template='<div style="float: right;"></div><div data-element="translationConfig"></div><div data-element="hr"></div><div data-element="rawConfig"></div>';get outputTypes(){return this.translationConfig.outputTypes}set outputTypes(e){this.translationConfig.outputTypes=e}get outputUnits(){return this.translationConfig.outputUnits}set outputUnits(e){this.translationConfig.outputUnits=e}hr=document.createElement("hr");name=new UIText({class:"pinselectname inputName"});translationConfig=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:na,selectionFilter:function(){return function(e){return!e.type&&!e.unit}},noParameterSelection:!0});rawConfig=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:na,selectionFilter:Ai,label:"Source",inputTypes:[],noParameterSelection:!0,hidden:!0});constructor(e){super(),this.style.display="block",this.name.addEventListener("change",(()=>{this.translationConfig.label=this.name.value})),this.translationConfig.addEventListener("change",(()=>{this.translationConfig.inputUnits=this.translationConfig.inputTypes=void 0,0===(this.translationConfig.inputUnits?.length??this.translationConfig.inputTypes?.length??0)?(this.hr.hidden=!0,this.rawConfig.hidden=!0,this.rawConfig.selection.value=void 0):(this.hr.hidden=!1,this.rawConfig.hidden=!1)})),this.translationConfig.labelElement.replaceWith(this.name),this.rawConfig.addEventListener("change",(()=>{this.rawConfig.outputUnits?.[0]&&(this.translationConfig.inputUnits=this.rawConfig.outputUnits,this.translationConfig.xLabel=Jn(this.rawConfig.outputUnits?.[0]))})),this.hr.hidden=!0,this.hr.style.margin="2px",e??={},this.name.value=e.name??"Name",delete e.name,this.Setup(e)}RegisterVariables(){const e={name:`Inputs.${this.name.value}`};this.translationConfig.RegisterVariables?.(e),0!==(this.translationConfig.inputUnits?.length??this.translationConfig.inputTypes?.length??0)&&this.rawConfig.RegisterVariables?.(e)}}customElements.define("config-input",Input,{extends:"span"});class ConfigList extends HTMLDivElement{#Me=[];get staticItems(){return this.#Me}set staticItems(e){jn(this.#Me,e)||(this.#Me=e,this.#Oe())}#Oe(){this.staticItems.forEach(((e,t)=>{if(void 0!==[...this.children].find((t=>t.item===e.item)))return;const i=this.staticItems[t-1]?.item;if(void 0===i||void 0===[...this.children].find((e=>e.item===i))){let i=1,n=this.staticItems[t+i]?.item;for(;void 0!==n&&void 0===[...this.children].find((e=>e.item===n));)n=this.staticItems[++i]?.item;return void 0===n?this.appendNewItem(e.item):this.appendNewItem(e.item,[...this.children].find((e=>e.item===n)))}return this.appendNewItem(e.item,[...this.children].find((e=>e.item===i)).nextSibling)}))}constructor(e){super(),this.class="itemList",this.newItemElement=new UIButton({className:"controlnew"}),this.newItemElement.addEventListener("click",(()=>{this.appendNewItem(this.newItem())})),e??={};const t=e.saveValue??[],i=e.value;delete e.saveValue,delete e.value,Object.assign(this,e),null!=t&&(this.saveValue=t),null!=i&&(this.value=i),this.tabListElement=document.createElement("div"),this.tabListNewElement=document.createElement("div"),this.tabListNewElement.class="w3-bar-subitem w3-button",this.tabListNewElement.textContent="+ New",this.tabListNewElement.addEventListener("click",(()=>{this.appendNewItem()})),this.addEventListener("change",(()=>{for(;[...this.children].filter((e=>e.item.constructor===Input)).length<this.tabListElement.children.length||this.tabListElement?.firstChild?.firstChild===this.tabListNewElement;)this.tabListElement.removeChild(this.tabListElement.lastChild);for(let e=0,t=0;e<this.children.length;e++){const i=this.children[e].item?.name?.value??this.children[e].item?.label;if(!i)continue;let n=this.tabListElement.children[t++];if(!n){n=this.tabListElement.appendChild(document.createElement("div")),this.children[e].item.constructor===Input&&(n.appendChild(new UIDisplayLiveUpdate).style.float="right",n.RegisterVariables=function(){const e=t.children[this.childIndex];this.firstChild.RegisterVariables({name:`Inputs.${e.name.value}`,unit:e.translationConfig.outputUnits?.[0]??e.rawConfig.outputUnits?.[0]})}),n.append(document.createElement("div")),n.class="w3-bar-subitem w3-button";const t=this;n.addEventListener("click",(function(){t.children[this.childIndex].scrollIntoView({behavior:"auto",block:"center",inline:"center"})}))}n.childIndex=e,n.lastChild.textContent=i,n.class="w3-bar-subitem w3-button"}if(0===this.tabListElement.children.length){this.tabListElement.appendChild(document.createElement("div")).appendChild(this.tabListNewElement)}})),this.dispatchEvent(new Event("change",{bubbles:!0}))}updateControls(){for(let e=0;e<this.children.length;e++){const t=this.children[e].controlElement.children[1],i=this.children[e].controlElement.children[3],n=this.children[e].controlElement.children[5],a=void 0!==this.staticItems.find((t=>t.item===this.children[e].item));0===e||a&&void 0!==this.staticItems.find((t=>t.item===this.children[e-1].item))?(t.className="controldummy",t.disabled=!0):(t.className="controlup",t.disabled=!1),a?(i.className="controldummy",i.disabled=!0):(i.className="controldelete",i.disabled=!1),e===this.children.length-1||a&&void 0!==this.staticItems.find((t=>t.item===this.children[e+1].item))?(n.className="controldummy",n.disabled=!0):(n.className="controldown",n.disabled=!1)}this.lastChild?this.lastChild.controlElement.append(this.newItemElement):this.parentElement?.insertBefore?.(this.newItemElement,this)}appendNewItem(e,t){e=e??this.newItem();let i=document.createElement("div");i.classList.add("itemContainer"),i.style.display="flex",i.item=i.appendChild(e),i.item.classList.add("item"),i.controlElement=i.appendChild(document.createElement("span")),i.controlElement.classList.add("controlcontainer");let n=i.controlElement.appendChild(document.createElement("span"));n.className="controladd";const a=this;n.addEventListener("click",(function(){a.appendNewItem(a.newItem(),this.parentElement.parentElement)}));let l=i.controlElement.appendChild(document.createElement("span"));l.className="controlup",l.addEventListener("click",(function(){this.disabled||(this.parentElement.parentElement.previousSibling.before(this.parentElement.parentElement),a.updateControls(),this.dispatchEvent(new Event("change",{bubbles:!0})))})),i.controlElement.appendChild(document.createElement("span")).className="controldummyfill";let s=i.controlElement.appendChild(document.createElement("span"));s.className="controldelete",s.addEventListener("click",(function(){this.disabled||(this.parentElement.parentElement.parentElement.removeChild(this.parentElement.parentElement),a.updateControls(),a.dispatchEvent(new Event("change",{bubbles:!0})))})),i.controlElement.appendChild(document.createElement("span")).className="controldummyfill";let r=i.controlElement.appendChild(document.createElement("span"));r.className="controldown",r.addEventListener("click",(function(){this.disabled||(this.parentElement.parentElement.nextSibling.after(this.parentElement.parentElement),a.updateControls(),this.dispatchEvent(new Event("change",{bubbles:!0})))})),i.RegisterVariables=function(e){this.item.RegisterVariables?.(e)},Object.entries(i.item).forEach((function([e,t]){void 0===i[e]&&Object.defineProperty(i,e,{get:function(){return this.item[e]},set:function(t){this.item[e]=t}})})),void 0===t?this.append(i):this.insertBefore(i,t),this.updateControls(),this.dispatchEvent(new Event("change",{bubbles:!0}))}newItem(){return new(this.itemConstructor??this.constructor.itemConstructor)}get saveValue(){return[...this.children].map((e=>void 0!==this.staticItems.find((t=>t.item===e.item))?{[this.staticItems.find((t=>t.item===e.item))?.name]:e.item.saveValue}:e.item.saveValue))}set saveValue(e){for([...this.children].forEach((e=>{void 0!==this.staticItems.find((t=>t.item===e.item))&&this.removeChild(e)}));this.children.length>e.length;)this.removeChild(this.lastChild);for(let t=0;t<e.length;t++){const i=this.staticItems.find((i=>1===Object.keys(e[t]).length&&i.name===Object.keys(e[t])[0]))?.item;if(!this.children[t]||void 0!==i){const e=i??this.newItem();this.appendNewItem(e,this.children[t])}this.children[t].item.saveValue=i?e[t][Object.keys(e[t])[0]]:e[t]}this.#Oe(),this.updateControls(),this.dispatchEvent(new Event("change",{bubbles:!0}))}get value(){return[...this.children].map((e=>void 0!==this.staticItems.find((t=>t.item===e.item))?{[this.staticItems.find((t=>t.item===e.item))?.name]:e.item.value}:e.item.value))}set value(e){for([...this.children].forEach((e=>{void 0!==this.staticItems.find((t=>t.item===e.item))&&this.removeChild(e)}));this.children.length>e.length;)this.removeChild(this.lastChild);for(let t=0;t<e.length;t++){const i=this.staticItems.find((i=>1===Object.keys(e[t]).length&&i.name===Object.keys(e[t])[0]))?.item;if(!this.children[t]||void 0!==i){const e=i??this.newItem();this.appendNewItem(e,this.children[t])}this.children[t].item.value=i?e[t][Object.keys(e[t])[0]]:e[t]}this.#Oe()}RegisterVariables(e){this.updateControls();for(var t=0;t<this.children.length;t++)this.children[t].RegisterVariables(e);for(t=0;t<this.tabListElement.children.length;t++)this.tabListElement.children[t].RegisterVariables?.()}}customElements.define("top-config-list",ConfigList,{extends:"div"});const aa="u-off",la="u-label",sa="width",ra="height",oa="top",ua="bottom",ha="left",da="right",ca="#000",pa=ca+"0",ma="mousemove",fa="mousedown",va="mouseup",ga="mouseenter",ya="mouseleave",ba="dblclick",xa="change",Ea="dppxchange",wa="--",_a="undefined"!=typeof window,Ua=_a?document:null,Va=_a?window:null,Aa=_a?navigator:null;let Ia,Sa;function Ta(e,t){if(null!=t){let i=e.classList;!i.contains(t)&&i.add(t)}}function Ca(e,t){let i=e.classList;i.contains(t)&&i.remove(t)}function ka(e,t,i){e.style[t]=i+"px"}function Pa(e,t,i,n){let a=Ua.createElement(e);return null!=t&&Ta(a,t),null!=i&&i.insertBefore(a,n),a}function La(e,t){return Pa("div",e,t)}const Ma=new WeakMap;function Oa(e,t,i,n,a){let l="translate("+t+"px,"+i+"px)";l!=Ma.get(e)&&(e.style.transform=l,Ma.set(e,l),t<0||i<0||t>n||i>a?Ta(e,aa):Ca(e,aa))}const Ra=new WeakMap;function Na(e,t,i){let n=t+i;n!=Ra.get(e)&&(Ra.set(e,n),e.style.background=t,e.style.borderColor=i)}const Da=new WeakMap;function Fa(e,t,i,n){let a=t+""+i;a!=Da.get(e)&&(Da.set(e,a),e.style.height=i+"px",e.style.width=t+"px",e.style.marginLeft=n?-t/2+"px":0,e.style.marginTop=n?-i/2+"px":0)}const za={passive:!0},Ba={...za,capture:!0};function ja(e,t,i,n){t.addEventListener(e,i,n?Ba:za)}function Wa(e,t,i,n){t.removeEventListener(e,i,za)}function Ya(e,t,i,n){let a;i=i||0;let l=(n=n||t.length-1)<=2147483647;for(;n-i>1;)a=l?i+n>>1:ll((i+n)/2),t[a]<e?i=a:n=a;return e-t[i]<=t[n]-e?i:n}function Ga(e,t,i,n){for(let a=1==n?t:i;a>=t&&a<=i;a+=n)if(null!=e[a])return a;return-1}function Xa(e,t,i,n){let a=dl(e),l=dl(t);e==t&&(-1==a?(e*=i,t/=i):(e/=i,t*=i));let s=10==i?cl:pl,r=1==l?rl:ll,o=(1==a?ll:rl)(s(al(e))),u=r(s(al(t))),h=hl(i,o),d=hl(i,u);return 10==i&&(o<0&&(h=Tl(h,-o)),u<0&&(d=Tl(d,-u))),n||2==i?(e=h*a,t=d*l):(e=Sl(e,h),t=Il(t,d)),[e,t]}function Ha(e,t,i,n){let a=Xa(e,t,i,n);return 0==e&&(a[0]=0),0==t&&(a[1]=0),a}_a&&function e(){let t=devicePixelRatio;Ia!=t&&(Ia=t,Sa&&Wa(xa,Sa,e),Sa=matchMedia(`(min-resolution: ${Ia-.001}dppx) and (max-resolution: ${Ia+.001}dppx)`),ja(xa,Sa,e),Va.dispatchEvent(new CustomEvent(Ea)))}();const $a={mode:3,pad:.1},qa={pad:0,soft:null,mode:0},Za={min:qa,max:qa};function Ja(e,t,i,n){return Fl(i)?Qa(e,t,i):(qa.pad=i,qa.soft=n?0:null,qa.mode=n?3:0,Qa(e,t,Za))}function Ka(e,t){return null==e?t:e}function Qa(e,t,i){let n=i.min,a=i.max,l=Ka(n.pad,0),s=Ka(a.pad,0),r=Ka(n.hard,-fl),o=Ka(a.hard,fl),u=Ka(n.soft,fl),h=Ka(a.soft,-fl),d=Ka(n.mode,0),c=Ka(a.mode,0),p=t-e,m=cl(p),f=ul(al(e),al(t)),v=cl(f),g=al(v-m);(p<1e-24||g>10)&&(p=0,0!=e&&0!=t||(p=1e-24,2==d&&u!=fl&&(l=0),2==c&&h!=-fl&&(s=0)));let y=p||f||1e3,b=cl(y),x=hl(10,ll(b)),E=Tl(Sl(e-y*(0==p?0==e?.1:1:l),x/10),24),w=e>=u&&(1==d||3==d&&E<=u||2==d&&E>=u)?u:fl,_=ul(r,E<w&&e>=w?w:ol(w,E)),U=Tl(Il(t+y*(0==p?0==t?.1:1:s),x/10),24),V=t<=h&&(1==c||3==c&&U>=h||2==c&&U<=h)?h:-fl,A=ol(o,U>V&&t<=V?V:ul(V,U));return _==A&&0==_&&(A=100),[_,A]}const el=new Intl.NumberFormat(_a?Aa.language:"en-US"),tl=e=>el.format(e),il=Math,nl=il.PI,al=il.abs,ll=il.floor,sl=il.round,rl=il.ceil,ol=il.min,ul=il.max,hl=il.pow,dl=il.sign,cl=il.log10,pl=il.log2,ml=(e,t=1)=>il.asinh(e/t),fl=1/0;function vl(e){return 1+(0|cl((e^e>>31)-(e>>31)))}function gl(e,t,i){return ol(ul(e,t),i)}function yl(e){return"function"==typeof e?e:()=>e}const bl=e=>e,xl=(e,t)=>t,El=e=>null,wl=e=>!0,_l=(e,t)=>e==t,Ul=/\.\d*?(?=9{6,}|0{6,})/gm,Vl=e=>{if(Nl(e)||Cl.has(e))return e;const t=`${e}`,i=t.match(Ul);if(null==i)return e;let n=i[0].length-1;if(-1!=t.indexOf("e-")){let[e,i]=t.split("e");return+`${Vl(e)}e${i}`}return Tl(e,n)};function Al(e,t){return Vl(Tl(Vl(e/t))*t)}function Il(e,t){return Vl(rl(Vl(e/t))*t)}function Sl(e,t){return Vl(ll(Vl(e/t))*t)}function Tl(e,t=0){if(Nl(e))return e;let i=10**t,n=e*i*(1+Number.EPSILON);return sl(n)/i}const Cl=new Map;function kl(e){return((""+e).split(".")[1]||"").length}function Pl(e,t,i,n){let a=[],l=n.map(kl);for(let s=t;s<i;s++){let t=al(s),i=Tl(hl(e,s),t);for(let r=0;r<n.length;r++){let o=10==e?+`${n[r]}e${s}`:n[r]*i,u=(s>=0?0:t)+(s>=l[r]?0:l[r]),h=10==e?o:Tl(o,u);a.push(h),Cl.set(h,u)}}return a}const Ll={},Ml=[],Ol=[null,null],Rl=Array.isArray,Nl=Number.isInteger;function Dl(e){return"string"==typeof e}function Fl(e){let t=!1;if(null!=e){let i=e.constructor;t=null==i||i==Object}return t}function zl(e){return null!=e&&"object"==typeof e}const Bl=Object.getPrototypeOf(Uint8Array),jl="__proto__";function Wl(e,t=Fl){let i;if(Rl(e)){let n=e.find((e=>null!=e));if(Rl(n)||t(n)){i=Array(e.length);for(let n=0;n<e.length;n++)i[n]=Wl(e[n],t)}else i=e.slice()}else if(e instanceof Bl)i=e.slice();else if(t(e)){i={};for(let n in e)n!=jl&&(i[n]=Wl(e[n],t))}else i=e;return i}function Yl(e){let t=arguments;for(let i=1;i<t.length;i++){let n=t[i];for(let t in n)t!=jl&&(Fl(e[t])?Yl(e[t],Wl(n[t])):e[t]=Wl(n[t]))}return e}function Gl(e,t,i){for(let n,a=0,l=-1;a<t.length;a++){let s=t[a];if(s>l){for(n=s-1;n>=0&&null==e[n];)e[n--]=null;for(n=s+1;n<i&&null==e[n];)e[l=n++]=null}}}const Xl="undefined"==typeof queueMicrotask?e=>Promise.resolve().then(e):queueMicrotask;const Hl=["January","February","March","April","May","June","July","August","September","October","November","December"],$l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function ql(e){return e.slice(0,3)}const Zl=$l.map(ql),Jl=Hl.map(ql),Kl={MMMM:Hl,MMM:Jl,WWWW:$l,WWW:Zl};function Ql(e){return(e<10?"0":"")+e}const es={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>Ql(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>Ql(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>Ql(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return 0==t?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>Ql(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>Ql(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>{return((t=e.getMilliseconds())<10?"00":t<100?"0":"")+t;var t}};function ts(e,t){t=t||Kl;let i,n=[],a=/\{([a-z]+)\}|[^{]+/gi;for(;i=a.exec(e);)n.push("{"==i[0][0]?es[i[1]]:i[0]);return e=>{let i="";for(let a=0;a<n.length;a++)i+="string"==typeof n[a]?n[a]:n[a](e,t);return i}}const is=(new Intl.DateTimeFormat).resolvedOptions().timeZone;const ns=e=>e%1==0,as=[1,2,2.5,5],ls=Pl(10,-32,0,as),ss=Pl(10,0,32,as),rs=ss.filter(ns),os=ls.concat(ss),us="{YYYY}",hs="\n"+us,ds="{M}/{D}",cs="\n"+ds,ps=cs+"/{YY}",ms="{aa}",fs="{h}:{mm}"+ms,vs="\n"+fs,gs=":{ss}",ys=null;function bs(e){let t=1e3*e,i=60*t,n=60*i,a=24*n,l=30*a,s=365*a;return[(1==e?Pl(10,0,3,as).filter(ns):Pl(10,-3,0,as)).concat([t,5*t,10*t,15*t,30*t,i,5*i,10*i,15*i,30*i,n,2*n,3*n,4*n,6*n,8*n,12*n,a,2*a,3*a,4*a,5*a,6*a,7*a,8*a,9*a,10*a,15*a,l,2*l,3*l,4*l,6*l,s,2*s,5*s,10*s,25*s,50*s,100*s]),[[s,us,ys,ys,ys,ys,ys,ys,1],[28*a,"{MMM}",hs,ys,ys,ys,ys,ys,1],[a,ds,hs,ys,ys,ys,ys,ys,1],[n,"{h}"+ms,ps,ys,cs,ys,ys,ys,1],[i,fs,ps,ys,cs,ys,ys,ys,1],[t,gs,ps+" "+fs,ys,cs+" "+fs,ys,vs,ys,1],[e,gs+".{fff}",ps+" "+fs,ys,cs+" "+fs,ys,vs,ys,1]],function(t){return(r,o,u,h,d,c)=>{let p=[],m=d>=s,f=d>=l&&d<s,v=t(u),g=Tl(v*e,3),y=Ss(v.getFullYear(),m?0:v.getMonth(),f||m?1:v.getDate()),b=Tl(y*e,3);if(f||m){let i=f?d/l:0,n=m?d/s:0,a=g==b?g:Tl(Ss(y.getFullYear()+n,y.getMonth()+i,1)*e,3),r=new Date(sl(a/e)),o=r.getFullYear(),u=r.getMonth();for(let l=0;a<=h;l++){let s=Ss(o+n*l,u+i*l,1),r=s-t(Tl(s*e,3));a=Tl((+s+r)*e,3),a<=h&&p.push(a)}}else{let l=d>=a?a:d,s=b+(ll(u)-ll(g))+Il(g-b,l);p.push(s);let m=t(s),f=m.getHours()+m.getMinutes()/i+m.getSeconds()/n,v=d/n,y=c/r.axes[o]._space;for(;s=Tl(s+d,1==e?0:3),!(s>h);)if(v>1){let e=ll(Tl(f+v,6))%24,i=t(s).getHours()-e;i>1&&(i=-1),s-=i*n,f=(f+v)%24,Tl((s-p[p.length-1])/d,3)*y>=.7&&p.push(s)}else p.push(s)}return p}}]}const[xs,Es,ws]=bs(1),[_s,Us,Vs]=bs(.001);function As(e,t){return e.map((e=>e.map(((i,n)=>0==n||8==n||null==i?i:t(1==n||0==e[8]?i:e[1]+i)))))}function Is(e,t){return(i,n,a,l,s)=>{let r,o,u,h,d,c,p=t.find((e=>s>=e[0]))||t[t.length-1];return n.map((t=>{let i=e(t),n=i.getFullYear(),a=i.getMonth(),l=i.getDate(),s=i.getHours(),m=i.getMinutes(),f=i.getSeconds(),v=n!=r&&p[2]||a!=o&&p[3]||l!=u&&p[4]||s!=h&&p[5]||m!=d&&p[6]||f!=c&&p[7]||p[1];return r=n,o=a,u=l,h=s,d=m,c=f,v(i)}))}}function Ss(e,t,i){return new Date(e,t,i)}function Ts(e,t){return t(e)}Pl(2,-53,53,[1]);function Cs(e,t){return(i,n,a,l)=>null==l?wa:t(e(n))}const ks={show:!0,live:!0,isolate:!1,mount:()=>{},markers:{show:!0,width:2,stroke:function(e,t){let i=e.series[t];return i.width?i.stroke(e,t):i.points.width?i.points.stroke(e,t):null},fill:function(e,t){return e.series[t].fill(e,t)},dash:"solid"},idx:null,idxs:null,values:[]};const Ps=[0,0];function Ls(e,t,i,n=!0){return e=>{0==e.button&&(!n||e.target==t)&&i(e)}}function Ms(e,t,i,n=!0){return e=>{(!n||e.target==t)&&i(e)}}const Os={show:!0,x:!0,y:!0,lock:!1,move:function(e,t,i){return Ps[0]=t,Ps[1]=i,Ps},points:{one:!1,show:function(e,t){let i=e.cursor.points,n=La(),a=i.size(e,t);ka(n,sa,a),ka(n,ra,a);let l=a/-2;ka(n,"marginLeft",l),ka(n,"marginTop",l);let s=i.width(e,t,a);return s&&ka(n,"borderWidth",s),n},size:function(e,t){return e.series[t].points.size},width:0,stroke:function(e,t){let i=e.series[t].points;return i._stroke||i._fill},fill:function(e,t){let i=e.series[t].points;return i._fill||i._stroke}},bind:{mousedown:Ls,mouseup:Ls,click:Ls,dblclick:Ls,mousemove:Ms,mouseleave:Ms,mouseenter:Ms},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,t)=>{t.stopPropagation(),t.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(e,t,i,n,a)=>n-a,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},Rs={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},Ns=Yl({},Rs,{filter:xl}),Ds=Yl({},Ns,{size:10}),Fs=Yl({},Rs,{show:!1}),zs='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',Bs="bold "+zs,js={show:!0,scale:"x",stroke:ca,space:50,gap:5,size:50,labelGap:0,labelSize:30,labelFont:Bs,side:2,grid:Ns,ticks:Ds,border:Fs,font:zs,lineGap:1.5,rotate:0},Ws={show:!0,scale:"x",auto:!1,sorted:1,min:fl,max:-fl,idxs:[]};function Ys(e,t,i,n,a){return t.map((e=>null==e?"":tl(e)))}function Gs(e,t,i,n,a,l,s){let r=[],o=Cl.get(a)||0;for(let e=i=s?i:Tl(Il(i,a),o);e<=n;e=Tl(e+a,o))r.push(Object.is(e,-0)?0:e);return r}function Xs(e,t,i,n,a,l,s){const r=[],o=e.scales[e.axes[t].scale].log,u=ll((10==o?cl:pl)(i));a=hl(o,u),10==o&&(a=os[Ya(a,os)]);let h=i,d=a*o;10==o&&(d=os[Ya(d,os)]);do{r.push(h),h+=a,10!=o||Cl.has(h)||(h=Tl(h,Cl.get(a))),h>=d&&(d=(a=h)*o,10==o&&(d=os[Ya(d,os)]))}while(h<=n);return r}function Hs(e,t,i,n,a,l,s){let r=e.scales[e.axes[t].scale].asinh,o=n>r?Xs(e,t,ul(r,i),n,a):[r],u=n>=0&&i<=0?[0]:[];return(i<-r?Xs(e,t,ul(r,-n),-i,a):[r]).reverse().map((e=>-e)).concat(u,o)}const $s=/./,qs=/[12357]/,Zs=/[125]/,Js=/1/,Ks=(e,t,i,n)=>e.map(((e,a)=>4==t&&0==e||a%n==0&&i.test(e.toExponential()[e<0?1:0])?e:null));function Qs(e,t,i,n,a){let l=e.axes[i],s=l.scale,r=e.scales[s],o=e.valToPos,u=l._space,h=o(10,s),d=o(9,s)-h>=u?$s:o(7,s)-h>=u?qs:o(5,s)-h>=u?Zs:Js;if(d==Js){let e=al(o(1,s)-h);if(e<u)return Ks(t.slice().reverse(),r.distr,d,rl(u/e)).reverse()}return Ks(t,r.distr,d,1)}function er(e,t,i,n,a){let l=e.axes[i],s=l.scale,r=l._space,o=e.valToPos,u=al(o(1,s)-o(2,s));return u<r?Ks(t.slice().reverse(),3,$s,rl(r/u)).reverse():t}function tr(e,t,i,n){return null==n?wa:null==t?"":tl(t)}const ir={show:!0,scale:"y",stroke:ca,space:30,gap:5,size:50,labelGap:0,labelSize:30,labelFont:Bs,side:3,grid:Ns,ticks:Ds,border:Fs,font:zs,lineGap:1.5,rotate:0};const nr={scale:null,auto:!0,sorted:0,min:fl,max:-fl},ar=(e,t,i,n,a)=>a,lr={show:!0,auto:!0,sorted:0,gaps:ar,alpha:1,facets:[Yl({},nr,{scale:"x"}),Yl({},nr,{scale:"y"})]},sr={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:ar,alpha:1,points:{show:function(e,t){let{scale:i,idxs:n}=e.series[0],a=e._data[0],l=e.valToPos(a[n[0]],i,!0),s=e.valToPos(a[n[1]],i,!0),r=al(s-l)/(e.series[t].points.space*Ia);return n[1]-n[0]<=r},filter:null},values:null,min:fl,max:-fl,idxs:[],path:null,clip:null};function rr(e,t,i,n,a){return i/10}const or={time:!0,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},ur=Yl({},or,{time:!1,ori:1}),hr={};function dr(e,t){let i=hr[e];return i||(i={key:e,plots:[],sub(e){i.plots.push(e)},unsub(e){i.plots=i.plots.filter((t=>t!=e))},pub(e,t,n,a,l,s,r){for(let o=0;o<i.plots.length;o++)i.plots[o]!=t&&i.plots[o].pub(e,t,n,a,l,s,r)}},null!=e&&(hr[e]=i)),i}function cr(e,t,i){const n=e.mode,a=e.series[t],l=2==n?e._data[t]:e._data,s=e.scales,r=e.bbox;let o=l[0],u=2==n?l[1]:l[t],h=2==n?s[a.facets[0].scale]:s[e.series[0].scale],d=2==n?s[a.facets[1].scale]:s[a.scale],c=r.left,p=r.top,m=r.width,f=r.height,v=e.valToPosH,g=e.valToPosV;return 0==h.ori?i(a,o,u,h,d,v,g,c,p,m,f,xr,wr,Ur,Ar,Sr):i(a,o,u,h,d,g,v,p,c,f,m,Er,_r,Vr,Ir,Tr)}function pr(e,t){let i=0,n=0,a=Ka(e.bands,Ml);for(let e=0;e<a.length;e++){let l=a[e];l.series[0]==t?i=l.dir:l.series[1]==t&&(1==l.dir?n|=1:n|=2)}return[i,1==n?-1:2==n?1:3==n?2:0]}function mr(e,t,i,n,a){let l=e.mode,s=e.series[t],r=2==l?s.facets[1].scale:s.scale,o=e.scales[r];return-1==a?o.min:1==a?o.max:3==o.distr?1==o.dir?o.min:o.max:0}function fr(e,t,i,n,a,l){return cr(e,t,((e,t,s,r,o,u,h,d,c,p,m)=>{let f=e.pxRound;const v=r.dir*(0==r.ori?1:-1),g=0==r.ori?wr:_r;let y,b;1==v?(y=i,b=n):(y=n,b=i);let x=f(u(t[y],r,p,d)),E=f(h(s[y],o,m,c)),w=f(u(t[b],r,p,d)),_=f(h(1==l?o.max:o.min,o,m,c)),U=new Path2D(a);return g(U,w,_),g(U,x,_),g(U,x,E),U}))}function vr(e,t,i,n,a,l){let s=null;if(e.length>0){s=new Path2D;const r=0==t?Ur:Vr;let o=i;for(let t=0;t<e.length;t++){let i=e[t];if(i[1]>i[0]){let e=i[0]-o;e>0&&r(s,o,n,e,n+l),o=i[1]}}let u=i+a-o,h=10;u>0&&r(s,o,n-h/2,u,n+l+h)}return s}function gr(e,t,i,n,a,l,s){let r=[],o=e.length;for(let u=1==a?i:n;u>=i&&u<=n;u+=a){if(null===t[u]){let h=u,d=u;if(1==a)for(;++u<=n&&null===t[u];)d=u;else for(;--u>=i&&null===t[u];)d=u;let c=l(e[h]),p=d==h?c:l(e[d]),m=h-a;c=s<=0&&m>=0&&m<o?l(e[m]):c;let f=d+a;p=s>=0&&f>=0&&f<o?l(e[f]):p,p>=c&&r.push([c,p])}}return r}function yr(e){return 0==e?bl:1==e?sl:t=>Al(t,e)}function br(e){let t=0==e?xr:Er,i=0==e?(e,t,i,n,a,l)=>{e.arcTo(t,i,n,a,l)}:(e,t,i,n,a,l)=>{e.arcTo(i,t,a,n,l)},n=0==e?(e,t,i,n,a)=>{e.rect(t,i,n,a)}:(e,t,i,n,a)=>{e.rect(i,t,a,n)};return(e,a,l,s,r,o=0,u=0)=>{0==o&&0==u?n(e,a,l,s,r):(o=ol(o,s/2,r/2),u=ol(u,s/2,r/2),t(e,a+o,l),i(e,a+s,l,a+s,l+r,o),i(e,a+s,l+r,a,l+r,u),i(e,a,l+r,a,l,u),i(e,a,l,a+s,l,o),e.closePath())}}const xr=(e,t,i)=>{e.moveTo(t,i)},Er=(e,t,i)=>{e.moveTo(i,t)},wr=(e,t,i)=>{e.lineTo(t,i)},_r=(e,t,i)=>{e.lineTo(i,t)},Ur=br(0),Vr=br(1),Ar=(e,t,i,n,a,l)=>{e.arc(t,i,n,a,l)},Ir=(e,t,i,n,a,l)=>{e.arc(i,t,n,a,l)},Sr=(e,t,i,n,a,l,s)=>{e.bezierCurveTo(t,i,n,a,l,s)},Tr=(e,t,i,n,a,l,s)=>{e.bezierCurveTo(i,t,a,n,s,l)};function Cr(e){return(e,t,i,n,a)=>cr(e,t,((t,l,s,r,o,u,h,d,c,p,m)=>{let f,v,{pxRound:g,points:y}=t;0==r.ori?(f=xr,v=Ar):(f=Er,v=Ir);const b=Tl(y.width*Ia,3);let x=(y.size-y.width)/2*Ia,E=Tl(2*x,3),w=new Path2D,_=new Path2D,{left:U,top:V,width:A,height:I}=e.bbox;Ur(_,U-E,V-E,A+2*E,I+2*E);const S=e=>{if(null!=s[e]){let t=g(u(l[e],r,p,d)),i=g(h(s[e],o,m,c));f(w,t+x,i),v(w,t,i,x,0,2*nl)}};if(a)a.forEach(S);else for(let e=i;e<=n;e++)S(e);return{stroke:b>0?w:null,fill:w,clip:_,flags:3}}))}function kr(e){return(t,i,n,a,l,s)=>{n!=a&&(l!=n&&s!=n&&e(t,i,n),l!=a&&s!=a&&e(t,i,a),e(t,i,s))}}const Pr=kr(wr),Lr=kr(_r);function Mr(e){const t=Ka(e?.alignGaps,0);return(e,i,n,a)=>cr(e,i,((l,s,r,o,u,h,d,c,p,m,f)=>{let v,g,y=l.pxRound,b=e=>y(h(e,o,m,c)),x=e=>y(d(e,u,f,p));0==o.ori?(v=wr,g=Pr):(v=_r,g=Lr);const E=o.dir*(0==o.ori?1:-1),w={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},_=w.stroke;let U,V,A,I=fl,S=-fl,T=b(s[1==E?n:a]),C=Ga(r,n,a,1*E),k=Ga(r,n,a,-1*E),P=b(s[C]),L=b(s[k]),M=!1;for(let e=1==E?n:a;e>=n&&e<=a;e+=E){let t=b(s[e]),i=r[e];t==T?null!=i?(V=x(i),I==fl&&(v(_,t,V),U=V),I=ol(V,I),S=ul(V,S)):null===i&&(M=!0):(I!=fl&&(g(_,T,I,S,U,V),A=T),null!=i?(V=x(i),v(_,t,V),I=S=U=V):(I=fl,S=-fl,null===i&&(M=!0)),T=t)}I!=fl&&I!=S&&A!=T&&g(_,T,I,S,U,V);let[O,R]=pr(e,i);if(null!=l.fill||0!=O){let t=w.fill=new Path2D(_),n=x(l.fillTo(e,i,l.min,l.max,O));v(t,L,n),v(t,P,n)}if(!l.spanGaps){let u=[];M&&u.push(...gr(s,r,n,a,E,b,t)),w.gaps=u=l.gaps(e,i,n,a,u),w.clip=vr(u,o.ori,c,p,m,f)}return 0!=R&&(w.band=2==R?[fr(e,i,n,a,_,-1),fr(e,i,n,a,_,1)]:fr(e,i,n,a,_,R)),w}))}function Or(e,t,i,n,a,l,s=fl){if(e.length>1){let r=null;for(let o=0,u=1/0;o<e.length;o++)if(void 0!==t[o]){if(null!=r){let t=al(e[o]-e[r]);t<u&&(u=t,s=al(i(e[o],n,a,l)-i(e[r],n,a,l)))}r=o}}return s}function Rr(e,t,i,n,a,l){const s=e.length;if(s<2)return null;const r=new Path2D;if(i(r,e[0],t[0]),2==s)n(r,e[1],t[1]);else{let i=Array(s),n=Array(s-1),l=Array(s-1),o=Array(s-1);for(let i=0;i<s-1;i++)l[i]=t[i+1]-t[i],o[i]=e[i+1]-e[i],n[i]=l[i]/o[i];i[0]=n[0];for(let e=1;e<s-1;e++)0===n[e]||0===n[e-1]||n[e-1]>0!=n[e]>0?i[e]=0:(i[e]=3*(o[e-1]+o[e])/((2*o[e]+o[e-1])/n[e-1]+(o[e]+2*o[e-1])/n[e]),isFinite(i[e])||(i[e]=0));i[s-1]=n[s-2];for(let n=0;n<s-1;n++)a(r,e[n]+o[n]/3,t[n]+i[n]*o[n]/3,e[n+1]-o[n]/3,t[n+1]-i[n+1]*o[n]/3,e[n+1],t[n+1])}return r}const Nr=new Set;function Dr(){for(let e of Nr)e.syncRect(!0)}_a&&(ja("resize",Va,Dr),ja("scroll",Va,Dr,!0),ja(Ea,Va,(()=>{Qr.pxRatio=Ia})));const Fr=Mr(),zr=Cr();function Br(e,t,i,n){return(n?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map(((e,n)=>jr(e,n,t,i)))}function jr(e,t,i,n){return Yl({},0==t?i:n,e)}function Wr(e,t,i){return null==t?Ol:[t,i]}const Yr=Wr;function Gr(e,t,i){return null==t?Ol:Ja(t,i,.1,!0)}function Xr(e,t,i,n){return null==t?Ol:Xa(t,i,e.scales[n].log,!1)}const Hr=Xr;function $r(e,t,i,n){return null==t?Ol:Ha(t,i,e.scales[n].log,!1)}const qr=$r;function Zr(e,t,i,n,a){let l=ul(vl(e),vl(t)),s=t-e,r=Ya(a/n*s,i);do{let e=i[r],t=n*e/s;if(t>=a&&l+(e<5?Cl.get(e):0)<=17)return[e,t]}while(++r<i.length);return[0,0]}function Jr(e){let t,i;return[e=e.replace(/(\d+)px/,((e,n)=>(t=sl((i=+n)*Ia))+"px")),t,i]}function Kr(e){e.show&&[e.font,e.labelFont].forEach((e=>{let t=Tl(e[2]*Ia,1);e[0]=e[0].replace(/[0-9.]+px/,t+"px"),e[1]=t}))}function Qr(e,t,i){const n={mode:Ka(e.mode,1)},a=n.mode;function l(e,t){return((3==t.distr?cl(e>0?e:t.clamp(n,e,t.min,t.max,t.key)):4==t.distr?ml(e,t.asinh):100==t.distr?t.fwd(e):e)-t._min)/(t._max-t._min)}function s(e,t,i,n){let a=l(e,t);return n+i*(-1==t.dir?1-a:a)}function r(e,t,i,n){let a=l(e,t);return n+i*(-1==t.dir?a:1-a)}function o(e,t,i,n){return 0==t.ori?s(e,t,i,n):r(e,t,i,n)}n.valToPosH=s,n.valToPosV=r;let u=!1;n.status=0;const h=n.root=La("uplot");if(null!=e.id&&(h.id=e.id),Ta(h,e.class),e.title){La("u-title",h).textContent=e.title}const d=Pa("canvas"),c=n.ctx=d.getContext("2d"),p=La("u-wrap",h);ja("click",p,(e=>{if(e.target===f){(Tt!=Vt||Ct!=At)&&Ft.click(n,e)}}),!0);const m=n.under=La("u-under",p);p.appendChild(d);const f=n.over=La("u-over",p),v=+Ka((e=Wl(e)).pxAlign,1),g=yr(v);(e.plugins||[]).forEach((t=>{t.opts&&(e=t.opts(n,e)||e)}));const y=e.ms||.001,b=n.series=1==a?Br(e.series||[],Ws,sr,!1):(x=e.series||[null],E=lr,x.map(((e,t)=>0==t?{}:Yl({},E,e))));var x,E;const w=n.axes=Br(e.axes||[],js,ir,!0),_=n.scales={},U=n.bands=e.bands||[];U.forEach((e=>{e.fill=yl(e.fill||null),e.dir=Ka(e.dir,-1)}));const V=2==a?b[1].facets[0].scale:b[0].scale,A={axes:function(){for(let e=0;e<w.length;e++){let t=w[e];if(!t.show||!t._show)continue;let i,a,l=t.side,s=l%2,r=t.stroke(n,e),u=0==l||3==l?-1:1;if(t.label){let e=t.labelGap*u,n=sl((t._lpos+e)*Ia);st(t.labelFont[0],r,"center",2==l?oa:ua),c.save(),1==s?(i=a=0,c.translate(n,sl(me+ve/2)),c.rotate((3==l?-nl:nl)/2)):(i=sl(pe+fe/2),a=n),c.fillText(t.label,i,a),c.restore()}let[h,d]=t._found;if(0==d)continue;let p=_[t.scale],m=0==s?fe:ve,f=0==s?pe:me,v=sl(t.gap*Ia),y=t._splits,b=2==p.distr?y.map((e=>tt[e])):y,x=2==p.distr?tt[y[1]]-tt[y[0]]:h,E=t.ticks,U=t.border,V=E.show?sl(E.size*Ia):0,A=t._rotate*-nl/180,I=g(t._pos*Ia),S=I+(V+v)*u;a=0==s?S:0,i=1==s?S:0,st(t.font[0],r,1==t.align?ha:2==t.align?da:A>0?ha:A<0?da:0==s?"center":3==l?da:ha,A||1==s?"middle":2==l?oa:ua);let T=t.font[1]*t.lineGap,C=y.map((e=>g(o(e,p,m,f)))),k=t._values;for(let e=0;e<k.length;e++){let t=k[e];if(null!=t){0==s?i=C[e]:a=C[e],t=""+t;let n=-1==t.indexOf("\n")?[t]:t.split(/\n/gm);for(let e=0;e<n.length;e++){let t=n[e];A?(c.save(),c.translate(i,a+e*T),c.rotate(A),c.fillText(t,0,0),c.restore()):c.fillText(t,i,a+e*T)}}}E.show&&ft(C,E.filter(n,b,e,d,x),s,l,I,V,Tl(E.width*Ia,3),E.stroke(n,e),E.dash,E.cap);let P=t.grid;P.show&&ft(C,P.filter(n,b,e,d,x),s,0==s?2:1,0==s?me:pe,0==s?ve:fe,Tl(P.width*Ia,3),P.stroke(n,e),P.dash,P.cap),U.show&&ft([I],[1],0==s?1:0,0==s?1:2,1==s?me:pe,1==s?ve:fe,Tl(U.width*Ia,3),U.stroke(n,e),U.dash,U.cap)}Ei("drawAxes")},series:function(){Be>0&&(b.forEach(((e,i)=>{if(i>0&&e.show&&(ut(i,!1),ut(i,!0),null==e._paths)){et!=e.alpha&&(c.globalAlpha=et=e.alpha);let l=2==a?[0,t[i][0].length-1]:function(e){let t=gl(je-1,0,Be-1),i=gl(We+1,0,Be-1);for(;null==e[t]&&t>0;)t--;for(;null==e[i]&&i<Be-1;)i++;return[t,i]}(t[i]);e._paths=e.paths(n,i,l[0],l[1]),1!=et&&(c.globalAlpha=et=1)}})),b.forEach(((e,t)=>{if(t>0&&e.show){et!=e.alpha&&(c.globalAlpha=et=e.alpha),null!=e._paths&&ht(t,!1);{let i=null!=e._paths?e._paths.gaps:null,a=e.points.show(n,t,je,We,i),l=e.points.filter(n,t,a,i);(a||l)&&(e.points._paths=e.points.paths(n,t,je,We,l),ht(t,!0))}1!=et&&(c.globalAlpha=et=1),Ei("drawSeries",t)}})))}},I=(e.drawOrder||["axes","series"]).map((e=>A[e]));function S(t){let i=_[t];if(null==i){let n=(e.scales||Ll)[t]||Ll;if(null!=n.from)S(n.from),_[t]=Yl({},_[n.from],n,{key:t});else{i=_[t]=Yl({},t==V?or:ur,n),i.key=t;let e=i.time,l=i.range,s=Rl(l);if((t!=V||2==a&&!e)&&(!s||null!=l[0]&&null!=l[1]||(l={min:null==l[0]?$a:{mode:1,hard:l[0],soft:l[0]},max:null==l[1]?$a:{mode:1,hard:l[1],soft:l[1]}},s=!1),!s&&Fl(l))){let e=l;l=(t,i,n)=>null==i?Ol:Ja(i,n,e)}i.range=yl(l||(e?Yr:t==V?3==i.distr?Hr:4==i.distr?qr:Wr:3==i.distr?Xr:4==i.distr?$r:Gr)),i.auto=yl(!s&&i.auto),i.clamp=yl(i.clamp||rr),i._min=i._max=null}}}S("x"),S("y"),1==a&&b.forEach((e=>{S(e.scale)})),w.forEach((e=>{S(e.scale)}));for(let t in e.scales)S(t);const T=_[V],C=T.distr;let k,P;0==T.ori?(Ta(h,"u-hz"),k=s,P=r):(Ta(h,"u-vt"),k=r,P=s);const L={};for(let e in _){let t=_[e];null==t.min&&null==t.max||(L[e]={min:t.min,max:t.max},t.min=t.max=null)}const M=e.tzDate||(e=>new Date(sl(e/y))),O=e.fmtDate||ts,R=1==y?ws(M):Vs(M),N=Is(M,As(1==y?Es:Us,O)),D=Cs(M,Ts("{YYYY}-{MM}-{DD} {h}:{mm}{aa}",O)),F=[],z=n.legend=Yl({},ks,e.legend),B=z.show,j=z.markers;let W,Y,G;z.idxs=F,j.width=yl(j.width),j.dash=yl(j.dash),j.stroke=yl(j.stroke),j.fill=yl(j.fill);let X,H=[],$=[],q=!1,Z={};if(z.live){const e=b[1]?b[1].values:null;q=null!=e,X=q?e(n,1,0):{_:0};for(let e in X)Z[e]=wa}if(B)if(W=Pa("table","u-legend",h),G=Pa("tbody",null,W),z.mount(n,W),q){Y=Pa("thead",null,W,G);let e=Pa("tr",null,Y);for(var J in Pa("th",null,e),X)Pa("th",la,e).textContent=J}else Ta(W,"u-inline"),z.live&&Ta(W,"u-live");const K={show:!0},Q={show:!1};const ee=new Map;function te(e,t,i,a=!0){const l=ee.get(t)||{},s=Ae.bind[e](n,t,i,a);s&&(ja(e,t,l[e]=s),ee.set(t,l))}function ie(e,t,i){const n=ee.get(t)||{};for(let i in n)null!=e&&i!=e||(Wa(i,t,n[i]),delete n[i]);null==e&&ee.delete(t)}let ne=0,ae=0,le=0,se=0,re=0,oe=0,ue=re,he=oe,de=le,ce=se,pe=0,me=0,fe=0,ve=0;n.bbox={};let ge=!1,ye=!1,be=!1,xe=!1,Ee=!1,we=!1;function _e(e,t,i){(i||e!=n.width||t!=n.height)&&Ue(e,t),yt(!1),be=!0,ye=!0,Ot()}function Ue(e,t){n.width=ne=le=e,n.height=ae=se=t,re=oe=0,function(){let e=!1,t=!1,i=!1,n=!1;w.forEach(((a,l)=>{if(a.show&&a._show){let{side:l,_size:s}=a,r=l%2,o=s+(null!=a.label?a.labelSize:0);o>0&&(r?(le-=o,3==l?(re+=o,n=!0):i=!0):(se-=o,0==l?(oe+=o,e=!0):t=!0))}})),Ne[0]=e,Ne[1]=i,Ne[2]=t,Ne[3]=n,le-=ze[1]+ze[3],re+=ze[3],se-=ze[2]+ze[0],oe+=ze[0]}(),function(){let e=re+le,t=oe+se,i=re,n=oe;function a(a,l){switch(a){case 1:return e+=l,e-l;case 2:return t+=l,t-l;case 3:return i-=l,i+l;case 0:return n-=l,n+l}}w.forEach(((e,t)=>{if(e.show&&e._show){let t=e.side;e._pos=a(t,e._size),null!=e.label&&(e._lpos=a(t,e.labelSize))}}))}();let i=n.bbox;pe=i.left=Al(re*Ia,.5),me=i.top=Al(oe*Ia,.5),fe=i.width=Al(le*Ia,.5),ve=i.height=Al(se*Ia,.5)}const Ve=3;n.setSize=function({width:e,height:t}){_e(e,t)};const Ae=n.cursor=Yl({},Os,{drag:{y:2==a}},e.cursor);if(null==Ae.dataIdx){let e=Ae.hover,i=e.skip=new Set(e.skip??[]);i.add(void 0);let n=e.prox=yl(e.prox),a=e.bias??=0;Ae.dataIdx=(e,l,s,r)=>{if(0==l)return s;let o=s,u=n(e,l,s,r)??fl,h=u>=0&&u<fl,d=0==T.ori?le:se,c=Ae.left,p=t[0],m=t[l];if(i.has(m[s])){o=null;let e,t=null,n=null;if(0==a||-1==a)for(e=s;null==t&&e-- >0;)i.has(m[e])||(t=e);if(0==a||1==a)for(e=s;null==n&&e++<m.length;)i.has(m[e])||(n=e);if(null!=t||null!=n)if(h){let e=c-(null==t?-1/0:k(p[t],T,d,0)),i=(null==n?1/0:k(p[n],T,d,0))-c;e<=i?e<=u&&(o=t):i<=u&&(o=n)}else o=null==n?t:null==t?n:s-t<=n-s?t:n}else if(h){al(c-k(p[s],T,d,0))>u&&(o=null)}return o}}const Ie=e=>{Ae.event=e};Ae.idxs=F,Ae._lock=!1;let Se=Ae.points;Se.show=yl(Se.show),Se.size=yl(Se.size),Se.stroke=yl(Se.stroke),Se.width=yl(Se.width),Se.fill=yl(Se.fill);const Te=n.focus=Yl({},e.focus||{alpha:.3},Ae.focus),Ce=Te.prox>=0,ke=Ce&&Se.one;let Pe=[],Le=[],Me=[];function Oe(e,t){let i=Se.show(n,t);if(i)return Ta(i,"u-cursor-pt"),Ta(i,e.class),Oa(i,-10,-10,le,se),f.insertBefore(i,Pe[t]),i}function Re(e,t){if(1==a||t>0){let t=1==a&&_[e.scale].time,i=e.value;e.value=t?Dl(i)?Cs(M,Ts(i,O)):i||D:i||tr,e.label=e.label||(t?"Time":"Value")}if(ke||t>0){e.width=null==e.width?1:e.width,e.paths=e.paths||Fr||El,e.fillTo=yl(e.fillTo||mr),e.pxAlign=+Ka(e.pxAlign,v),e.pxRound=yr(e.pxAlign),e.stroke=yl(e.stroke||null),e.fill=yl(e.fill||null),e._stroke=e._fill=e._paths=e._focus=null;let t=Tl((3+2*(ul(1,e.width)||1))*1,3),i=e.points=Yl({},{size:t,width:ul(1,.2*t),stroke:e.stroke,space:2*t,paths:zr,_stroke:null,_fill:null},e.points);i.show=yl(i.show),i.filter=yl(i.filter),i.fill=yl(i.fill),i.stroke=yl(i.stroke),i.paths=yl(i.paths),i.pxAlign=e.pxAlign}if(B){let i=function(e,t){if(0==t&&(q||!z.live||2==a))return Ol;let i=[],l=Pa("tr","u-series",G,G.childNodes[t]);Ta(l,e.class),e.show||Ta(l,aa);let s=Pa("th",null,l);if(j.show){let e=La("u-marker",s);if(t>0){let i=j.width(n,t);i&&(e.style.border=i+"px "+j.dash(n,t)+" "+j.stroke(n,t)),e.style.background=j.fill(n,t)}}let r=La(la,s);for(var o in r.textContent=e.label,t>0&&(j.show||(r.style.color=e.width>0?j.stroke(n,t):j.fill(n,t)),te("click",s,(t=>{if(Ae._lock)return;Ie(t);let i=b.indexOf(e);if((t.ctrlKey||t.metaKey)!=z.isolate){let e=b.some(((e,t)=>t>0&&t!=i&&e.show));b.forEach(((t,n)=>{n>0&&Xt(n,e?n==i?K:Q:K,!0,_i.setSeries)}))}else Xt(i,{show:!e.show},!0,_i.setSeries)}),!1),Ce&&te(ga,s,(t=>{Ae._lock||(Ie(t),Xt(b.indexOf(e),Zt,!0,_i.setSeries))}),!1)),X){let e=Pa("td","u-value",l);e.textContent="--",i.push(e)}return[l,i]}(e,t);H.splice(t,0,i[0]),$.splice(t,0,i[1]),z.values.push(null)}if(Ae.show){F.splice(t,0,null);let i=null;ke?0==t&&(i=Oe(e,t)):t>0&&(i=Oe(e,t)),Pe.splice(t,0,i),Le.splice(t,0,0),Me.splice(t,0,0)}Ei("addSeries",t)}n.addSeries=function(e,t){t=null==t?b.length:t,e=1==a?jr(e,t,Ws,sr):jr(e,t,{},lr),b.splice(t,0,e),Re(b[t],t)},n.delSeries=function(e){if(b.splice(e,1),B){z.values.splice(e,1),$.splice(e,1);let t=H.splice(e,1)[0];ie(null,t.firstChild),t.remove()}Ae.show&&(F.splice(e,1),Pe.splice(e,1)[0].remove(),Le.splice(e,1),Me.splice(e,1)),Ei("delSeries",e)};const Ne=[!1,!1,!1,!1];function De(e,t,i,n){let[a,l,s,r]=i,o=t%2,u=0;return 0==o&&(r||l)&&(u=0==t&&!a||2==t&&!s?sl(js.size/3):0),1==o&&(a||s)&&(u=1==t&&!l||3==t&&!r?sl(ir.size/2):0),u}const Fe=n.padding=(e.padding||[De,De,De,De]).map((e=>yl(Ka(e,De)))),ze=n._padding=Fe.map(((e,t)=>e(n,t,Ne,0)));let Be,je=null,We=null;const Ye=1==a?b[0].idxs:null;let Ge,Xe,He,$e,qe,Ze,Je,Ke,Qe,et,tt=null,it=!1;function nt(e,i){if(t=null==e?[]:e,n.data=n._data=t,2==a){Be=0;for(let e=1;e<b.length;e++)Be+=t[e][0].length}else{0==t.length&&(n.data=n._data=t=[[]]),tt=t[0],Be=tt.length;let e=t;if(2==C){e=t.slice();let i=e[0]=Array(Be);for(let e=0;e<Be;e++)i[e]=e}n._data=t=e}if(yt(!0),Ei("setData"),2==C&&(be=!0),!1!==i){let e=T;e.auto(n,it)?at():Gt(V,e.min,e.max),xe=xe||Ae.left>=0,we=!0,Ot()}}function at(){let e,i;it=!0,1==a&&(Be>0?(je=Ye[0]=0,We=Ye[1]=Be-1,e=t[0][je],i=t[0][We],2==C?(e=je,i=We):e==i&&(3==C?[e,i]=Xa(e,e,T.log,!1):4==C?[e,i]=Ha(e,e,T.log,!1):T.time?i=e+sl(86400/y):[e,i]=Ja(e,i,.1,!0))):(je=Ye[0]=e=null,We=Ye[1]=i=null)),Gt(V,e,i)}function lt(e,t,i,n,a,l){e??=pa,i??=Ml,n??="butt",a??=pa,l??="round",e!=Ge&&(c.strokeStyle=Ge=e),a!=Xe&&(c.fillStyle=Xe=a),t!=He&&(c.lineWidth=He=t),l!=qe&&(c.lineJoin=qe=l),n!=Ze&&(c.lineCap=Ze=n),i!=$e&&c.setLineDash($e=i)}function st(e,t,i,n){t!=Xe&&(c.fillStyle=Xe=t),e!=Je&&(c.font=Je=e),i!=Ke&&(c.textAlign=Ke=i),n!=Qe&&(c.textBaseline=Qe=n)}function rt(e,t,i,a,l=0){if(a.length>0&&e.auto(n,it)&&(null==t||null==t.min)){let t=Ka(je,0),n=Ka(We,a.length-1),s=null==i.min?3==e.distr?function(e,t,i){let n=fl,a=-fl;for(let l=t;l<=i;l++){let t=e[l];null!=t&&t>0&&(t<n&&(n=t),t>a&&(a=t))}return[n,a]}(a,t,n):function(e,t,i,n){let a=fl,l=-fl;if(1==n)a=e[t],l=e[i];else if(-1==n)a=e[i],l=e[t];else for(let n=t;n<=i;n++){let t=e[n];null!=t&&(t<a&&(a=t),t>l&&(l=t))}return[a,l]}(a,t,n,l):[i.min,i.max];e.min=ol(e.min,i.min=s[0]),e.max=ul(e.max,i.max=s[1])}}n.setData=nt;const ot={min:null,max:null};function ut(e,t){let i=t?b[e].points:b[e];i._stroke=i.stroke(n,e),i._fill=i.fill(n,e)}function ht(e,i){let a=i?b[e].points:b[e],{stroke:l,fill:s,clip:r,flags:o,_stroke:u=a._stroke,_fill:h=a._fill,_width:d=a.width}=a._paths;d=Tl(d*Ia,3);let p=null,m=d%2/2;i&&null==h&&(h=d>0?"#fff":u);let f=1==a.pxAlign&&m>0;if(f&&c.translate(m,m),!i){let e=pe-d/2,t=me-d/2,i=fe+d,n=ve+d;p=new Path2D,p.rect(e,t,i,n)}i?ct(u,d,a.dash,a.cap,h,l,s,o,r):function(e,i,a,l,s,r,o,u,h,d,c){let p=!1;0!=h&&U.forEach(((m,f)=>{if(m.series[0]==e){let e,v=b[m.series[1]],g=t[m.series[1]],y=(v._paths||Ll).band;Rl(y)&&(y=1==m.dir?y[0]:y[1]);let x=null;v.show&&y&&function(e,t,i){for(t=Ka(t,0),i=Ka(i,e.length-1);t<=i;){if(null!=e[t])return!0;t++}return!1}(g,je,We)?(x=m.fill(n,f)||r,e=v._paths.clip):y=null,ct(i,a,l,s,x,o,u,h,d,c,e,y),p=!0}})),p||ct(i,a,l,s,r,o,u,h,d,c)}(e,u,d,a.dash,a.cap,h,l,s,o,p,r),f&&c.translate(-m,-m)}const dt=3;function ct(e,t,i,n,a,l,s,r,o,u,h,d){lt(e,t,i,n,a),(o||u||d)&&(c.save(),o&&c.clip(o),u&&c.clip(u)),d?(r&dt)==dt?(c.clip(d),h&&c.clip(h),mt(a,s),pt(e,l,t)):2&r?(mt(a,s),c.clip(d),pt(e,l,t)):1&r&&(c.save(),c.clip(d),h&&c.clip(h),mt(a,s),c.restore(),pt(e,l,t)):(mt(a,s),pt(e,l,t)),(o||u||d)&&c.restore()}function pt(e,t,i){i>0&&(t instanceof Map?t.forEach(((e,t)=>{c.strokeStyle=Ge=t,c.stroke(e)})):null!=t&&e&&c.stroke(t))}function mt(e,t){t instanceof Map?t.forEach(((e,t)=>{c.fillStyle=Xe=t,c.fill(e)})):null!=t&&e&&c.fill(t)}function ft(e,t,i,n,a,l,s,r,o,u){let h=s%2/2;1==v&&c.translate(h,h),lt(r,s,o,u,r),c.beginPath();let d,p,m,f,g=a+(0==n||3==n?-l:l);0==i?(p=a,f=g):(d=a,m=g);for(let n=0;n<e.length;n++)null!=t[n]&&(0==i?d=m=e[n]:p=f=e[n],c.moveTo(d,p),c.lineTo(m,f));c.stroke(),1==v&&c.translate(-h,-h)}function vt(e){let t=!0;return w.forEach(((i,a)=>{if(!i.show)return;let l=_[i.scale];if(null==l.min)return void(i._show&&(t=!1,i._show=!1,yt(!1)));i._show||(t=!1,i._show=!0,yt(!1));let s=i.side,r=s%2,{min:o,max:u}=l,[h,d]=function(e,t,i,a){let l,s=w[e];if(a<=0)l=[0,0];else{let r=s._space=s.space(n,e,t,i,a);l=Zr(t,i,s._incrs=s.incrs(n,e,t,i,a,r),a,r)}return s._found=l}(a,o,u,0==r?le:se);if(0==d)return;let c=2==l.distr,p=i._splits=i.splits(n,a,o,u,h,d,c),m=2==l.distr?p.map((e=>tt[e])):p,f=2==l.distr?tt[p[1]]-tt[p[0]]:h,v=i._values=i.values(n,i.filter(n,m,a,d,f),a,d,f);i._rotate=2==s?i.rotate(n,v,a,d):0;let g=i._size;i._size=rl(i.size(n,v,a,e)),null!=g&&i._size!=g&&(t=!1)})),t}function gt(e){let t=!0;return Fe.forEach(((i,a)=>{let l=i(n,a,Ne,e);l!=ze[a]&&(t=!1),ze[a]=l})),t}function yt(e){b.forEach(((t,i)=>{i>0&&(t._paths=null,e&&(1==a?(t.min=null,t.max=null):t.facets.forEach((e=>{e.min=null,e.max=null}))))}))}let bt,xt,Et,wt,_t,Ut,Vt,At,It,St,Tt,Ct,kt=!1,Pt=!1,Lt=[];function Mt(){Pt=!1;for(let e=0;e<Lt.length;e++)Ei(...Lt[e]);Lt.length=0}function Ot(){kt||(Xl(Rt),kt=!0)}function Rt(){if(ge&&(!function(){for(let e in _){let t=_[e];null==L[e]&&(null==t.min||null!=L[V]&&t.auto(n,it))&&(L[e]=ot)}for(let e in _){let t=_[e];null==L[e]&&null!=t.from&&null!=L[t.from]&&(L[e]=ot)}null!=L[V]&&yt(!0);let e={};for(let t in L){let i=L[t];if(null!=i){let l=e[t]=Wl(_[t],zl);if(null!=i.min)Yl(l,i);else if(t!=V||2==a)if(0==Be&&null==l.from){let e=l.range(n,null,null,t);l.min=e[0],l.max=e[1]}else l.min=fl,l.max=-fl}}if(Be>0){b.forEach(((i,l)=>{if(1==a){let a=i.scale,s=L[a];if(null==s)return;let r=e[a];if(0==l){let e=r.range(n,r.min,r.max,a);r.min=e[0],r.max=e[1],je=Ya(r.min,t[0]),We=Ya(r.max,t[0]),We-je>1&&(t[0][je]<r.min&&je++,t[0][We]>r.max&&We--),i.min=tt[je],i.max=tt[We]}else i.show&&i.auto&&rt(r,s,i,t[l],i.sorted);i.idxs[0]=je,i.idxs[1]=We}else if(l>0&&i.show&&i.auto){let[n,a]=i.facets,s=n.scale,r=a.scale,[o,u]=t[l],h=e[s],d=e[r];null!=h&&rt(h,L[s],n,o,n.sorted),null!=d&&rt(d,L[r],a,u,a.sorted),i.min=a.min,i.max=a.max}}));for(let t in e){let i=e[t],a=L[t];if(null==i.from&&(null==a||null==a.min)){let e=i.range(n,i.min==fl?null:i.min,i.max==-fl?null:i.max,t);i.min=e[0],i.max=e[1]}}}for(let t in e){let i=e[t];if(null!=i.from){let a=e[i.from];if(null==a.min)i.min=i.max=null;else{let e=i.range(n,a.min,a.max,t);i.min=e[0],i.max=e[1]}}}let i={},l=!1;for(let t in e){let n=e[t],a=_[t];if(a.min!=n.min||a.max!=n.max){a.min=n.min,a.max=n.max;let e=a.distr;a._min=3==e?cl(a.min):4==e?ml(a.min,a.asinh):100==e?a.fwd(a.min):a.min,a._max=3==e?cl(a.max):4==e?ml(a.max,a.asinh):100==e?a.fwd(a.max):a.max,i[t]=l=!0}}if(l){b.forEach(((e,t)=>{2==a?t>0&&i.y&&(e._paths=null):i[e.scale]&&(e._paths=null)}));for(let e in i)be=!0,Ei("setScale",e);Ae.show&&Ae.left>=0&&(xe=we=!0)}for(let e in L)L[e]=null}(),ge=!1),be&&(!function(){let e=!1,t=0;for(;!e;){t++;let i=vt(t),a=gt(t);e=t==Ve||i&&a,e||(Ue(n.width,n.height),ye=!0)}}(),be=!1),ye){if(ka(m,ha,re),ka(m,oa,oe),ka(m,sa,le),ka(m,ra,se),ka(f,ha,re),ka(f,oa,oe),ka(f,sa,le),ka(f,ra,se),ka(p,sa,ne),ka(p,ra,ae),d.width=sl(ne*Ia),d.height=sl(ae*Ia),w.forEach((({_el:e,_show:t,_size:i,_pos:n,side:a})=>{if(null!=e)if(t){let t=a%2==1;ka(e,t?"left":"top",n-(3===a||0===a?i:0)),ka(e,t?"width":"height",i),ka(e,t?"top":"left",t?oe:re),ka(e,t?"height":"width",t?se:le),Ca(e,aa)}else Ta(e,aa)})),Ge=Xe=He=qe=Ze=Je=Ke=Qe=$e=null,et=1,si(!0),re!=ue||oe!=he||le!=de||se!=ce){yt(!1);let e=le/de,t=se/ce;if(Ae.show&&!xe&&Ae.left>=0){Ae.left*=e,Ae.top*=t,Et&&Oa(Et,sl(Ae.left),0,le,se),wt&&Oa(wt,0,sl(Ae.top),le,se);for(let i=0;i<Pe.length;i++){let n=Pe[i];null!=n&&(Le[i]*=e,Me[i]*=t,Oa(n,rl(Le[i]),rl(Me[i]),le,se))}}if(jt.show&&!Ee&&jt.left>=0&&jt.width>0){jt.left*=e,jt.width*=e,jt.top*=t,jt.height*=t;for(let e in ui)ka(Wt,e,jt[e])}ue=re,he=oe,de=le,ce=se}Ei("setSize"),ye=!1}ne>0&&ae>0&&(c.clearRect(0,0,d.width,d.height),Ei("drawClear"),I.forEach((e=>e())),Ei("draw")),jt.show&&Ee&&(Yt(jt),Ee=!1),Ae.show&&xe&&(ai(null,!0,!1),xe=!1),z.show&&z.live&&we&&(ii(),we=!1),u||(u=!0,n.status=1,Ei("ready")),it=!1,kt=!1}function Nt(e,i){let a=_[e];if(null==a.from){if(0==Be){let t=a.range(n,i.min,i.max,e);i.min=t[0],i.max=t[1]}if(i.min>i.max){let e=i.min;i.min=i.max,i.max=e}if(Be>1&&null!=i.min&&null!=i.max&&i.max-i.min<1e-16)return;e==V&&2==a.distr&&Be>0&&(i.min=Ya(i.min,t[0]),i.max=Ya(i.max,t[0]),i.min==i.max&&i.max++),L[e]=i,ge=!0,Ot()}}n.batch=function(e,t=!1){kt=!0,Pt=t,e(n),Rt(),t&&Lt.length>0&&queueMicrotask(Mt)},n.redraw=(e,t)=>{be=t||!1,!1!==e?Gt(V,T.min,T.max):Ot()},n.setScale=Nt;let Dt=!1;const Ft=Ae.drag;let zt=Ft.x,Bt=Ft.y;Ae.show&&(Ae.x&&(bt=La("u-cursor-x",f)),Ae.y&&(xt=La("u-cursor-y",f)),0==T.ori?(Et=bt,wt=xt):(Et=xt,wt=bt),Tt=Ae.left,Ct=Ae.top);const jt=n.select=Yl({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),Wt=jt.show?La("u-select",jt.over?f:m):null;function Yt(e,t){if(jt.show){for(let t in e)jt[t]=e[t],t in ui&&ka(Wt,t,e[t]);!1!==t&&Ei("setSelect")}}function Gt(e,t,i){Nt(e,{min:t,max:i})}function Xt(e,t,i,l){null!=t.focus&&function(e){if(e!=qt){let t=null==e,i=1!=Te.alpha;b.forEach(((n,l)=>{if(1==a||l>0){let a=t||0==l||l==e;n._focus=t?null:a,i&&function(e,t){b[e].alpha=t,Ae.show&&Pe[e]&&(Pe[e].style.opacity=t);B&&H[e]&&(H[e].style.opacity=t)}(l,a?1:Te.alpha)}})),qt=e,i&&Ot()}}(e),null!=t.show&&b.forEach(((i,n)=>{n>0&&(e==n||null==e)&&(i.show=t.show,function(e){let t=b[e],i=B?H[e]:null;t.show?i&&Ca(i,aa):(i&&Ta(i,aa),Oa(ke?Pe[0]:Pe[e],-10,-10,le,se))}(n,t.show),2==a?(Gt(i.facets[0].scale,null,null),Gt(i.facets[1].scale,null,null)):Gt(i.scale,null,null),Ot())})),!1!==i&&Ei("setSeries",e,t),l&&Ai("setSeries",n,e,t)}let Ht,$t,qt;n.setSelect=Yt,n.setSeries=Xt,n.addBand=function(e,t){e.fill=yl(e.fill||null),e.dir=Ka(e.dir,-1),t=null==t?U.length:t,U.splice(t,0,e)},n.setBand=function(e,t){Yl(U[e],t)},n.delBand=function(e){null==e?U.length=0:U.splice(e,1)};const Zt={focus:!0};function Jt(e,t,i){let n=_[t];i&&(e=e/Ia-(1==n.ori?oe:re));let a=le;1==n.ori&&(a=se,e=a-e),-1==n.dir&&(e=a-e);let l=n._min,s=l+(n._max-l)*(e/a),r=n.distr;return 3==r?hl(10,s):4==r?((e,t=1)=>il.sinh(e)*t)(s,n.asinh):100==r?n.bwd(s):s}function Kt(e,t){ka(Wt,ha,jt.left=e),ka(Wt,sa,jt.width=t)}function Qt(e,t){ka(Wt,oa,jt.top=e),ka(Wt,ra,jt.height=t)}B&&Ce&&te(ya,W,(e=>{Ae._lock||(Ie(e),null!=qt&&Xt(null,Zt,!0,_i.setSeries))})),n.valToIdx=e=>Ya(e,t[0]),n.posToIdx=function(e,i){return Ya(Jt(e,V,i),t[0],je,We)},n.posToVal=Jt,n.valToPos=(e,t,i)=>0==_[t].ori?s(e,_[t],i?fe:le,i?pe:0):r(e,_[t],i?ve:se,i?me:0),n.setCursor=(e,t,i)=>{Tt=e.left,Ct=e.top,ai(null,t,i)};let ei=0==T.ori?Kt:Qt,ti=1==T.ori?Kt:Qt;function ii(e,t){if(null!=e&&(e.idxs?e.idxs.forEach(((e,t)=>{F[t]=e})):void 0!==e.idx&&F.fill(e.idx),z.idx=F[0]),B&&z.live){for(let e=0;e<b.length;e++)(e>0||1==a&&!q)&&ni(e,F[e]);!function(){if(B&&z.live)for(let e=2==a?1:0;e<b.length;e++){if(0==e&&q)continue;let t=z.values[e],i=0;for(let n in t)$[e][i++].firstChild.nodeValue=t[n]}}()}we=!1,!1!==t&&Ei("setLegend")}function ni(e,i){let a,l=b[e],s=0==e&&2==C?tt:t[e];q?a=l.values(n,e,i)??Z:(a=l.value(n,null==i?null:s[i],e,i),a=null==a?Z:{_:a}),z.values[e]=a}function ai(e,i,l){let s;It=Tt,St=Ct,[Tt,Ct]=Ae.move(n,Tt,Ct),Ae.left=Tt,Ae.top=Ct,Ae.show&&(Et&&Oa(Et,sl(Tt),0,le,se),wt&&Oa(wt,0,sl(Ct),le,se));let r=je>We;Ht=fl,$t=null;let o=0==T.ori?le:se,u=1==T.ori?le:se;if(Tt<0||0==Be||r){s=Ae.idx=null;for(let e=0;e<b.length;e++){let t=Pe[e];null!=t&&Oa(t,-10,-10,le,se)}Ce&&Xt(null,Zt,!0,null==e&&_i.setSeries),z.live&&(F.fill(s),we=!0)}else{let e,i,l;1==a&&(e=0==T.ori?Tt:Ct,i=Jt(e,V),s=Ae.idx=Ya(i,t[0],je,We),l=k(t[0][s],T,o,0));let r=-10,h=-10,d=0,c=0,p=!0,m="",f="";for(let e=2==a?1:0;e<b.length;e++){let v=b[e],g=F[e],y=null==g?null:1==a?t[e][g]:t[e][1][g],x=Ae.dataIdx(n,e,s,i),E=null==x?null:1==a?t[e][x]:t[e][1][x];we=we||E!=y||x!=g,F[e]=x;let w=x==s?l:k(1==a?t[0][x]:t[e][0][x],T,o,0);if(e>0&&v.show){let t=null==E?-10:P(E,1==a?_[v.scale]:_[v.facets[1].scale],u,0);if(Ce&&null!=E){let i=1==T.ori?Tt:Ct,a=al(Te.dist(n,e,x,t,i));if(a<Ht){let t=Te.bias;if(0!=t){let n=Jt(i,v.scale),l=n>=0?1:-1;l==(E>=0?1:-1)&&(1==l?1==t?E>=n:E<=n:1==t?E<=n:E>=n)&&(Ht=a,$t=e)}else Ht=a,$t=e}}if(we||ke){let i,a;0==T.ori?(i=w,a=t):(i=t,a=w);let l,s,o,u,v,g,y=!0,b=Se.bbox;if(null!=b){y=!1;let t=b(n,e);o=t.left,u=t.top,l=t.width,s=t.height}else o=i,u=a,l=s=Se.size(n,e);if(g=Se.fill(n,e),v=Se.stroke(n,e),ke)e==$t&&Ht<=Te.prox&&(r=o,h=u,d=l,c=s,p=y,m=g,f=v);else{let t=Pe[e];null!=t&&(Le[e]=o,Me[e]=u,Fa(t,l,s,y),Na(t,g,v),Oa(t,rl(o),rl(u),le,se))}}}}if(ke){let e=Te.prox;if(we||(null==qt?Ht<=e:Ht>e||$t!=qt)){let e=Pe[0];Le[0]=r,Me[0]=h,Fa(e,d,c,p),Na(e,m,f),Oa(e,rl(r),rl(h),le,se)}}}if(jt.show&&Dt)if(null!=e){let[t,i]=_i.scales,[n,a]=_i.match,[l,s]=e.cursor.sync.scales,r=e.cursor.drag;if(zt=r._x,Bt=r._y,zt||Bt){let r,h,d,c,p,{left:m,top:f,width:v,height:g}=e.select,y=e.scales[l].ori,b=e.posToVal,x=null!=t&&n(t,l),E=null!=i&&a(i,s);x&&zt?(0==y?(r=m,h=v):(r=f,h=g),d=_[t],c=k(b(r,l),d,o,0),p=k(b(r+h,l),d,o,0),ei(ol(c,p),al(p-c))):ei(0,o),E&&Bt?(1==y?(r=m,h=v):(r=f,h=g),d=_[i],c=P(b(r,s),d,u,0),p=P(b(r+h,s),d,u,0),ti(ol(c,p),al(p-c))):ti(0,u)}else hi()}else{let e=al(It-_t),t=al(St-Ut);if(1==T.ori){let i=e;e=t,t=i}zt=Ft.x&&e>=Ft.dist,Bt=Ft.y&&t>=Ft.dist;let i,n,a=Ft.uni;null!=a?zt&&Bt&&(zt=e>=a,Bt=t>=a,zt||Bt||(t>e?Bt=!0:zt=!0)):Ft.x&&Ft.y&&(zt||Bt)&&(zt=Bt=!0),zt&&(0==T.ori?(i=Vt,n=Tt):(i=At,n=Ct),ei(ol(i,n),al(n-i)),Bt||ti(0,u)),Bt&&(1==T.ori?(i=Vt,n=Tt):(i=At,n=Ct),ti(ol(i,n),al(n-i)),zt||ei(0,o)),zt||Bt||(ei(0,0),ti(0,0))}if(Ft._x=zt,Ft._y=Bt,null==e){if(l){if(null!=Ui){let[e,t]=_i.scales;_i.values[0]=null!=e?Jt(0==T.ori?Tt:Ct,e):null,_i.values[1]=null!=t?Jt(1==T.ori?Tt:Ct,t):null}Ai(ma,n,Tt,Ct,le,se,s)}if(Ce){let e=l&&_i.setSeries,t=Te.prox;null==qt?Ht<=t&&Xt($t,Zt,!0,e):Ht>t?Xt(null,Zt,!0,e):$t!=qt&&Xt($t,Zt,!0,e)}}we&&(z.idx=s,ii()),!1!==i&&Ei("setCursor")}n.setLegend=ii;let li=null;function si(e=!1){e?li=null:(li=f.getBoundingClientRect(),Ei("syncRect",li))}function ri(e,t,i,n,a,l,s){Ae._lock||Dt&&null!=e&&0==e.movementX&&0==e.movementY||(oi(e,t,i,n,a,l,s,!1,null!=e),null!=e?ai(null,!0,!0):ai(t,!0,!1))}function oi(e,t,i,a,l,s,r,u,h){if(null==li&&si(!1),Ie(e),null!=e)i=e.clientX-li.left,a=e.clientY-li.top;else{if(i<0||a<0)return Tt=-10,void(Ct=-10);let[e,n]=_i.scales,r=t.cursor.sync,[u,h]=r.values,[d,c]=r.scales,[p,m]=_i.match,f=t.axes[0].side%2==1,v=0==T.ori?le:se,g=1==T.ori?le:se,y=f?s:l,b=f?l:s,x=f?a:i,E=f?i:a;if(i=null!=d?p(e,d)?o(u,_[e],v,0):-10:v*(x/y),a=null!=c?m(n,c)?o(h,_[n],g,0):-10:g*(E/b),1==T.ori){let e=i;i=a,a=e}}h&&((i<=1||i>=le-1)&&(i=Al(i,le)),(a<=1||a>=se-1)&&(a=Al(a,se))),u?(_t=i,Ut=a,[Vt,At]=Ae.move(n,i,a)):(Tt=i,Ct=a)}Object.defineProperty(n,"rect",{get:()=>(null==li&&si(!1),li)});const ui={width:0,height:0,left:0,top:0};function hi(){Yt(ui,!1)}let di,ci,pi,mi;function fi(e,t,i,a,l,s,r){Dt=!0,zt=Bt=Ft._x=Ft._y=!1,oi(e,t,i,a,l,s,0,!0,!1),null!=e&&(te(va,Ua,vi,!1),Ai(fa,n,Vt,At,le,se,null));let{left:o,top:u,width:h,height:d}=jt;di=o,ci=u,pi=h,mi=d,hi()}function vi(e,t,i,a,l,s,r){Dt=Ft._x=Ft._y=!1,oi(e,t,i,a,l,s,0,!1,!0);let{left:o,top:u,width:h,height:d}=jt,c=h>0||d>0,p=di!=o||ci!=u||pi!=h||mi!=d;if(c&&p&&Yt(jt),Ft.setScale&&c&&p){let e=o,t=h,i=u,n=d;if(1==T.ori&&(e=u,t=d,i=o,n=h),zt&&Gt(V,Jt(e,V),Jt(e+t,V)),Bt)for(let e in _){let t=_[e];e!=V&&null==t.from&&t.min!=fl&&Gt(e,Jt(i+n,e),Jt(i,e))}hi()}else Ae.lock&&(Ae._lock=!Ae._lock,ai(null,!0,!1));null!=e&&(ie(va,Ua),Ai(va,n,Tt,Ct,le,se,null))}function gi(e,t,i,a,l,s,r){Ae._lock||(Ie(e),at(),hi(),null!=e&&Ai(ba,n,Tt,Ct,le,se,null))}function yi(){w.forEach(Kr),_e(n.width,n.height,!0)}ja(Ea,Va,yi);const bi={};bi.mousedown=fi,bi.mousemove=ri,bi.mouseup=vi,bi.dblclick=gi,bi.setSeries=(e,t,i,a)=>{-1!=(i=(0,_i.match[2])(n,t,i))&&Xt(i,a,!0,!1)},Ae.show&&(te(fa,f,fi),te(ma,f,ri),te(ga,f,(e=>{Ie(e),si(!1)})),te(ya,f,(function(e,t,i,n,a,l,s){if(Ae._lock)return;Ie(e);let r=Dt;if(Dt){let e,t,i=!0,n=!0,a=10;0==T.ori?(e=zt,t=Bt):(e=Bt,t=zt),e&&t&&(i=Tt<=a||Tt>=le-a,n=Ct<=a||Ct>=se-a),e&&i&&(Tt=Tt<Vt?0:le),t&&n&&(Ct=Ct<At?0:se),ai(null,!0,!0),Dt=!1}Tt=-10,Ct=-10,ai(null,!0,!0),r&&(Dt=r)})),te(ba,f,gi),Nr.add(n),n.syncRect=si);const xi=n.hooks=e.hooks||{};function Ei(e,t,i){Pt?Lt.push([e,t,i]):e in xi&&xi[e].forEach((e=>{e.call(null,n,t,i)}))}(e.plugins||[]).forEach((e=>{for(let t in e.hooks)xi[t]=(xi[t]||[]).concat(e.hooks[t])}));const wi=(e,t,i)=>i,_i=Yl({key:null,setSeries:!1,filters:{pub:wl,sub:wl},scales:[V,b[1]?b[1].scale:null],match:[_l,_l,wi],values:[null,null]},Ae.sync);2==_i.match.length&&_i.match.push(wi),Ae.sync=_i;const Ui=_i.key,Vi=dr(Ui);function Ai(e,t,i,n,a,l,s){_i.filters.pub(e,t,i,n,a,l,s)&&Vi.pub(e,t,i,n,a,l,s)}function Ii(){Ei("init",e,t),nt(t||e.data,!1),L[V]?Nt(V,L[V]):at(),Ee=jt.show&&(jt.width>0||jt.height>0),xe=we=!0,_e(e.width,e.height)}return Vi.sub(n),n.pub=function(e,t,i,n,a,l,s){_i.filters.sub(e,t,i,n,a,l,s)&&bi[e](null,t,i,n,a,l,s)},n.destroy=function(){Vi.unsub(n),Nr.delete(n),ee.clear(),Wa(Ea,Va,yi),h.remove(),W?.remove(),Ei("destroy")},b.forEach(Re),w.forEach((function(e,t){if(e._show=e.show,e.show){let i=e.side%2,a=_[e.scale];null==a&&(e.scale=i?b[1].scale:V,a=_[e.scale]);let l=a.time;e.size=yl(e.size),e.space=yl(e.space),e.rotate=yl(e.rotate),Rl(e.incrs)&&e.incrs.forEach((e=>{!Cl.has(e)&&Cl.set(e,kl(e))})),e.incrs=yl(e.incrs||(2==a.distr?rs:l?1==y?xs:_s:os)),e.splits=yl(e.splits||(l&&1==a.distr?R:3==a.distr?Xs:4==a.distr?Hs:Gs)),e.stroke=yl(e.stroke),e.grid.stroke=yl(e.grid.stroke),e.ticks.stroke=yl(e.ticks.stroke),e.border.stroke=yl(e.border.stroke);let s=e.values;e.values=Rl(s)&&!Rl(s[0])?yl(s):l?Rl(s)?Is(M,As(s,O)):Dl(s)?function(e,t){let i=ts(t);return(t,n,a,l,s)=>n.map((t=>i(e(t))))}(M,s):s||N:s||Ys,e.filter=yl(e.filter||(a.distr>=3&&10==a.log?Qs:3==a.distr&&2==a.log?er:xl)),e.font=Jr(e.font),e.labelFont=Jr(e.labelFont),e._size=e.size(n,null,t,0),e._space=e._rotate=e._incrs=e._found=e._splits=e._values=null,e._size>0&&(Ne[t]=!0,e._el=La("u-axis",p))}})),i?i instanceof HTMLElement?(i.appendChild(h),Ii()):i(n,Ii):Ii(),n}Qr.assign=Yl,Qr.fmtNum=tl,Qr.rangeNum=Ja,Qr.rangeLog=Xa,Qr.rangeAsinh=Ha,Qr.orient=cr,Qr.pxRatio=Ia,Qr.join=function(e,t){if(function(e){let t=e[0][0],i=t.length;for(let n=1;n<e.length;n++){let a=e[n][0];if(a.length!=i)return!1;if(a!=t)for(let e=0;e<i;e++)if(a[e]!=t[e])return!1}return!0}(e)){let t=e[0].slice();for(let i=1;i<e.length;i++)t.push(...e[i].slice(1));return function(e,t=100){const i=e.length;if(i<=1)return!0;let n=0,a=i-1;for(;n<=a&&null==e[n];)n++;for(;a>=n&&null==e[a];)a--;if(a<=n)return!0;const l=ul(1,ll((a-n+1)/t));for(let t=e[n],i=n+l;i<=a;i+=l){const n=e[i];if(null!=n){if(n<=t)return!1;t=n}}return!0}(t[0])||(t=function(e){let t=e[0],i=t.length,n=Array(i);for(let e=0;e<n.length;e++)n[e]=e;n.sort(((e,i)=>t[e]-t[i]));let a=[];for(let t=0;t<e.length;t++){let l=e[t],s=Array(i);for(let e=0;e<i;e++)s[e]=l[n[e]];a.push(s)}return a}(t)),t}let i=new Set;for(let t=0;t<e.length;t++){let n=e[t][0],a=n.length;for(let e=0;e<a;e++)i.add(n[e])}let n=[Array.from(i).sort(((e,t)=>e-t))],a=n[0].length,l=new Map;for(let e=0;e<a;e++)l.set(n[0][e],e);for(let i=0;i<e.length;i++){let s=e[i],r=s[0];for(let e=1;e<s.length;e++){let o=s[e],u=Array(a).fill(void 0),h=t?t[i][e]:1,d=[];for(let e=0;e<o.length;e++){let t=o[e],i=l.get(r[e]);null===t?0!=h&&(u[i]=t,2==h&&d.push(i)):u[i]=t}Gl(u,d,a),n.push(u)}}return n},Qr.fmtDate=ts,Qr.tzDate=function(e,t){let i;return"UTC"==t||"Etc/UTC"==t?i=new Date(+e+6e4*e.getTimezoneOffset()):t==is?i=e:(i=new Date(e.toLocaleString("en-US",{timeZone:t})),i.setMilliseconds(e.getMilliseconds())),i},Qr.sync=dr;{Qr.addGap=function(e,t,i){let n=e[e.length-1];n&&n[0]==t?n[1]=i:e.push([t,i])},Qr.clipGaps=vr;let e=Qr.paths={points:Cr};e.linear=Mr,e.stepped=function(e){const t=Ka(e.align,1),i=Ka(e.ascDesc,!1),n=Ka(e.alignGaps,0),a=Ka(e.extend,!1);return(e,l,s,r)=>cr(e,l,((o,u,h,d,c,p,m,f,v,g,y)=>{let b=o.pxRound,{left:x,width:E}=e.bbox,w=e=>b(p(e,d,g,f)),_=e=>b(m(e,c,y,v)),U=0==d.ori?wr:_r;const V={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},A=V.stroke,I=d.dir*(0==d.ori?1:-1);s=Ga(h,s,r,1),r=Ga(h,s,r,-1);let S=_(h[1==I?s:r]),T=w(u[1==I?s:r]),C=T,k=T;a&&-1==t&&(k=x,U(A,k,S)),U(A,T,S);for(let e=1==I?s:r;e>=s&&e<=r;e+=I){let i=h[e];if(null==i)continue;let n=w(u[e]),a=_(i);1==t?U(A,n,S):U(A,C,a),U(A,n,a),S=a,C=n}let P=C;a&&1==t&&(P=x+E,U(A,P,S));let[L,M]=pr(e,l);if(null!=o.fill||0!=L){let t=V.fill=new Path2D(A),i=_(o.fillTo(e,l,o.min,o.max,L));U(t,P,i),U(t,k,i)}if(!o.spanGaps){let a=[];a.push(...gr(u,h,s,r,I,w,n));let c=o.width*Ia/2,p=i||1==t?c:-c,m=i||-1==t?-c:c;a.forEach((e=>{e[0]+=p,e[1]+=m})),V.gaps=a=o.gaps(e,l,s,r,a),V.clip=vr(a,d.ori,f,v,g,y)}return 0!=M&&(V.band=2==M?[fr(e,l,s,r,A,-1),fr(e,l,s,r,A,1)]:fr(e,l,s,r,A,M)),V}))},e.bars=function(e){const t=Ka((e=e||Ll).size,[.6,fl,1]),i=e.align||0,n=e.gap||0;let a=e.radius;a=null==a?[0,0]:"number"==typeof a?[a,0]:a;const l=yl(a),s=1-t[0],r=Ka(t[1],fl),o=Ka(t[2],1),u=Ka(e.disp,Ll),h=Ka(e.each,(e=>{})),{fill:d,stroke:c}=u;return(e,t,a,p)=>cr(e,t,((m,f,v,g,y,b,x,E,w,_,U)=>{let V,A,I=m.pxRound,S=i,T=n*Ia,C=r*Ia,k=o*Ia;0==g.ori?[V,A]=l(e,t):[A,V]=l(e,t);const P=g.dir*(0==g.ori?1:-1);let L,M,O,R=0==g.ori?Ur:Vr,N=0==g.ori?h:(e,t,i,n,a,l,s)=>{h(e,t,i,a,n,s,l)},D=Ka(e.bands,Ml).find((e=>e.series[0]==t)),F=null!=D?D.dir:0,z=m.fillTo(e,t,m.min,m.max,F),B=I(x(z,y,U,w)),j=_,W=I(m.width*Ia),Y=!1,G=null,X=null,H=null,$=null;null==d||0!=W&&null==c||(Y=!0,G=d.values(e,t,a,p),X=new Map,new Set(G).forEach((e=>{null!=e&&X.set(e,new Path2D)})),W>0&&(H=c.values(e,t,a,p),$=new Map,new Set(H).forEach((e=>{null!=e&&$.set(e,new Path2D)}))));let{x0:q,size:Z}=u;if(null!=q&&null!=Z){S=1,f=q.values(e,t,a,p),2==q.unit&&(f=f.map((t=>e.posToVal(E+t*_,g.key,!0))));let i=Z.values(e,t,a,p);M=2==Z.unit?i[0]*_:b(i[0],g,_,E)-b(0,g,_,E),j=Or(f,v,b,g,_,E,j),O=j-M+T}else j=Or(f,v,b,g,_,E,j),O=j*s+T,M=j-O;O<1&&(O=0),W>=M/2&&(W=0),O<5&&(I=bl);let J=O>0;M=I(gl(j-O-(J?W:0),k,C)),L=(0==S?M/2:S==P?0:M)-S*P*((0==S?T/2:0)+(J?W/2:0));const K={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},Q=Y?null:new Path2D;let ee=null;if(null!=D)ee=e.data[D.series[1]];else{let{y0:i,y1:n}=u;null!=i&&null!=n&&(v=n.values(e,t,a,p),ee=i.values(e,t,a,p))}let te=V*M,ie=A*M;for(let i=1==P?a:p;i>=a&&i<=p;i+=P){let n=v[i];if(null==n)continue;if(null!=ee){let e=ee[i]??0;if(n-e==0)continue;B=x(e,y,U,w)}let a=b(2!=g.distr||null!=u?f[i]:i,g,_,E),l=x(Ka(n,z),y,U,w),s=I(a-L),r=I(ul(l,B)),o=I(ol(l,B)),h=r-o;if(null!=n){let a=n<0?ie:te,l=n<0?te:ie;Y?(W>0&&null!=H[i]&&R($.get(H[i]),s,o+ll(W/2),M,ul(0,h-W),a,l),null!=G[i]&&R(X.get(G[i]),s,o+ll(W/2),M,ul(0,h-W),a,l)):R(Q,s,o+ll(W/2),M,ul(0,h-W),a,l),N(e,t,i,s-W/2,o,M+W,h)}}return W>0?K.stroke=Y?$:Q:Y||(K._fill=0==m.width?m._fill:m._stroke??m._fill,K.width=0),K.fill=Y?X:Q,K}))},e.spline=function(e){return function(e,t){const i=Ka(t?.alignGaps,0);return(t,n,a,l)=>cr(t,n,((s,r,o,u,h,d,c,p,m,f,v)=>{let g,y,b,x=s.pxRound,E=e=>x(d(e,u,f,p)),w=e=>x(c(e,h,v,m));0==u.ori?(g=xr,b=wr,y=Sr):(g=Er,b=_r,y=Tr);const _=u.dir*(0==u.ori?1:-1);a=Ga(o,a,l,1),l=Ga(o,a,l,-1);let U=E(r[1==_?a:l]),V=U,A=[],I=[];for(let e=1==_?a:l;e>=a&&e<=l;e+=_)if(null!=o[e]){let t=E(r[e]);A.push(V=t),I.push(w(o[e]))}const S={stroke:e(A,I,g,b,y,x),fill:null,clip:null,band:null,gaps:null,flags:1},T=S.stroke;let[C,k]=pr(t,n);if(null!=s.fill||0!=C){let e=S.fill=new Path2D(T),i=w(s.fillTo(t,n,s.min,s.max,C));b(e,V,i),b(e,U,i)}if(!s.spanGaps){let e=[];e.push(...gr(r,o,a,l,_,E,i)),S.gaps=e=s.gaps(t,n,a,l,e),S.clip=vr(e,u.ori,p,m,f,v)}return 0!=k&&(S.band=2==k?[fr(t,n,a,l,T,-1),fr(t,n,a,l,T,1)]:fr(t,n,a,l,T,k)),S}))}(Rr,e)}}class UIPlot_Variable extends UITemplate{static template='<div data-element="variable"></div><div data-element="min"></div><div data-element="max"></div>';variable=new UIParameterWithUnit;min=new UINumberWithUnit;max=new UINumberWithUnit;get valueUnit(){return this.variable.unit}get displayUnit(){return this.variable.displayUnit}set displayUnit(e){this.variable.displayUnit=e}constructor(e){let t,i;super(),this.min.unitHidden=!0,this.max.unitHidden=!0,this.variable.addEventListener("change",(()=>{if(t!=this.displayUnit&&(t=this.displayUnit,this.min.displayUnit=this.displayUnit,this.max.displayUnit=this.displayUnit),this.RegisterVariables(),i!=this.valueUnit){i=this.valueUnit,this.min.valueUnit=this.valueUnit,this.max.valueUnit=this.valueUnit;let e=qn(this.valueUnit);this.min.value=e?.min??this.min.value,this.max.value=e?.max??this.max.value}})),this.Setup(e)}RegisterVariables(){let e=Dashboard.thisDashboard.options.map((e=>e.group&&e.options?{...e,options:e.options.map((e=>({...e,disabled:!e.disabled})))}:{...e,disabled:!e.disabled}));this.variable.options=e}}customElements.define("ui-plot-variable",UIPlot_Variable,{extends:"span"});class UIPlot extends UITemplate{static template='<div data-element="plotWorkspace"></div>';variablesToPlot=new ConfigList({itemConstructor:UIPlot_Variable});constructor(e){super(),this.plotWorkspace=document.createElement("div");const t={title:"Real-Time Data",id:"realtimeChart",width:800,height:400,scales:{x:{}},series:[{}],axes:[{stroke:"#fff",grid:{show:!0}},{stroke:"#fff",grid:{show:!0}}]};this.plot=new Qr(t,[],this.plotWorkspace),this.plot.options=t,this.configDialog=new UIDialog({title:"Edit Plot"}),this.configDialog.content.append(this.variablesToPlot),this.plotWorkspace.addEventListener("click",(()=>{this.configDialog.show()})),this.variablesToPlot.addEventListener("change",(()=>{this.RegisterVariables();const e=[...this.variablesToPlot.children].map((e=>({name:`${e.item.variable.displayUnit}`,valueUnit:e.item.variable.valueUnit,displayUnit:e.item.variable.displayUnit,min:e.item.min.displayValue,max:e.item.max.displayValue}))).reduce(((e,t)=>(e[t.name]={auto:!1,range:[Math.min(Kn(t.min,t.valueUnit,t.displayUnit)??1/0,e[t.name]?.range?.[0]??1/0),Math.max(Kn(t.max,t.valueUnit,t.displayUnit)??-1/0,e[t.name]?.range?.[1]??-1/0)]},e)),{}),t=[{},...[...this.variablesToPlot.children].map((e=>{const t=e.item.value,i=t?.variable;if(void 0!==i)return{label:i.name,stroke:"blue",scale:`${e.item.variable.displayUnit}`,width:2}})).filter((e=>void 0!==e))],i={...this.plot.options,series:t,scales:{x:{},...e},axes:[{stroke:"#fff",grid:{show:!0}},...Object.keys(e).filter((e=>void 0!==e)).map((e=>({scale:`${e}`,stroke:"#fff",grid:{show:!0},values:(t,i)=>i.map((t=>t+e))})))]};this.plot.destroy(),delete this.plot,this.plot=new Qr(i,[],this.plotWorkspace),this.plot.options=i})),this.Setup(e)}GUID=ea();RegisterVariables(){this.variablesToPlot.RegisterVariables();const e=[void 0,...[...this.variablesToPlot.children].map((e=>e.variable.displayUnit))],t=[{name:"CurrentTick"},...[...this.variablesToPlot.children].map((e=>e.variable.value))].map((e=>{if(e?.unit||-1!==e?.type?.split("|")?.indexOf("float"))return-1===Ti.variablesToPoll.indexOf(e)&&Ti.variablesToPoll.push(e),e}));Ti.liveUpdateEvents[this.GUID]=(i,n)=>{const a=t.map(((t,n)=>{const a=i?.GetVariableId(t);if(t)return Ti.loggedVariableValues.map((i=>Kn(i[a],t.unit,e[n])))}));this.plot.setData(a)}}}customElements.define("ui-plot",UIPlot,{extends:"span"});class UILoggedVariable extends HTMLTableRowElement{#Re;get variable(){return this.#Re}set variable(e){this.#Re=e,this.children[0].textContent=null==e?.name?"--":e.name.substring(e.name.lastIndexOf(".")+1)??"--",this.children[2].textContent=e?.unit??"--",this.children[3].textContent=e?.refreshRate?-1==e.refreshRate?"Max":`${e.refreshRate}Hz`:"--"}get unit(){return this.#Re?.unit}set unit(e){const t=this.variable;null!=t&&(this.variable={...t,unit:e})}get refreshRate(){return this.#Re?.refreshRate}set refreshRate(e){const t=this.variable;null!=t&&(this.variable={...t,refreshRate:e})}#o;get value(){return this.#o}set value(e){this.#o=e,this.children[1].textContent=e??"--"}constructor(){super(),this.appendChild(document.createElement("td")).class="loggedVariableName",this.append(document.createElement("td")),this.append(document.createElement("td")),this.append(document.createElement("td")),this.appendChild(document.createElement("td")).class="actions",this.value=void 0}}customElements.define("ui-loggedvariable",UILoggedVariable,{extends:"tr"});class Dashboard extends UITemplate{static thisDashboard;static template='<div style="display: flex;">\n    <div style="display: flex;">\n        <div class="loggedVariables">\n            <div>Logged Variables<div data-element="collapseSidebar"></div></div>\n            <div data-element="loggedVariables"></div>\n        </div>\n        <div data-element="expandSidebar"></div>\n    </div>\n    <div style="display:inline-block;">\n        <div data-element="gauges"></div>\n    </div>\n    <div style="display:block;">\n        <div data-element="plots"></div>\n    </div>\n</div>';gauges=document.createElement("div");plots=document.createElement("div");loggedVariables=document.createElement("table");loggedVariablesUnitSelection=new UIUnit;loggedVariablesRefreshSelection=new UISelection({class:"refreshRateSelection",selectHidden:!0,options:[{name:"0.5Hz",value:.5},{name:"1Hz",value:1},{name:"10Hz",value:10},{name:"30Hz",value:30},{name:"60Hz",value:60},{name:"100Hz",value:100},{name:"Max",value:-1}]});loggedVariableVariableSelection=new UISelection({selectHidden:!0});get options(){return this.loggedVariableVariableSelection.options}set options(e){this.loggedVariableVariableSelection.options=e}loggedVariableVariableSelectionDialog=new UIDialog({title:"Variables"});expandSidebar=new UIButton({label:"Logged Variables",class:"loggedVariablesExpand"});get saveValue(){let e=super.saveValue;return delete e.loggedVariablesUnitSelection,delete e.loggedVariablesRefreshSelection,delete e.loggedVariableVariableSelection,e}set saveValue(e){super.saveValue=e}get value(){let e=super.value;return null==e||(delete e.loggedVariablesUnitSelection,delete e.loggedVariablesRefreshSelection,delete e.loggedVariableVariableSelection),e}set value(e){super.value=e}constructor(e){super(),Dashboard.thisDashboard=this,this.loggedVariablesUnitSelection.classList.remove("unit"),this.loggedVariablesUnitSelection.classList.add("logged-variable-selection"),this.loggedVariablesRefreshSelection.classList.add("logged-variable-selection"),this.loggedVariableVariableSelectionDialog.content.appendChild(this.loggedVariableVariableSelection.contextMenuElement).class="openned",this.loggedVariableVariableSelection.addEventListener("change",(()=>{this.loggedVariables.saveValue=[...this.loggedVariables.saveValue,{...this.loggedVariableVariableSelection.value,refreshRate:60}],this.RegisterVariables()})),this.RegisterVariables(),this.plots.class="plots",Object.defineProperty(this.plots,"saveValue",{get:function(){return[...this.children].map((e=>e.saveValue))},set:function(e){for(;this.children.length>e.length;)this.removeChild(this.lastChild);for(let t=0;t<e.length;t++)this.children[t]||this.append(new UIPlot),this.children[t].saveValue=e[t]}}),this.plots.saveValue=new Array(1),this.gauges.class="gauges",Object.defineProperty(this.gauges,"saveValue",{get:function(){return[...this.children].map((e=>e.saveValue))},set:function(e){for(;this.children.length>e.length;)this.removeChild(this.lastChild);for(let t=0;t<e.length;t++)this.children[t]||this.append(new UIGauge),this.children[t].saveValue=e[t]}}),this.gauges.saveValue=new Array(8);const t=this.loggedVariables.appendChild(document.createElement("tr")),i=t.appendChild(document.createElement("td"));i.textContent="Name",i.class="loggedVariableName",t.appendChild(document.createElement("td")).textContent="Value",t.appendChild(document.createElement("td")).textContent="Unit",t.appendChild(document.createElement("td")).textContent="Refresh";const n=t.appendChild(document.createElement("td"));let a;n.class="actions",n.replaceChildren(a=document.createElement("div")),a.class="controladd",a.addEventListener("click",(e=>{this.loggedVariableVariableSelectionDialog.show()}));const l=this;this.loggedVariables.tabIndex=0,this.loggedVariables.addEventListener("keydown",(e=>{if("Delete"===e.key){const e=this.loggedVariables.querySelector(".selected");if(!e)return;this.loggedVariables.removeChild(e),this.RegisterVariables()}})),Object.defineProperty(this.loggedVariables,"saveValue",{get:function(){return this.variables},set:function(e){this.variables=e}}),Object.defineProperty(this.loggedVariables,"variables",{get:function(){return[...this.children].map((e=>e.variable)).slice(1)},set:function(e){for(;this.children.length>e.length+1;)this.removeChild(this.lastChild);for(let t=0;t<e.length;t++){if(!this.children[t+1]){const e=this.appendChild(new UILoggedVariable);let t;e.children[4].replaceChildren(t=document.createElement("div")),t.class="controldelete",t.addEventListener("click",(t=>{this.removeChild(e),l.RegisterVariables()})),e.addEventListener("click",(t=>{[...this.children].forEach((e=>{e.classList.remove("selected"),e.unit=e.unit,e.refreshRate=e.refreshRate})),e.class="selected",null!=e.variable&&(l.loggedVariablesRefreshSelection.value=e.refreshRate,l.loggedVariablesUnitSelection.value=e.unit,l.loggedVariablesUnitSelection.measurement=Jn(e.unit),e.children[3].replaceChildren(l.loggedVariablesRefreshSelection),e.children[2].replaceChildren(l.loggedVariablesUnitSelection),t.target===e.children[2]&&l.loggedVariablesUnitSelection.children[0].dispatchEvent(new Event("click")),t.target===e.children[3]&&l.loggedVariablesRefreshSelection.children[0].dispatchEvent(new Event("click")))}))}this.children[t+1].variable=e[t]}}}),this.loggedVariablesRefreshSelection.addEventListener("change",(()=>{const e=this.loggedVariables.querySelector(".selected");e&&(e.refreshRate=this.loggedVariablesRefreshSelection.value)})),this.loggedVariablesUnitSelection.addEventListener("change",(()=>{const e=this.loggedVariables.querySelector(".selected");e&&(e.unit=this.loggedVariablesUnitSelection.value)})),this.Setup(e)}Setup(e){super.Setup(e),this.sidebar=this.querySelector(".loggedVariables"),this.expandSidebar.addEventListener("click",(()=>{this.sidebar.hidden?(this.sidebar.hidden=!1,this.expandSidebar.label=" - Logged Variables"):(this.sidebar.hidden=!0,this.expandSidebar.label=" + Logged Variables")})),this.sidebar.hidden=!0,this.expandSidebar.label=" + Logged Variables"}RegisterVariables(){function e(e,t){return!(e?.name!=t?.name||null!=e?.type&&null!=t?.type&&e?.type!==t?.type||null!=e?.unit&&null!=t?.unit&&Jn(e?.unit)!==Jn(t?.unit))}let t=VariableRegister.GetSelections(void 0,Ii(void 0,["float|bool"])),i=Ti.variableMetadata?.GetSelections(void 0,Ii(void 0,["float|bool"]));for(const e in i){const n=i[e];if(n.group){const e=t.find((e=>e.group===n.group));if(null==e)t.push(n);else for(const t in n.options){const i=n.options[t];null==e.options.find((e=>jn(e.value,i.value)))&&e.options.push(i)}}else null==t.find((e=>jn(e.value,n.value)))&&t.push(n)}t=t.map((t=>(-1!==[...this.loggedVariables.children].findIndex((i=>e(t?.value,i?.variable)))&&(t.disabled=!0),t))),t=t.map((t=>(t.options=t.options?.map((t=>(-1!==[...this.loggedVariables.children].findIndex((i=>e(t?.value,i?.variable)))&&(t.disabled=!0),t))),t))),this.options=t,[...this.loggedVariables.children].forEach((i=>{null!=i.variable&&-1===t.findIndex((t=>t.group&&t.options?-1!==t.options.findIndex((t=>e(t?.value,i.variable))):e(t?.value,i.variable)))?i.hidden=!0:i.hidden=!1})),[...this.gauges.children].forEach((e=>e.RegisterVariables())),[...this.plots.children].forEach((e=>e.RegisterVariables()))}}customElements.define("top-dashboard",Dashboard,{extends:"span"});var eo=i(541);class UIGauge extends UITemplate{static template='<canvas data-type="radial-gauge"\n    data-width="350"\n    data-height="350"\n    data-minor-ticks="2"\n    data-stroke-ticks="true"\n    data-color-plate="rgba(0,0,0,0)",\n    data-color-major-ticks="#eee"\n    data-color-minor-ticks="#ddd"\n    data-color-numbers="#eee"\n    data-border-shadow-width="0"\n    data-borders="false"\n    data-needle-type="arrow"\n    data-needle-width="2"\n    data-needle-circle-size="7"\n    data-needle-circle-outer="true"\n    data-needle-circle-inner="false"\n    data-animation-duration="50"\n    data-animation-rule="linear"\n></canvas>';Setup(e){super.Setup(e);const t=this.querySelector("canvas");t.addEventListener("click",(()=>{this.configDialog.show()})),eo.BaseGauge.fromElement(t),this.gauge=document.gauges.find((e=>e.canvas.element===t)),this.#Ne()}get displayUnit(){return this.configTemplate.variable.displayUnit}set displayUnit(e){this.configTemplate.variable.displayUnit=e}get valueUnit(){return this.configTemplate.variable.unit}#o;get value(){return this.#o}set value(e){this.#o!==e&&(this.#o=e,this.gauge.value=Kn(e,this.valueUnit,this.displayUnit))}get saveValue(){let e=this.configTemplate.saveValue;return e.gaugeTemplate===this.constructor.template&&delete e.gaugeTemplate,e}set saveValue(e){this.configTemplate.saveValue=e}get min(){return this.configTemplate.min.value}set min(e){this.configTemplate.min.value=e}get max(){return this.configTemplate.max.value}set max(e){this.configTemplate.max.value=e}get step(){return this.configTemplate.step.value}set step(e){this.configTemplate.step.value=e}get highRedline(){return this.configTemplate.highRedline.value}set highRedline(e){this.configTemplate.highRedline.value=e}get lowRedline(){return this.configTemplate.lowRedline.value}set lowRedline(e){this.configTemplate.lowRedline.value=e}#Ne(){let e={};e.minValue=parseFloat(Kn(this.min,this.valueUnit,this.displayUnit)?.toFixed(2)??0),e.maxValue=parseFloat(Kn(this.max,this.valueUnit,this.displayUnit)?.toFixed(2)??100);let t=e.minValue;e.majorTicks=[t];let i=Kn(this.step,this.valueUnit,this.displayUnit)??10;const n=e.maxValue-e.minValue;for((n<0||n/Math.max(n/30,i)>25)&&(i=n/25);(t+=i)<e.maxValue-i/2;)e.majorTicks.push(parseFloat(t.toFixed(2)));e.majorTicks.push(parseFloat(t.toFixed(2))),e.highlights=[];const a=Kn(this.highRedline,this.valueUnit,this.displayUnit);null!=a&&e.highlights.push({from:a,to:e.maxValue,color:"rgba(200, 50, 50, .75)"});const l=Kn(this.lowRedline,this.valueUnit,this.displayUnit);null!=l&&e.highlights.push({from:e.minValue,to:l,color:"rgba(200, 50, 50, .75)"}),e.title=this.configTemplate.variable.value?.name,e.title=e.title?.substring(e.title.indexOf(".")+1),e.units=this.configTemplate.variable.displayUnit,this.gauge.update(e),this.gauge.value=Kn(this.value,this.valueUnit,this.displayUnit),this.gauge.draw()}constructor(e){let t,i,n,a;super(),this.style.position="relative",this.configTemplate=new UITemplate({template:'<span style="display: block;"><label>Variable:</label><div data-element="variable"></div></span>\n                        <span style="display: block;"><label>Min:</label><div data-element="min"></div></span>\n                        <span style="display: block;"><label>Low:</label><div data-element="lowRedline"></div></span>\n                        <span style="display: block;"><label>Step:</label><div data-element="step"></div></span>\n                        <span style="display: block;"><label>High:</label><div data-element="highRedline"></div></span>\n                        <span style="display: block;"><label>Max:</label><div data-element="max"></div></span>\n                        <span style="display: block;"><label>Gauge Template</label><div data-element="editGauge"></div><div data-element="gaugeTemplate"></div></span>',variable:new UIParameterWithUnit,min:new UINumberWithUnit,max:new UINumberWithUnit,step:new UINumberWithUnit({min:1e-7}),highRedline:new UINumberWithUnit,lowRedline:new UINumberWithUnit,editGauge:new UIButton({label:"Edit"}),gaugeTemplate:new UITextArea({value:this.constructor.template,class:"gaugeTemplate",hidden:!0})}),this.configTemplate.editGauge.addEventListener("click",(e=>{"Edit"===this.configTemplate.editGauge.label?(this.configTemplate.editGauge.label="Hide",this.configTemplate.gaugeTemplate.hidden=!1):(this.configTemplate.editGauge.label="Edit",this.configTemplate.gaugeTemplate.hidden=!0)})),this.configTemplate.gaugeTemplate.addEventListener("change",(e=>{this.template=this.configTemplate.gaugeTemplate.value,this.Setup(),e.preventDefault()})),this.configTemplate.variable.addEventListener("change",(()=>{if(t!=this.displayUnit){const e=t;t=this.displayUnit,e===this.configTemplate.min.displayUnit&&(this.configTemplate.min.displayUnit=this.displayUnit),e===this.configTemplate.max.displayUnit&&(this.configTemplate.max.displayUnit=this.displayUnit),e===this.configTemplate.step.displayUnit&&(this.configTemplate.step.displayUnit=this.displayUnit),e===this.configTemplate.highRedline.displayUnit&&(this.configTemplate.highRedline.displayUnit=this.displayUnit),e===this.configTemplate.lowRedline.displayUnit&&(this.configTemplate.lowRedline.displayUnit=this.displayUnit)}if(this.RegisterVariables(),i!=this.valueUnit){i=this.valueUnit,this.configTemplate.min.valueUnit=this.valueUnit,this.configTemplate.max.valueUnit=this.valueUnit,this.configTemplate.step.valueUnit=this.valueUnit,this.configTemplate.highRedline.valueUnit=this.valueUnit,this.configTemplate.lowRedline.valueUnit=this.valueUnit;let e=qn(this.valueUnit);this.min=e?.min??this.min,this.max=e?.max??this.max,this.step=e?.step??this.step,this.highRedline=e?.highRedline??e?.max??this.highRedline,this.lowRedline=e?.lowRedline??e?.min??this.lowRedline}})),this.configTemplate.addEventListener("change",(()=>{if(this.RegisterVariables(),this.configTemplate.min.step=this.configTemplate.max.step=this.configTemplate.highRedline.step=this.configTemplate.lowRedline.step=this.step,n!=this.min){const e=n;n=this.min,this.configTemplate.lowRedline.min=this.configTemplate.highRedline.min=this.min,this.lowRedline===e&&(this.lowRedline=this.min)}if(a!=this.min){const e=a;a=this.max,this.configTemplate.lowRedline.max=this.configTemplate.highRedline.max=this.max,this.highRedline===e&&(this.highRedline=this.max)}this.configTemplate.step.min=(this.max-this.min)/25,this.#Ne()})),this.configDialog=new UIDialog({title:"Edit Gauge"}),this.configDialog.content.append(this.configTemplate),this.Setup(e)}GUID=ea();RegisterVariables(){let e=Dashboard.thisDashboard.options.map((e=>e.group&&e.options?{...e,options:e.options.map((e=>({...e,disabled:!e.disabled})))}:{...e,disabled:!e.disabled}));this.configTemplate.variable.options=e;const t=this.configTemplate.variable.value;(t?.unit||-1!==t?.type?.split("|")?.indexOf("float"))&&(-1===Ti.variablesToPoll.indexOf(t)&&Ti.variablesToPoll.push(t),Ti.liveUpdateEvents[this.GUID]=(e,i)=>{if(t){const n=e?.GetVariableId(t);null!=i?.[n]&&(this.value=i[n])}})}}customElements.define("ui-gauge",UIGauge,{extends:"span"});class UIPinOverlay extends HTMLDivElement{get pinSelectElements(){function e(t){if(t.classList.contains("pinselectname")){const e=t.value;return e||t.textContent}const i=t.children;for(var n=0;n<i?.length;n++){const t=e(i[n]);if(t)return t}}function t(i){return i?e(i)??t(i.parentElement):void 0}let i=[...document.querySelectorAll(".pinselect")];return i.forEach((e=>{e.name=t(e),e.updateOptions?.(this.pinOut),e.addEventListener("change",(()=>{this.update()}))})),i}#De;get pinOut(){return this.#De}set pinOut(e){if(!e)return;this.#De=e;let t=910/(e.OverlayWidth+300);for(this.overlayImage.style.width=`${e.OverlayWidth}px`,this.style.width="910px",this.style.transform=`scale(${t})`,this.overlayImage.src=e.Overlay;e.Pins.length<this.pinElements.children.length;)this.pinElements.removeChild(this.pinElements.lastChild);for(let t=0;t<e.Pins.length;t++){let i=this.pinElements.children[t];i||(i=this.pinElements.appendChild(new UISelection),i.firstChild.style.minWidth="100px",i.style.width="150px",i.style.position="absolute",Object.defineProperty(i,"pinSelectElements",{set:function(e){this._pinSelectElements=e;let t,i=[];for(let n=0;n<e.length;n++){let a={name:e[n].name,value:n,disabled:-1===this.supportedModes.split(" ").indexOf(e[n].pinType)};e[n].value==this.pin&&(t?(a.Class="pinconflict","string"!=typeof t&&(t.Class="pinconflict"),t="conflict"):t=a),i.push(a)}this.options=i,t?"conflict"===t?(this.classList.add("pinconflict"),this.value=void 0):(this.classList.remove("pinconflict"),this.value=t.value):this.value=void 0}}),i.addEventListener("change",(()=>{null!=i.value&&(i._pinSelectElements[i.value].value=i.pin)}))),i.pin=e.Pins[t].value,i.supportedModes=e.Pins[t].supportedModes,i.style.top=e.Pins[t].overlayY-e.OverlayElementHeight/2+"px",i.style.left=("left"===e.Pins[t].align?e.Pins[t].overlayX+150:e.OverlayWidth-e.Pins[t].overlayX)+"px"}this.update()}update(){const e=this.pinSelectElements;[...this.pinElements.children].forEach((t=>t.pinSelectElements=e))}pinElements=document.createElement("div");overlayImage=document.createElement("img");constructor(){super(),this.class="pinoverlay",this.append(this.overlayImage),this.append(this.pinElements)}}customElements.define("ui-pinoverlay",UIPinOverlay,{extends:"div"});class UIPinSelection extends UISelection{constructor(e){super(e),this.selectDisabled=e.selectDisabled??!0,this.selectValue=e.selectValue??65535,this.classList.add("pinselect")}wtf=1;updateOptions(e){var t=[],i=[];if(e){for(var n=0;n<e.Pins.length;n++){const a=this.value===e.Pins[n].value;-1===e.Pins[n].supportedModes.split(" ").indexOf(this.pinType)?i.push({name:e.Pins[n].name,value:e.Pins[n].value,class:a?"incompatible":void 0,disabled:!0}):t.push({name:e.Pins[n].name,value:e.Pins[n].value})}t=t.concat(i),this.options=t}}}customElements.define("ui-pinselection",UIPinSelection,{extends:"div"});class UIGraph3D extends UITableBase{get xAxis(){return super.xAxis}set xAxis(e){super.xAxis=e,this._valueElement.update(),this.#Fe.update(),this._xAxisElement.update(),this._yAxisElement.update()}get yAxis(){return super.yAxis}set yAxis(e){super.yAxis=e,this._valueElement.update(),this.#Fe.update(),this._xAxisElement.update(),this._yAxisElement.update()}get selecting(){return super.selecting}set selecting(e){if(!jn(this.selecting,e)){if(this.#Fe.querySelectorAll(".selected").forEach((e=>{e.classList.remove("selected")})),e&&null!=e.startX&&null!=e.endX&&null!=e.startY&&null!=e.endY)for(let t=0;t<this.#Fe.children.length;t++){let i=this.#Fe.children[t];Math.min(e.endX,e.startX)>parseInt(i.x1)||Math.max(e.endX,e.startX)<parseInt(i.x2)||Math.min(e.endY,e.startY)>parseInt(i.y1)||Math.max(e.endY,e.startY)<parseInt(i.y3)||i.classList.add("selected")}super.selecting=e}}get pitch(){return this.#ze??0}set pitch(e){e=Math.max(-90,Math.min(90,parseFloat(e))),this.pitch!==e&&(this.#ze=e,this.#Be=UIGraph3D.transformPrecalc(this))}get yaw(){return this.#je??0}set yaw(e){e=parseFloat(e),this.yaw!==e&&(this.#je=e,this.#Be=UIGraph3D.transformPrecalc(this))}get cameraX(){return this.#We??0}set cameraX(e){e=parseFloat(e),this.cameraX!==e&&(this.#We=e,this.#Be=UIGraph3D.transformPrecalc(this))}get cameraY(){return this.#Ye??0}set cameraY(e){e=parseFloat(e),this.cameraY!==e&&(this.#Ye=e,this.#Be=UIGraph3D.transformPrecalc(this))}get zoom(){return this.#Ge??.75}set zoom(e){e=parseFloat(e),this.zoom!==e&&(this.#Ge=e,this.#Be=UIGraph3D.transformPrecalc(this))}get width(){return this.#S.getAttribute("width")??this.offsetWidth??300}set width(e){this.#S.setAttribute("width",parseFloat(e.toFixed(10))),this.#Be=UIGraph3D.transformPrecalc(this)}get height(){return this.#S.getAttribute("height")??this.offsetHeight??150}set height(e){this.#S.setAttribute("height",parseFloat(e.toFixed(10))),this.#Be=UIGraph3D.transformPrecalc(this)}#Xe=document.createElementNS("http://www.w3.org/2000/svg","g");#L=document.createElementNS("http://www.w3.org/2000/svg","g");_xAxisElement=document.createElementNS("http://www.w3.org/2000/svg","g");_yAxisElement=document.createElementNS("http://www.w3.org/2000/svg","g");_valueElement=document.createElementNS("http://www.w3.org/2000/svg","g");#Fe=document.createElementNS("http://www.w3.org/2000/svg","g");#S=document.createElementNS("http://www.w3.org/2000/svg","svg");#He;get#Be(){return this.#He}set#Be(e){if(jn(this.#He,e))return;this.#He=e;const t=e.zoom/(7.5*Math.max(this.xResolution,this.yResolution));[...this._valueElement.children].forEach((e=>{e.setAttribute("r",t.toFixed(10))})),this._valueElement.update(),this.#Fe.updateWithDepth(),this._xAxisElement.update(),this._yAxisElement.update(),this.#L.update(),this.#Xe.update()}#je;#ze;#Ge;#We;#Ye;trail(e,t=0,i){}get _valueMin(){return super._valueMin}set _valueMin(e){super._valueMin=e,this._valueElement.update(),this.#Fe.update(),this.#L.update()}get _valueMax(){return super._valueMax}set _valueMax(e){super._valueMax=e,this._valueElement.update(),this.#Fe.update(),this.#L.update()}constructor(e){function t(){[...this.children].forEach((e=>{e.update()}))}super(),this.class="ui graph3d",this.append(this.#S),this.#S.setAttribute("overflow","visible"),this.#S.append(this._xAxisElement),this.#S.append(this._yAxisElement),this.#S.append(this.#L),this.#S.append(this.#Xe),this.#S.append(this.#Fe),this.#S.append(this._valueElement),this._xAxisElement.update=t,this._yAxisElement.update=t,this.#L.update=t,this._valueElement.update=t,this.#Fe.update=t,this.#Fe.updateWithDepth=function(){const e=[...this.children];e.forEach((e=>{e.update()})),e.sort(((e,t)=>t.depth-e.depth)).forEach((e=>this.append(e)))},this.#Xe.appendChild(document.createElementNS("http://www.w3.org/2000/svg","path")).classList.add("floor"),this.#Xe.append(document.createElementNS("http://www.w3.org/2000/svg","line")),this.#Xe.append(document.createElementNS("http://www.w3.org/2000/svg","line"));const i=this;this.#Xe.update=function(){const e=i.#Be.sinYaw>0?1:0,t=i.#Be.cosYaw>0?0:1,n=i.#Be.sinPitch>0?0:1;this.children[0].style.display=1===n?"none":null;let a=[[UIGraph3D.transformPoint([e-.5,-(n-.5)*Math.max(1,i.height)/Math.max(1,i.width),-.5],i.#Be),UIGraph3D.transformPoint([e-.5,-(n-.5)*Math.max(1,i.height)/Math.max(1,i.width),.5],i.#Be)],[UIGraph3D.transformPoint([-.5,-(n-.5)*Math.max(1,i.height)/Math.max(1,i.width),t-.5],i.#Be),UIGraph3D.transformPoint([.5,-(n-.5)*Math.max(1,i.height)/Math.max(1,i.width),t-.5],i.#Be)]];a[0]=a[0].sort(((e,t)=>e[0]-t[0])),a[0][2]=Math.abs(i.#Be.sinYaw),a[1]=a[1].sort(((e,t)=>e[0]-t[0])),a[1][2]=Math.abs(i.#Be.cosYaw),a=a.sort(((e,t)=>e[0][0]-t[0][0])),this.children[1].setAttribute("x1",a[0][0][0].toFixed(10)),this.children[1].setAttribute("y1",a[0][0][1].toFixed(10)),this.children[1].setAttribute("x2",a[0][1][0].toFixed(10)),this.children[1].setAttribute("y2",a[0][1][1].toFixed(10)),this.children[2].setAttribute("x1",a[1][0][0].toFixed(10)),this.children[2].setAttribute("y1",a[1][0][1].toFixed(10)),this.children[2].setAttribute("x2",a[1][1][0].toFixed(10)),this.children[2].setAttribute("y2",a[1][1][1].toFixed(10));const l=UIGraph3D.transformPoint([.5-e,-(n-.5)*Math.max(1,i.height)/Math.max(1,i.width),.5-t],i.#Be);this.children[0].setAttribute("d",`M${l[0].toFixed(10)},${l[1].toFixed(10)}L${a[0][0][0].toFixed(10)},${a[0][0][1].toFixed(10)}L${a[0][1][0].toFixed(10)},${a[0][1][1].toFixed(10)}L${a[1][1][0].toFixed(10)},${a[1][1][1].toFixed(10)}Z`)};const n=e.value;delete e.value,Object.assign(this,e),this.#M(),this.value=n,null==e?.pitch&&(this.pitch=17),null==e?.yaw&&(this.yaw=30)}static transformPrecalc({width:e=0,height:t=0,pitch:i=0,yaw:n=0,cameraX:a=0,cameraY:l=0,zoom:s=1}={}){let r=Math.cos(i*(Math.PI/180)),o=Math.sin(i*(Math.PI/180)),u=Math.cos(n*(Math.PI/180)),h=Math.sin(n*(Math.PI/180));return{cosPitch:r,sinPitch:o,cosYaw:u,sinYaw:h,sinPitchSinYaw:o*h,nSinPitchCosYaw:-o*u,nCosPitchSinYaw:-r*h,cosPitchcosYaw:r*u,offsetX:e/2-a,offsetY:t/2-l,zoom:.7*e*s}}static transformPoint(e,t){t||(t=UIGraph3D.transformPrecalc());let i=(t.cosYaw*e[0]+t.sinYaw*e[2])*t.zoom+t.offsetX;isNaN(i)&&(i=0);let n=(t.sinPitchSinYaw*e[0]+t.cosPitch*e[1]+t.nSinPitchCosYaw*e[2])*t.zoom+t.offsetY;isNaN(n)&&(n=0);let a=(t.nCosPitchSinYaw*e[0]+t.sinPitch*e[1])*t.zoom;return isNaN(a)&&(a=0),[i,n,a]}#O(e,t,i){const n=this._xAxisElement.children,a=n[0]?.value,l=n[n.length-1]?.value,s=n[e]?.value,r=this._yAxisElement.children,o=r[0]?.value,u=r[r.length-1]?.value,h=r[t]?.value;if(!isNaN(i))return t=this.yResolution-t-1,e=(s-a)/(l-a),isNaN(e)&&(e=0),t=(h-o)/(u-o),isNaN(t)&&(t=0),i=(i-this._valueMin)/(this._valueMax-this._valueMin),UIGraph3D.transformPoint([e-.5,-(i-.5)*Math.max(1,this.height)/Math.max(1,this.width),t-.5],this.#Be)}#R(e,t){const i=this._xAxisElement.children,n=i[0]?.value,a=i[i.length-1]?.value,l=i[e]?.value,s=this._yAxisElement.children,r=s[0]?.value,o=s[s.length-1]?.value,u=s[t]?.value;return t=this.yResolution-t-1,e=null==e||isNaN(e)?this.#Be?.sinYaw>0?0:1:(l-n)/(a-n),isNaN(e)&&(e=0),t=null==t||isNaN(t)?this.#Be?.cosYaw>0?1:0:(u-r)/(o-r),isNaN(t)&&(t=0),[UIGraph3D.transformPoint([e-.5,.5*Math.max(1,this.height)/Math.max(1,this.width),t-.5],this.#Be),UIGraph3D.transformPoint([e-.5,-.5*Math.max(1,this.height)/Math.max(1,this.width),t-.5],this.#Be)]}#$e(e){const t=this.#Be.sinYaw>0?0:1,i=this.#Be.cosYaw>0?1:0;return e=(e-this._valueMin)/(this._valueMax-this._valueMin),[[UIGraph3D.transformPoint([t-.5,-(e-.5)*Math.max(1,this.height)/Math.max(1,this.width),-.5],this.#Be),UIGraph3D.transformPoint([t-.5,-(e-.5)*Math.max(1,this.height)/Math.max(1,this.width),.5],this.#Be)],[UIGraph3D.transformPoint([-.5,-(e-.5)*Math.max(1,this.height)/Math.max(1,this.width),i-.5],this.#Be),UIGraph3D.transformPoint([.5,-(e-.5)*Math.max(1,this.height)/Math.max(1,this.width),i-.5],this.#Be)]]}_resolutionChanged(e,t){const i=this,n=.45/Math.max(this.xResolution,this.yResolution,t);for(;t<e.children.length;)e.removeChild(e.lastChild);for(let n=0;n<t;n++){let a=e.children[n];if(!a){a=e.appendChild(document.createElementNS("http://www.w3.org/2000/svg","g")),a.append(document.createElementNS("http://www.w3.org/2000/svg","line"));const t=a.appendChild(document.createElementNS("http://www.w3.org/2000/svg","text"));t.setAttribute("alignment-baseline","middle"),t.setAttribute("text-anchor","end");const i=a.appendChild(document.createElementNS("http://www.w3.org/2000/svg","text"));i.setAttribute("alignment-baseline","middle"),i.setAttribute("text-anchor","start");const l=e.children[n-1]?.value,s=e.children[n-2]?.value;let r=0;null!=l&&null!=s&&(r=l+(l-s)),a.value=r,e===this._xAxisElement?a.x=n:a.y=n}a.update=function(){if(!i.#Be)return;const e=i.#R(this.x,this.y);this.children[0].setAttribute("x1",e[0][0].toFixed(10)),this.children[0].setAttribute("y1",e[0][1].toFixed(10)),this.children[0].setAttribute("x2",e[1][0].toFixed(10)),this.children[0].setAttribute("y2",e[1][1].toFixed(10));const n=this.textSize*i.#Be.zoom,a=Math.abs(null!=this.x?i.#Be.cosYaw:i.#Be.sinYaw),l=Math.abs(i.#Be.cosPitch);let s=0;0===this.x&&(s=i.#Be.sinYaw<0?0:i.#Be.cosYaw*n/2),this.x===t-1&&(s=i.#Be.sinYaw>0?0:-i.#Be.cosYaw*n/2),0===this.y&&(s=i.#Be.cosYaw>0?0:i.#Be.sinYaw*n/2),this.y===t-1&&(s=i.#Be.cosYaw<0?0:-i.#Be.sinYaw*n/2),e[0][0]+=s,e[1][0]+=s,this.children[1].setAttribute("x",e[0][0].toFixed(10)),this.children[1].setAttribute("y",e[0][1].toFixed(10)),this.children[1].setAttribute("transform-origin",`${e[0][0].toFixed(10)} ${e[0][1].toFixed(10)}`),this.children[1].setAttribute("transform",`scale(${a.toFixed(10)} ${l.toFixed(10)}) rotate(-90)`),this.children[1].setAttribute("font-size",n.toFixed(10)),this.children[2].setAttribute("x",e[1][0].toFixed(10)),this.children[2].setAttribute("y",e[1][1].toFixed(10)),this.children[2].setAttribute("transform-origin",`${e[1][0].toFixed(10)} ${e[1][1].toFixed(10)}`),this.children[2].setAttribute("transform",`scale(${a.toFixed(10)} ${l.toFixed(10)}) rotate(-90)`),this.children[2].setAttribute("font-size",n.toFixed(10)),this.children[1].textContent=this.children[2].textContent=zn(this.value)}}for(let e=0;e<this._xAxisElement.children.length;e++)this._xAxisElement.children[e].textSize=n;for(let e=0;e<this._yAxisElement.children.length;e++)this._yAxisElement.children[e].textSize=n;const a=parseInt(1.5+Math.max(this.xResolution,this.yResolution));for(;a<this.#L.children.length;)this.#L.removeChild(this.#L.lastChild);for(let e=0;e<a;e++){let t=this.#L.children[e];if(!t){t=this.#L.appendChild(document.createElementNS("http://www.w3.org/2000/svg","g")),t.append(document.createElementNS("http://www.w3.org/2000/svg","line")),t.append(document.createElementNS("http://www.w3.org/2000/svg","line"));const e=t.appendChild(document.createElementNS("http://www.w3.org/2000/svg","text"));e.setAttribute("alignment-baseline","middle"),e.setAttribute("text-anchor","end");const n=t.appendChild(document.createElementNS("http://www.w3.org/2000/svg","text"));n.setAttribute("alignment-baseline","middle"),n.setAttribute("text-anchor","start"),t.update=function(){if(!i.#Be)return;let e=(i._valueMax-i._valueMin)/(this.zResolution-1)*this.z+i._valueMin;this.z===this.zResolution-1&&(e=i._valueMax);let n=i.#$e(e);n[0]=n[0].sort(((e,t)=>e[0]-t[0])),n[0][2]=Math.abs(i.#Be.sinYaw),n[1]=n[1].sort(((e,t)=>e[0]-t[0])),n[1][2]=Math.abs(i.#Be.cosYaw),n=n.sort(((e,t)=>e[0][0]-t[0][0])),this.children[0].setAttribute("x1",n[0][0][0].toFixed(10)),this.children[0].setAttribute("y1",n[0][0][1].toFixed(10)),this.children[0].setAttribute("x2",n[0][1][0].toFixed(10)),this.children[0].setAttribute("y2",n[0][1][1].toFixed(10)),this.children[1].setAttribute("x1",n[1][0][0].toFixed(10)),this.children[1].setAttribute("y1",n[1][0][1].toFixed(10)),this.children[1].setAttribute("x2",n[1][1][0].toFixed(10)),this.children[1].setAttribute("y2",n[1][1][1].toFixed(10)),this.children[2].textContent=this.children[3].textContent=zn(e);const a=this.textSize*i.#Be.zoom,l=Math.abs(i.#Be.cosPitch),s=180*Math.atan((n[0][1][1]-n[0][0][1])/(n[0][1][0]-n[0][0][0]))/Math.PI,r=180*Math.atan((n[1][0][1]-n[1][1][1])/(n[1][0][0]-n[1][1][0]))/Math.PI;let o=0;0===this.z&&(o=-a/2),this.z===this.zResolution-1&&(o=a/2),this.children[2].setAttribute("x",n[0][0][0].toFixed(10)),this.children[2].setAttribute("y",(n[0][0][1]+o).toFixed(10)),this.children[2].setAttribute("transform-origin",`${n[0][0][0].toFixed(10)} ${n[0][0][1].toFixed(10)}`),this.children[2].setAttribute("transform",`skewY(${s.toFixed(10)}) scale(${n[0][2].toFixed(10)} ${l})`),t.children[2].setAttribute("font-size",a.toFixed(10)),this.children[3].setAttribute("x",n[1][1][0].toFixed(10)),this.children[3].setAttribute("y",(n[1][1][1]+o).toFixed(10)),this.children[3].setAttribute("transform-origin",`${n[1][1][0]} ${n[1][1][1].toFixed(10)}`),this.children[3].setAttribute("transform",`skewY(${r.toFixed(10)}) scale(${n[1][2].toFixed(10)} ${l})`),t.children[3].setAttribute("font-size",a.toFixed(10))}}t.zResolution=a,t.textSize=n,t.z=e}function l(e){let t=`_v${e}`;return{get:function(){return this[t]},set:function(e){e=parseFloat(e),this[t]!==e&&(this[t]=e,this.value=(parseFloat(this.v1)+parseFloat(this.v2)+parseFloat(this.v3)+parseFloat(this.v4))/4)}}}for(this.style.setProperty("--xresolution",this.xResolution),this.style.setProperty("--yresolution",this.yResolution);Math.max(0,(this.xResolution-1)*(this.yResolution-1))<this.#Fe.children.length;)this.#Fe.removeChild(this.#Fe.lastChild);for(let e=0;e<(this.xResolution-1)*(this.yResolution-1);e++){let t=this.#Fe.children[e];t||(t=this.#Fe.appendChild(document.createElementNS("http://www.w3.org/2000/svg","path")),Object.defineProperty(t,"value",{get:function(){return this._value},set:function(e){e=parseFloat(e),this._value!==e&&(this._value=e,this.style.setProperty("--data-value",e))}}),t.update=function(){this.p1&&this.p2&&this.p3&&this.p4&&(this.depth=(this.p1[2]+this.p2[2]+this.p3[2]+this.p4[2])/4,isNaN(this.depth)||this.setAttribute("d",`M${this.p1[0].toFixed(10)},${this.p1[1].toFixed(10)}L${this.p2[0].toFixed(10)},${this.p2[1].toFixed(10)}L${this.p3[0].toFixed(10)},${this.p3[1].toFixed(10)}L${this.p4[0].toFixed(10)},${this.p4[1].toFixed(10)}Z`))},Object.defineProperty(t,"v1",l(1)),Object.defineProperty(t,"v2",l(2)),Object.defineProperty(t,"v3",l(3)),Object.defineProperty(t,"v4",l(4))),t.x1=t.x4=e%(this.xResolution-1),t.y1=t.y2=Math.trunc(e/(this.xResolution-1)),t.x2=t.x3=t.x1+1,t.y3=t.y4=t.y1+1}const s=[...this.#Fe.children];for(;this.xResolution*this.yResolution<this._valueElement.children.length;)this._valueElement.removeChild(this._valueElement.lastChild);for(let e=0;e<this.xResolution*this.yResolution;e++){let t=this._valueElement.children[e];t||(t=this._valueElement.appendChild(document.createElementNS("http://www.w3.org/2000/svg","circle")),Object.defineProperty(t,"value",{get:function(){return this._value},set:function(e){e=parseFloat(e),this._value!==e&&(this._value=e,this.style.setProperty("--data-value",e),e<i._valueMin&&(i._valueMin=e),e>i._valueMax&&(i._valueMax=e),this.update(),this.vp1&&(this.vp1.v1=e),this.vp2&&(this.vp2.v2=e),this.vp3&&(this.vp3.v3=e),this.vp4&&(this.vp4.v4=e))}}),Object.defineProperty(t,"p",{get:function(){return this.pp},set:function(e){e&&(null!=this.pp&&this.pp[0]===e[0]&&this.pp[1]===e[1]||(this.vp1&&(this.vp1.p1=e,this.vp1.v1=this.value),this.vp2&&(this.vp2.p2=e,this.vp2.v2=this.value),this.vp3&&(this.vp3.p3=e,this.vp3.v3=this.value),this.vp4&&(this.vp4.p4=e,this.vp4.v4=this.value)),this.pp=e,this.depth=e[2])}})),t.update=function(){if(!(this.p=i.#O(this.x,this.y,this.value)))return;const e=this.p;this.setAttribute("cx",e[0].toFixed(10)),this.setAttribute("cy",e[1].toFixed(10))},t.x=e%this.xResolution,t.y=Math.trunc(e/this.xResolution),t.vp1=s.find((e=>e.x1===t.x&&e.y1===t.y)),t.vp2=s.find((e=>e.x2===t.x&&e.y2===t.y)),t.vp3=s.find((e=>e.x3===t.x&&e.y3===t.y)),t.vp4=s.find((e=>e.x4===t.x&&e.y4===t.y))}}#M(){const e=()=>{const e=Bn(this.value);this._valueMin=e[0],this._valueMax=e[1]};this.addEventListener("change",e),e(),this.#S.addEventListener("wheel",(e=>(e.wheelDelta/120>0?this.zoom*=1.1:this.zoom*=.9,e.preventDefault(),e.stopPropagation(),!1)),{passive:!1}),this.#S.addEventListener("contextmenu",(e=>{e.preventDefault()})),this.#S.addEventListener("mousedown",(e=>{var t=this.#S.getBoundingClientRect(),i=e.pageX-t.left,n=e.pageY-t.top;let a,l,s,r;if([...this._valueElement.children].sort(((e,t)=>e.depth-t.depth)).forEach(((e,t)=>{let l=e.p[0]-i,s=e.p[1]-n;e.dist=Math.sqrt(l*l+s*s),(null==a||e.dist<a.dist)&&(a=e)})),a&&0===e.button){const t=a.x,i=a.y;this.selecting={startX:t,startY:i,endX:t,endY:i},r={pageY:e.pageY,closestCircle:a,value:a.value,mag:(this._valueMax-this._valueMin)/this.height}}else 1===e.button?(s={pageX:e.pageX,pageY:e.pageY,cameraX:this.cameraX,cameraY:this.cameraY},e.preventDefault()):2===e.button&&(l={pageX:e.pageX,pageY:e.pageY,yaw:this.yaw,pitch:this.pitch},e.preventDefault());if(r){const e=e=>{r.closestCircle.value=r.value+(r.pageY-e.pageY)*r.mag,this.dispatchEvent(new Event("change",{bubbles:!0}))},t=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",t)}if(s){const e=e=>{this.cameraX=s.cameraX+s.pageX-e.pageX,this.cameraY=s.cameraY+s.pageY-e.pageY},t=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",t)}if(l){const e=e=>{let t=l.yaw+l.pageX-e.pageX,i=Math.max(-90,Math.min(90,l.pitch+e.pageY-l.pageY));t===this.yaw&&i===this.pitch||(this.#je=t,this.#ze=i,this.#Be=UIGraph3D.transformPrecalc(this))},t=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",t)}}))}}customElements.define("ui-graph-3d",UIGraph3D,{extends:"div"});class Calculation_2AxisTable extends UITemplate{static displayName="2 Axis Table";static outputTypes=["float"];static inputTypes=["float","float"];static template='<div data-element="dialog"></div>';GUID=ea();dialog=new UIDialog({buttonLabel:"Edit Table"});table=new UITableWithUnit({xAxis:[1,2,3,4,5,6,7,8],yAxis:[1,2,3,4,5,6,7,8]});graph=new UIGraph3D({width:800,height:450});constructor(e){super(),this.graph.addEventListener("change",(()=>{this.graph.width=Math.min(Math.max(600,75*this.graph.xResolution),1e3)})),this.table.addEventListener("change",(()=>{this.XSelection&&(this.XSelection.displayUnit=this.table.xDisplayUnit),this.YSelection&&(this.YSelection.displayUnit=this.table.yDisplayUnit)})),this.table.attachToTable(this.graph),this.dialog.content.append(this.graph),this.dialog.content.append(document.createElement("br")),this.dialog.content.append(this.table),this.noParameterSelection=!1,this.label="Value",this.Setup(e)}get label(){return this.table.zLabel}set label(e){this.table.zLabel=e,this.dialog.title=e}get xResolutionModifiable(){return this.table.xResolutionModifiable}set xResolutionModifiable(e){this.table.xResolutionModifiable=e}get xResolution(){return this.table.xResolution}set xResolution(e){this.table.xResolution=e}_xLabel="X";get xLabel(){return this._xLabel}set xLabel(e){this._xLabel!==e&&(this._xLabel=e,this.XSelection||(this.table.xLabel=e))}get xMeasurement(){return this.table.xMeasurement}set xMeasurement(e){this.table.xMeasurement=e}get xDisplayUnit(){return this.table.xDisplayUnit}set xDisplayUnit(e){this.table.xDisplayUnit=e}get xDisplayAxis(){return this.table.xDisplayAxis}set xDisplayAxis(e){this.table.xDisplayAxis=e}get xUnit(){return this.table.xUnit}set xUnit(e){this.table.xUnit=e}get xAxis(){return this.table.xAxis}set xAxis(e){this.table.xAxis=e}get yResolutionModifiable(){return this.table.yResolutionModifiable}set yResolutionModifiable(e){this.table.yResolutionModifiable=e}get yResolution(){return this.table.yResolution}set yResolution(e){this.table.yResolution=e}_yLabel="Y";get yLabel(){return this._yLabel}set yLabel(e){this._yLabel!==e&&(this._yLabel=e,this.YSelection||(this.table.yLabel=e))}get yMeasurement(){return this.table.yMeasurement}set yMeasurement(e){this.table.yMeasurement=e}get yDisplayUnit(){return this.table.yDisplayUnit}set yDisplayUnit(e){this.table.yDisplayUnit=e}get yDisplayAxis(){return this.table.yDisplayAxis}set yDisplayAxis(e){this.table.yDisplayAxis=e}get yUnit(){return this.table.yUnit}set yUnit(e){this.table.yUnit=e}get yAxis(){return this.table.yAxis}set yAxis(e){this.table.yAxis=e}get xOptions(){return this.XSelection?.options}set xOptions(e){if(!this.XSelection)return;this.XSelection.options=e;const t=this.XSelection.units;this.xMeasurement=Jn(t),this.xUnit=t}get yOptions(){return this.YSelection?.options}set yOptions(e){if(!this.YSelection)return;this.YSelection.options=e;const t=this.YSelection.units;this.yMeasurement=Jn(t),this.yUnit=t}get noParameterSelection(){return!this.XSelection&&!this.YSelection}set noParameterSelection(e){if(e)return this.XSelection=void 0,this.YSelection=void 0,this.table.xLabel=this.xLabel,void(this.table.yLabel=this.yLabel);this.XSelection?null==this._inputUnits?.[0]&&(this.xMeasurement=void 0):(this.XSelection=new UIParameterWithUnit({options:VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[0],["float"])),selectHidden:!0}),this.XSelection.unitHidden=!0,this.XSelection.addEventListener("change",(()=>{if(null==this._inputUnits?.[0]){const e=this.XSelection.units;this.xMeasurement=Jn(e),this.xUnit=e}})),this.table.xLabel=this.XSelection),this.YSelection?null==this._inputUnits?.[1]&&(this.yMeasurement=void 0):(this.YSelection=new UIParameterWithUnit({options:VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[1],["float"])),selectHidden:!0}),this.YSelection.unitHidden=!0,this.YSelection.addEventListener("change",(()=>{if(null==this._inputUnits?.[1]){const e=this.YSelection.units;this.yMeasurement=Jn(e),this.yUnit=e}})),this.table.yLabel=this.YSelection)}get min(){return this.table.min}set min(e){this.table.min=e}get max(){return this.table.max}set max(e){this.table.max=e}get step(){return this.table.step}set step(e){this.table.step=e}get displayUnit(){return this.table.displayUnit}set displayUnit(e){this.table.displayUnit=e}get displayValue(){return this.table.displayValue}set displayValue(e){this.table.displayValue=e}get measurement(){return this.table.measurement}set measurement(e){this.table.measurement=e}get valueUnit(){return this.table.valueUnit}set valueUnit(e){this.table.valueUnit=e}get value(){return{...super.value,table:this.table.saveValue,graph:void 0}}set value(e){const t=(e={...e}).table;delete e.table,null!=e.XSelection?.unit&&(this.xUnit=e.XSelection?.unit),null!=e.YSelection?.unit&&(this.yUnit=e.YSelection?.unit),super.value=e,this.table.saveValue=t}get saveValue(){let e=super.saveValue;return delete e.graph,e}set saveValue(e){const t=(e={...e}).table;delete e.table,null!=e.XSelection?.unit&&(this.xUnit=e.XSelection?.unit),null!=e.YSelection?.unit&&(this.yUnit=e.YSelection?.unit),super.saveValue=e,void 0!==t&&(this.table.saveValue=t)}_inputUnits;get inputUnits(){return[this.xUnit,this.yUnit]}set inputUnits(e){this._inputUnits=e?.[0],this.xOptions=VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[0],["float"])),this.yOptions=VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[1],["float"])),this.xUnit=e?.[0],this.yUnit=e?.[1],null!=e?.[0]&&(this.xMeasurement=Jn(e?.[0])),null!=e?.[1]&&(this.yMeasurement=Jn(e?.[1]))}_outputUnits;get outputUnits(){return this._outputUnits??[this.valueUnit]}set outputUnits(e){this._outputUnits=e,this.valueUnit=e?.[0],null!=e?.[0]&&(this.measurement=Jn(e?.[0]))}get displayUnits(){return[this.displayUnit]}set displayUnits(e){this.displayUnit=e?.[0]}RegisterVariables(){this.xOptions=VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[0],["float"])),this.yOptions=VariableRegister.GetSelections(void 0,Ii(this._inputUnits?.[0],["float"])),-1===Ti.variablesToPoll.indexOf(this.XSelection?.value)&&Ti.variablesToPoll.push(this.XSelection?.value),-1===Ti.variablesToPoll.indexOf(this.YSelection?.value)&&Ti.variablesToPoll.push(this.YSelection?.value),Ti.liveUpdateEvents[this.GUID]=(e,t)=>{if(this.XSelection?.value&&this.YSelection?.value){const i=e?.GetVariableId(this.XSelection?.value),n=e?.GetVariableId(this.YSelection?.value);null!=t?.[i]&&null!=t[n]&&this.table.trail(t[i],t[n])}}}}ia.push(Calculation_2AxisTable),customElements.define("calculation-2axistable",Calculation_2AxisTable,{extends:"span"});class Calculation_Formula extends UITemplate{static displayName="Formula";static outputTypes=["bool|float"];static template='<div data-element="editFormula"></div><div data-element="editFormulaContent"><div style="display: flex; width: 100%"><div style="margin: auto; margin-right: 1em; width: fit-content; white-space: nowrap;"><div data-element="labelElement"></div> <div data-element="formulaUnit"></div> = </div><div data-element="formula"></div></div><div data-element="parameterElements"></div></div><div data-element="parameterValueElements"></div>';get outputUnits(){return[this.formulaUnit.textContent]}set outputUnits(e){this.formulaUnit.textContent=e?.[0]}labelElement=document.createElement("span");formulaUnit=document.createElement("span");editFormula=new UIDialog({buttonLabel:"Edit Formula"});formula=new UIText({class:"formula"});parameterElements=document.createElement("div");parameterValueElements=document.createElement("div");parameterValues={};parameterSaveValueCache={};parameterUnits={};get parameters(){return[...this.parameterValueElements.children].map((e=>e.name))}set parameters(e){for(let t in e)""===e[t]&&e.splice(t,1);for(;e.length<this.parameterValueElements.children.length;)this.parameterValueElements.removeChild(this.parameterValueElements.lastChild);for(;e.length<this.parameterElements.children.length;)this.parameterElements.removeChild(this.parameterElements.lastChild);for(let t=0;t<e.length;t++){let i=this.parameterValues[e[t]];i||(i=this.parameterValues[e[t]]=new CalculationOrVariableSelection_CalculationOrVariableSelection({label:e[t],calculations:this.calculations,outputTypes:["bool|float"],displayUnits:this.outputUnits}),i.style.display="inline");let n=this.parameterUnits[e[t]];n||(n=this.parameterUnits[e[t]]=new UIUnit({value:this.outputUnits?.[0]}),n.addEventListener("change",(()=>{const e=i.SubConfig;e&&(e.displayUnits=e.outputUnits=[n.value])})),i.selection.addEventListener("change",(()=>{const e=i.SubConfig;e&&(e.outputUnits=[n.value??this.outputUnits?.[0]])})),i.addEventListener("change",(()=>{const e=i.SubConfig;e?(null!=e.outputUnits?.[0]&&(n.value=e.outputUnits?.[0]),n.hidden=!1):n.hidden=!0})),i.SubConfig||(n.hidden=!0));let a=this.parameterElements.children[t];a||(a=this.parameterElements.appendChild(document.createElement("div"))),a.replaceChildren(i),a.appendChild(n);let l=this.parameterValueElements.children[t];if(!l){l=this.parameterValueElements.appendChild(document.createElement("span")),l.style.display="block";let e=l.appendChild(document.createElement("label"));e.append(document.createElement("span")),Object.defineProperty(l,"name",{get:function(){return this._name},set:function(e){this._name=e,this.firstChild.firstChild.innerText=e}}),e.append(":"),l.append(document.createElement("span"))}l.name=e[t],l.lastChild.replaceChildren(i.liveUpdate,i.calculationContent),""===i.calculationContent.innerHTML?l.hidden=!0:l.hidden=!1,i.selection.addEventListener("change",(()=>{""===i.calculationContent.innerHTML?l.hidden=!0:l.hidden=!1,0===[...this.parameterValueElements.children].filter((e=>!e.hidden)).length?(this.parameterValueElements.classList.remove("configContainer"),this.parameterValueElementshidden=!0):(this.parameterValueElements.classList.add("configContainer"),this.parameterValueElements.hidden=!1)}))}0===[...this.parameterValueElements.children].filter((e=>!e.hidden)).length?(this.parameterValueElements.classList.remove("configContainer"),this.parameterValueElementshidden=!0):(this.parameterValueElements.classList.add("configContainer"),this.parameterValueElements.hidden=!1)}get label(){return this.labelElement.textContent}set label(e){this.labelElement.textContent=e,this.editFormula.title=e+" Formula"}get value(){let e=super.value;e.parameterValues={};let t=this.parameters;for(let i in t)e.parameterValues[t[i]]=this.parameterValues[t[i]]?.value;return e}set value(e){e??={},super.value=e,Object.keys(this.parameterValues).filter((t=>null==e.parameterValues[t])).forEach((e=>{delete this.parameterValues[e]}));for(let t in e.parameterValues){let i=this.parameterValues[t]??=new CalculationOrVariableSelection_CalculationOrVariableSelection({label:t,calculations:this.calculations,outputTypes:["bool|float"],displayUnits:this.outputUnits});i.style.display="inline",i.value=e.parameterValues[t],this.parameterUnits[t]?this.parameterUnits[t].value=e.parameterValues[t].outputUnits?.[0]:saveValue.parameterUnits?.[t]&&i.SubConfig&&(i.SubConfig.outputUnits=e.parameterValues[t].outputUnits),i.value=e.parameterValues[t]}}get saveValue(){let e=super.saveValue??{};e.parameterValues={},e.parameterUnits={};for(let t in this.parameterValues)e.parameterValues[t]=this.parameterValues[t]?.saveValue,e.parameterUnits[t]=this.parameterUnits[t]?.value;return e}set saveValue(e){e??={},super.saveValue=e,Object.keys(this.parameterValues).filter((t=>null==e.parameterValues[t])).forEach((e=>{delete this.parameterValues[e]}));for(let t in e.parameterValues){let i=this.parameterValues[t]??=new CalculationOrVariableSelection_CalculationOrVariableSelection({label:t,calculations:this.calculations,outputTypes:["bool|float"],displayUnits:this.outputUnits});i.style.display="inline",i.saveValue=e.parameterValues[t],null!=e.parameterUnits?.[t]&&(this.parameterUnits[t]?this.parameterUnits[t].value=e.parameterUnits[t]:i.SubConfig&&(i.SubConfig.outputUnits=[e.parameterUnits[t]])),i.saveValue=e.parameterValues[t]}}constructor(e){super(),this.parameterElements.class="configContainer",this.parameterElements.style.display="block",this.parameterElements.style.minHeight="200px",this.parameterValueElements.hidden=!0,this.formula.addEventListener("change",(()=>{let e=["!","*","/","+","-",">=","<=",">","<","=","&","|"],t=this.formula.value.replaceAll(" ","");for(let i in e){let n=e[i];t=t.split(n).join(",")}let i=t.split(","),n=this.formula.value.replaceAll(" ","");for(let e=0;e<i.length;e++){let t=n.indexOf(i[e]);n=n.substring(0,t)+","+n.substring(t+i[e].length)}n=n.split(","),t="";for(let e=0;e<i.length;e++)if(""!==t&&(t+=","),t+=i[e],i[e].match(/[^,][(]/)&&")"!==i[e][i[e].length-1])for(;++e<i.length&&(t+=n[e]+i[e],")"!==i[e][i[e].length-1]););t=t.split(","),t=t.map((e=>"("===e[0]?e.substring(1):e)),t=t.map((e=>{for(;")"===e[e.length-1]&&e.split(")").length>e.split("(").length;)e=e.substring(0,e.length-1);return e})),t=t.filter((e=>!e.match(/^[0-9]*$/))),t=t.filter((e=>0!==e.length)),t=t.filter((e=>"self"!==e)),this.parameters=t})),this.Setup(e)}Setup(e){super.Setup(e),this.editFormula.content.innerHTML="",this.editFormula.content.append(this.querySelector('[data-element="editFormulaContent"]'))}RegisterVariables(e){if(e={...e}){e.unit=this.outputUnits?.[0]??e.unit,e.unit?delete e.type:(delete e.unit,e.type=this.outputTypes?.[0]??e.type),["*","/","+","-",">=","<=",">","<","=","&","|"].some((e=>this.formula.value.indexOf(e)>-1))?(this.parameters.forEach((t=>{this.parameterValues[t]?.RegisterVariables({name:`${e.name}_${this.parameterValues[t].label}`,unit:this.parameterValues[t].unit})})),VariableRegister.RegisterVariable(e)):this.parameterValues[this.parameters[0]]?.RegisterVariables(e)}}}ia.push(Calculation_Formula),customElements.define("calculation-formula",Calculation_Formula,{extends:"span"});class GenericCalculation extends CalculationOrVariableSelection_CalculationOrVariableSelection{name=new UIText({class:"genericCalculationName"});get nameEditable(){return!this.name.disabled}set nameEditable(e){this.name.disabled=!e}constructor(e){const t=(e={calculations:ia,selectionFilter:Ai,...e}).name??"Name";delete e.name,super(),super.Setup(e),this.labelElement.replaceWith(this.name),this.name.addEventListener("change",(()=>{this.label=this.name.value,this.name.parentElement.setAttribute("label",this.label)})),this.name.value=t}RegisterVariables(e){e={...e,name:void 0===e?.name?this.name.value:`${e.name}.${this.name.value}`},super.RegisterVariables(e)}get saveValue(){const e=super.saveValue;return{...e,name:this.nameEditable?e.name:void 0}}set saveValue(e){super.saveValue={...e,name:this.nameEditable?e.name:void 0}}}customElements.define("top-generic-calculation",GenericCalculation,{extends:"span"});class CAN_PackData extends UITemplate{static displayName="CAN Pack";static outputTypes=["CANData"];static inputTypes=[];static template='Offset:<div data-element="bitLocation"></div>Length:<div data-element="bitLength"></div><div data-element="multiplierLabel"></div><div data-element="multiplier"></div><div data-element="adderLabel"></div><div data-element="adder"></div><div data-element="variable"></div>';bitLocation=new UINumber({min:0,max:63,step:1,value:0,class:"canBitOffset"});bitLength=new UINumber({min:1,max:64,step:1,value:1,class:"canBitLength"});multiplierLabel=document.createElement("span");multiplier=new UINumber({value:1,class:"canMultiplier"});adderLabel=document.createElement("span");adder=new UINumber({value:0,class:"canAdder"});variable=new CalculationOrVariableSelection_CalculationOrVariableSelection({outputTypes:["bool"],calculations:ia,template:'<div data-element="selection"></div><div data-element="liveUpdate"></div><span data-element="calculationContent"></span>'});constructor(e){super(),this.variable.style.display="inline",this.multiplierLabel.innerText="Multiplier:",this.adderLabel.innerText="Adder:",this.multiplier.hidden=this.multiplierLabel.hidden=this.adder.hidden=this.adderLabel.hidden=!0,this.bitLocation.addEventListener("change",(()=>{this.bitLength.max=64-this.bitLocation.value})),this.bitLength.addEventListener("change",(()=>{this.multiplier.hidden=this.multiplierLabel.hidden=this.adder.hidden=this.adderLabel.hidden=this.bitLength.value<2,this.variable.outputTypes=[this.bitLength.value<2?"bool":"float"]})),this.Setup(e)}RegisterVariables(e){this.variable.RegisterVariables(e)}}customElements.define("can-pack-data",CAN_PackData,{extends:"span"});class CAN_ParseData extends UITemplate{static displayName="CAN Parse";static outputTypes=["bool|float"];static inputTypes=["CANData"];static template='<div data-element="name"></div>: Offset:<div data-element="bitLocation"></div>Length:<div data-element="bitLength"></div><div data-element="multiplierLabel"></div><div data-element="multiplier"></div><div data-element="adderLabel"></div><div data-element="adder"></div><div data-element="unit"></div><div data-element="liveUpdate"></div>';name=new UIText({class:"canParseDataName"});bitLocation=new UINumber({min:0,max:63,step:1,value:0,class:"canBitOffset"});bitLength=new UINumber({min:1,max:64,step:1,value:1,class:"canBitLength"});multiplierLabel=document.createElement("span");multiplier=new UINumber({value:1,class:"canMultiplier"});adderLabel=document.createElement("span");adder=new UINumber({value:0,class:"canAdder"});unit=new UIUnit;liveUpdate=new UIDisplayLiveUpdate;constructor(e){super(),this.multiplierLabel.innerText="Multiplier:",this.adderLabel.innerText="Adder:",this.multiplier.hidden=this.multiplierLabel.hidden=this.adder.hidden=this.adderLabel.hidden=this.unit.hidden=!0,this.liveUpdate.style.float="right",this.bitLocation.addEventListener("change",(()=>{this.bitLength.max=64-this.bitLocation.value})),this.bitLength.addEventListener("change",(()=>{this.multiplier.hidden=this.multiplierLabel.hidden=this.adder.hidden=this.adderLabel.hidden=this.unit.hidden=this.bitLength.value<2})),this.unit.addEventListener("change",(()=>{this.liveUpdate.valueUnit=this.bitLength.value<2?void 0:this.unit.value})),this.Setup(e)}RegisterVariables(e){(e={...e,name:`${e.name}.${this.name.value}`}).unit=this.unit.value??e.unit,e.unit&&this.bitLength.value>1?delete e.type:(delete e.unit,e.type=this.bitLength.value<2?"bool":"float"),VariableRegister.RegisterVariable(e),this.liveUpdate.RegisterVariables(e)}}customElements.define("can-parse-data",CAN_ParseData,{extends:"span"});const to=[];class CAN_ReadData extends UITemplate{static displayName="CAN Read";static template='<div data-element="canBusLabel"></div><div data-element="canBus"></div><div data-element="canIDLabel"></div><div data-element="canID"></div><div data-element="parseData"></div>';canIDLabel=document.createElement("span");canID=new UINumber({min:0,max:536870911,step:1,value:0});canBusLabel=document.createElement("span");canBus=new UISelection({value:0,selectHidden:!0,class:"can-bus-selection"});parseData=new ConfigList({itemConstructor:CAN_ParseData,saveValue:[{}],class:"configContainer"});constructor(e){super(),this.canBusLabel.innerText="Bus:",this.canIDLabel.innerText="Identifier:",document.addEventListener("change",(e=>{e.target instanceof UIPinOverlay&&this.updateOptions(e.target.pinOut)})),this.updateOptions(document.querySelectorAll(".pinoverlay")[0]?.pinOut),this.Setup(e)}updateOptions(e){var t=[];if(e){for(var i=0;i<e.CANBusCount;i++)t.push({name:i,value:i});this.canBus.options=t,t.length<2&&(this.canBusLabel.hidden=!0,this.canBus.hidden=!0)}}RegisterVariables(e){this.parseData.RegisterVariables(e)}}to.push(CAN_ReadData),customElements.define("can-read-data",CAN_ReadData,{extends:"span"});class CAN_WriteData extends UITemplate{static displayName="CAN Write";static template='<div data-element="canBusLabel"></div><div data-element="canBus"></div><div data-element="canIDLabel"></div><div data-element="canID"></div>Interval:<div data-element="interval"></div><div data-element="packData"></div>';canIDLabel=document.createElement("span");canID=new UINumber({min:0,max:536870911,step:1,value:0});canBusLabel=document.createElement("span");canBus=new UISelection({value:0,selectHidden:!0,class:"can-bus-selection"});interval=new UISelection({value:100,options:[{name:"100Hz",value:100},{name:"33Hz",value:33},{name:"25Hz",value:25},{name:"20Hz",value:20},{name:"10Hz",value:10},{name:"5Hz",value:5},{name:"4Hz",value:4},{name:"3Hz",value:3},{name:"2Hz",value:2},{name:"1Hz",value:1}],selectHidden:!0,class:"can-write-interval"});packData=new ConfigList({itemConstructor:CAN_PackData,saveValue:[{}],class:"configContainer"});constructor(e){super(),this.canBusLabel.innerText="Bus:",this.canIDLabel.innerText="Identifier:",document.addEventListener("change",(e=>{e.target instanceof UIPinOverlay&&this.updateOptions(e.target.pinOut)})),this.updateOptions(document.querySelectorAll(".pinoverlay")[0]?.pinOut),this.Setup(e)}updateOptions(e){var t=[];if(e){for(var i=0;i<e.CANBusCount;i++)t.push({name:i,value:i});this.canBus.options=t,t.length<2&&(this.canBusLabel.hidden=!0,this.canBus.hidden=!0)}}RegisterVariables(e){this.packData.RegisterVariables(e)}}to.push(CAN_WriteData),customElements.define("can-write-data",CAN_WriteData,{extends:"span"});const io=[];let no=[];no.push(Calculation_Static),no.push(Calculation_LookupTable),no.push(Calculation_2AxisTable),no.push(Calculation_Formula);const ao=no;class CylinderAirmass_AlphaN extends UITemplate{static displayName="Alpha N";static outputUnits=["g"];static Requirements=["Throttle Position"];static template='<div data-element="Airmass"></div>';Airmass=new CalculationOrVariableSelection({calculations:ao,label:"Airnass",outputUnits:["g"],displayUnits:["g"]});constructor(e){super(),this.style.display="block",this.Setup(e)}}io.push(CylinderAirmass_AlphaN),customElements.define("cylinderairmass-alphan",CylinderAirmass_AlphaN,{extends:"span"});class CylinderAirmass_SpeedDensity extends UITemplate{static displayName="Speed Density";static outputUnits=["g"];static Requirements=["Cylinder Air Temperature","Manifold Absolute Pressure","Volumetric Efficiency"];static template='<label>Cylinder Volume:</label><div data-element="CylinderVolume"></div>';constructor(e){super(),this.CylinderVolume=new UINumberWithUnit({value:.66594,step:.001,min:.001,measurement:"Volume",valueUnit:"L",displayUnit:"mL"}),this.style.display="block",this.Setup(e)}}io.push(CylinderAirmass_SpeedDensity),customElements.define("cylinderairmass-speeddensity",CylinderAirmass_SpeedDensity,{extends:"span"});let lo=[];lo.push(Calculation_Static);const so=lo;class InjectorPulseWidth_DeadTime extends UITemplate{static displayName="Dead Time";static outputUnits=["s"];static template='<div data-element="FlowRate"></div><div data-element="DeadTime"></div><label>Min Injector Fuel Mass:</label><div data-element="MinInjectorFuelMass"></div>';FlowRate=new CalculationOrVariableSelection({calculations:GenericConfigs,label:"Injector Flow Rate",outputUnits:["g/s"]});DeadTime=new CalculationOrVariableSelection({calculations:GenericConfigs,label:"Injector Dead Time",outputUnits:["s"],displayUnits:["ms"]});MinInjectorFuelMass=new UINumberWithUnit({value:.005,step:.001,measurement:"Mass",valueUnit:"g",displayUnit:"mg"});constructor(e){super(),this.style.display="block",this.Setup(e)}RegisterVariables(){this.DeadTime.RegisterVariables({name:"FuelParameters.Injector Dead Time"}),this.FlowRate.RegisterVariables({name:"FuelParameters.Injector Flow Rate"})}}so.push(InjectorPulseWidth_DeadTime),customElements.define("injectorpulsewidth-deadtime",InjectorPulseWidth_DeadTime,{extends:"span"});class Input_Analog extends UITemplate{static displayName="Analog Pin";static outputUnits=["V"];static template='<label>Pin:</label><div data-element="pin"></div>';pin=new UIPinSelection({value:65535,pinType:"analog"});constructor(e){super(),this.style.display="block",this.Setup(e)}}ta.push(Input_Analog),customElements.define("input-analog",Input_Analog,{extends:"span"});class Input_AnalogPolynomial extends UITemplate{static outputTypes=["float"];static template='<div data-element="voltageLiveUpdate"></div><div data-element="analogInput"></div><div data-element="polynomial"></div>';get displayUnit(){return this.polynomial.displayUnit}set displayUnit(e){this.polynomial.displayUnit=e}get measurement(){return this.polynomial.measurement}set measurement(e){this.polynomial.measurement=e}get valueUnit(){return this.polynomial.valueUnit}set valueUnit(e){this.polynomial.valueUnit=e}get outputUnits(){return this.polynomial.outputUnits}set outputUnits(e){this.polynomial.outputUnits=e}get displayUnits(){return this.polynomial.displayUnits}set displayUnits(e){this.polynomial.displayUnits=e}analogInput=new Input_Analog;polynomial=new Calculation_Polynomial;voltageLiveUpdate=new UIDisplayLiveUpdate({valueUnit:Input_Analog.outputUnits[0]});constructor(e){super(),this.voltageLiveUpdate.style.float="right",this.Setup(e),this.style.display="block"}RegisterVariables(e){delete(e={...e}).unit,delete e.type,delete e.id,VariableRegister.RegisterVariable({...e,unit:"V"}),this.voltageLiveUpdate.RegisterVariables({...e,unit:"V"})}}customElements.define("input-analogpolynomial",Input_AnalogPolynomial,{extends:"span"});class UICheckBox extends HTMLInputElement{#o=!1;get value(){return this.#o}set value(e){this.#o!==e&&(this.checked=this.#o=e,super.dispatchEvent(new Event("change",{bubbles:!0})))}get saveValue(){return this.value}set saveValue(e){this.value=e}constructor(e){super(),this.type="checkbox",this.class="ui checkbox",Object.assign(this,e)}}customElements.define("ui-checkbox",UICheckBox,{extends:"input"});class Input_Digital extends UITemplate{static displayName="Digital Pin";static outputTypes=["bool"];static template='<label>Pin:</label><div data-element="pin"></div><div data-element="inverted"></div>Inverted';inverted=new UICheckBox;pin=new UIPinSelection({value:65535,pinType:"digitalin"});constructor(e){super(),this.style.display="block",this.Setup(e)}}ta.push(Input_Digital),customElements.define("input-digital",Input_Digital,{extends:"span"});class Input_DigitalRecord extends UITemplate{static displayName="Digital Pin (Record)";static outputTypes=["Record"];static template='<label>Pin:</label><div data-element="pin"></div><div data-element="inverted"></div>Inverted<br/><label>Length:</label><div data-element="length"></div>';inverted=new UICheckBox;pin=new UIPinSelection({value:65535,pinType:"digitalinterrupt"});length=new UINumber({value:2,step:1,min:1,max:1e3});constructor(e){super(),this.style.display="block",this.Setup(e)}}ta.push(Input_DigitalRecord),customElements.define("input-digitalrecord",Input_DigitalRecord,{extends:"span"});class Input_DutyCycle extends UITemplate{static displayName="Duty Cycle Pin Pin";static outputUnits=["[0.0-1.0]"];static template='<label>Pin:</label><div data-element="pin"></div><br/><label>Minimum Frequency:</label><div data-element="minFrequency"></div>';pin=new UIPinSelection({value:65535,pinType:"pwm"});minFrequency=new UINumberWithUnit({value:1e3,step:1,min:0,max:65535,measurement:"Frequency",valueUnit:"Hz"});constructor(e){super(),this.style.display="block",this.Setup(e)}}ta.push(Input_DutyCycle),customElements.define("input-dutycycle",Input_DutyCycle,{extends:"span"});class Input_Frequency extends UITemplate{static displayName="Frequency Pin";static outputUnits=["Hz"];static template='<label>Pin:</label><div data-element="pin"></div><br/><label>Minimum Frequency:</label><div data-element="minFrequency"></div>';pin=new UIPinSelection({value:65535,pinType:"pwm"});minFrequency=new UINumberWithUnit({value:1e3,step:1,min:0,max:65535,measurement:"Frequency",valueUnit:"Hz"});constructor(e){super(),this.style.display="block",this.Setup(e)}}ta.push(Input_Frequency),customElements.define("input-frequency",Input_Frequency,{extends:"span"});class Input_PulseWidth extends UITemplate{static displayName="Pulse Width Pin";static outputUnits=["s"];static template='<label>Pin:</label><div data-element="pin"></div><br/><label>Minimum Frequency:</label><div data-element="minFrequency"></div>';pin=new UIPinSelection({value:65535,pinType:"pwm"});minFrequency=new UINumberWithUnit({value:1e3,step:1,min:0,max:65535,measurement:"Frequency",valueUnit:"Hz"});constructor(e){super(),this.style.display="block",this.Setup(e)}}ta.push(Input_PulseWidth),customElements.define("input-pulsewidth",Input_PulseWidth,{extends:"span"});let ro=[];na.unshift({group:"MAP Sensors",calculations:ro});const oo=ro;class MAP_GM1Bar extends Input_AnalogPolynomial{static displayName="GM 1 Bar MAP";static outputUnits=["Bar"];get saveValue(){return this.analogInput.saveValue}set saveValue(e){return this.analogInput.saveValue=e}constructor(e){super(e),this.outputUnits=this.constructor.outputUnits,this.polynomial.hidden=!0,this.polynomial.minValue=.1,this.polynomial.maxValue=1.05;let t=[];t[0]=.101515151515152,t[1]=.18987012987013,this.polynomial.coeffecients=t}}oo.push(MAP_GM1Bar),customElements.define("map-gm1bar",MAP_GM1Bar,{extends:"span"});class MAP_GM2Bar extends Input_AnalogPolynomial{static displayName="GM 2 Bar MAP";static outputUnits=["Bar"];get saveValue(){return this.analogInput.saveValue}set saveValue(e){return this.analogInput.saveValue=e}constructor(e){super(e),this.outputUnits=this.constructor.outputUnits,this.polynomial.hidden=!0,this.polynomial.minValue=.088,this.polynomial.maxValue=2.08;let t=[];t[0]=.082718614718615,t[1]=.398493506493506,this.polynomial.coeffecients=t}}oo.push(MAP_GM2Bar),customElements.define("map-gm2bar",MAP_GM2Bar,{extends:"span"});class MAP_GM3Bar extends Input_AnalogPolynomial{static displayName="GM 3 Bar MAP";static outputUnits=["Bar"];get saveValue(){return this.analogInput.saveValue}set saveValue(e){return this.analogInput.saveValue=e}constructor(e){super(e),this.outputUnits=this.constructor.outputUnits,this.polynomial.hidden=!0,this.polynomial.minValue=.036,this.polynomial.maxValue=3.15;let t=[];t[0]=.016952380952381,t[1]=.628,this.polynomial.coeffecients=t}}oo.push(MAP_GM3Bar),customElements.define("map-gm3bar",MAP_GM3Bar,{extends:"span"});const uo=[];class Output_Digital extends UITemplate{static displayName="Digital Pin";static inputTypes=["bool"];static template='<label>Pin:</label><div data-element="pin"></div><div data-element="inverted"></div>Inverted <div data-element="highZ"></div>High Z';pin=new UIPinSelection({value:65535,pinType:"digitalout"});constructor(e){super(),this.inverted=new UICheckBox,this.highZ=new UICheckBox,this.style.display="block",this.Setup(e)}}uo.push(Output_Digital),customElements.define("output-digital",Output_Digital,{extends:"span"});class Output_TDC extends CalculationOrVariableSelection_CalculationOrVariableSelection{static inputTypes=["bool"];TDC=new UINumber({value:0,step:1,min:0,max:720});constructor(e){super(),this.inputTypes=["bool"],this.required=!0,this.calculations=uo;let t=document.createElement("span");t.append("      TDC:"),t.append(this.TDC),t.append("°"),this.Setup(e),this.labelElement.parentElement.append(t),this.labelElement.class="pinselectname",this.selection.addEventListener("change",(()=>{this.options.map((e=>e.options?.length??1)).reduce(((e,t)=>e+t),0)<2&&this.SubConfig?.querySelectorAll("label").length<2?(this.selection.hidden=!0,void 0===this.subConfigLabel&&(this.subConfigLabel=this.SubConfig.firstChild,this.SubConfig.firstChild.remove(),this.SubConfig.style.display="")):void 0!==this.subConfigLabel&&void 0!==this.SubConfig&&(this.SubConfig.insertBefore(this.subConfigLabel,this.SubConfig.firstChild),this.SubConfig.style.display="block")})),this.selection.dispatchEvent(new Event("change",{bubbles:!0}))}}customElements.define("output-tdc",Output_TDC,{extends:"span"});class ConfigContainer extends UITemplate{labelElement=document.createElement("span");get label(){return this.labelElement.textContent}set label(e){this.labelElement.textContent=e}Setup(e){super.Setup({...e,template:`<span data-element="labelElement"></span><div class="configContainer">${e?.template??this.setup??this.constructor.template}</div>`})}}customElements.define("top-config-container",ConfigContainer,{extends:"span"});class OutputList extends ConfigContainer{static template='<div data-element="Outputs"></div>';OutputCount=new UINumber({value:8});labelAndCountElement=document.createElement("div");Outputs=document.createElement("div");constructor(e){super(),this.OutputCount.addEventListener("change",(()=>{const e=this.OutputCount.value;let t=this.saveValue;t.splice(e);for(let i=t.length;i<e;i++)t[i]={};this.saveValue=t})),this.Setup(e),void 0===e.value&&(this.value=new Array(8))}get saveValue(){return[...this.Outputs.children].map((e=>e.saveValue))}set saveValue(e){for(this.OutputCount.value=e.length;this.Outputs.children.length>e.length;)this.Outputs.removeChild(this.Outputs.lastChild);for(let t=0;t<e.length;t++)this.Outputs.children[t]||this.Outputs.append(output),this.Outputs.children[t].saveValue=e[t]}get value(){return[...this.Outputs.children].map((e=>e.value))}set value(e){for(this.OutputCount.value=e.length;this.Outputs.children.length>e.length;)this.Outputs.removeChild(this.Outputs.lastChild);for(let t=0;t<e.length;t++){if(!this.Outputs.children[t]){const e=this.newOutput(t);this.Outputs.append(e)}this.Outputs.children[t].value=e[t]}}Setup(e){super.Setup(e),this.labelElement.replaceWith(this.labelAndCountElement),this.labelAndCountElement.append(this.labelElement),this.labelAndCountElement.append(this.OutputCount)}RegisterVariables(){for(let e=0;e<this.Outputs.children.length;e++)this.Outputs.children[e].RegisterVariables()}}customElements.define("top-injector-outputs",OutputList,{extends:"span"});const ho=[];class Output_PWM extends UITemplate{static displayName="PWM Pin";static template='<label>Pin:</label><div data-element="pin"></div><div data-element="period"></div><div data-element="pulseWidth"></div>';pin=new UIPinSelection({value:65535,pinType:"pwmout"});period=new CalculationOrVariableSelection_CalculationOrVariableSelection({label:"Period",outputUnits:["s"],displayUnits:["ms"],calculations:ia});pulseWidth=new CalculationOrVariableSelection_CalculationOrVariableSelection({label:"PulseWidth",outputUnits:["s"],displayUnits:["ms"],calculations:ia});minFrequency=new UINumber({value:200});constructor(e){super(),this.style.display="block",this.Setup(e)}RegisterVariables(e){this.period.RegisterVariables(e),this.pulseWidth.RegisterVariables(e)}}ho.push(Output_PWM),customElements.define("output-pwm",Output_PWM,{extends:"span"});class Reluctor_Template extends Input_DigitalRecord{static outputTypes=["ReluctorResult"];static template=Input_DigitalRecord.template.substring(0,Input_DigitalRecord.template.lastIndexOf("Inverted")+8);RegisterVariables(e){delete(e={...e}).unit,delete e.id,e.type="Record",VariableRegister.RegisterVariable(e)}}customElements.define("reluctor-template",Reluctor_Template,{extends:"span"});let co=[];na.unshift({group:"Reluctor Decoders",calculations:co});const po=co;class Reluctor_GM24x extends Reluctor_Template{static displayName="Reluctor GM 24X";constructor(e){super(e),this.length.value=100}}po.push(Reluctor_GM24x),customElements.define("reluctor-gm24x",Reluctor_GM24x,{extends:"span"});class Reluctor_Universal1x extends Reluctor_Template{static displayName="Reluctor Universal 1X";static template=Reluctor_Template.template+'<br/><label>Capture On:</label><div data-element="mode"></div><span data-element="rising"><br/><label>Rising Edge Position:</label><div data-element="risingPosition"></div></span><span data-element="falling"><br/><label>Falling Edge Position:</label><div data-element="fallingPosition"></div></span>';mode=new UISelection({options:[{name:"Both Edges",value:0},{name:"Rising Edge",value:1},{name:"Falling Edge",value:2}],value:0,selectHidden:!0});risingPosition=new UINumberWithUnit({value:0,step:.1,min:0,max:360,measurement:"Angle",valueUnit:"°"});fallingPosition=new UINumberWithUnit({value:180,step:.1,min:0,max:360,measurement:"Angle",valueUnit:"°"});constructor(e){super(),this.mode.addEventListener("change",(e=>{this.querySelectorAll('[data-element="rising"]')[0].hidden=!(0===this.mode.value||1===this.mode.value),this.querySelectorAll('[data-element="falling"]')[0].hidden=!(0===this.mode.value||2===this.mode.value)})),this.Setup(e),this.length.value=8}}po.push(Reluctor_Universal1x),customElements.define("reluctor-universal1x",Reluctor_Universal1x,{extends:"span"});class Reluctor_UniversalMissingTeeth extends Reluctor_Template{static displayName="Reluctor Universal Missing Teeth";static template=Reluctor_Template.template+'<br/><label>First Tooth Position:</label><div data-element="firstToothPosition"></div>(Falling Edge)<br/><label>Tooth Width:</label><div data-element="toothWidth"></div><br/><label>Number of Teeth:</label><div data-element="numberOfTeeth"></div><br/><label>Number of Teeth Missing:</label><div data-element="numberOfTeethMissing"></div>';firstToothPosition=new UINumberWithUnit({value:0,step:.1,min:0,max:360,measurement:"Angle",valueUnit:"°"});toothWidth=new UINumberWithUnit({value:5,step:.1,min:0,max:360,measurement:"Angle",valueUnit:"°"});numberOfTeeth=new UINumber({value:36,min:2});constructor(e){super(),this.length.value=72,this.numberOfTeeth.addEventListener("change",(()=>{this.length.value=2*this.numberOfTeeth.value})),this.numberOfTeethMissing=new UINumber({value:1,min:1}),this.Setup(e)}}po.push(Reluctor_UniversalMissingTeeth),customElements.define("reluctor-universalmissingteeth",Reluctor_UniversalMissingTeeth,{extends:"span"});let mo=[];mo.push(Calculation_Static),mo.push(Calculation_LookupTable),mo.push(Calculation_2AxisTable),mo.push(Calculation_Formula);let fo=[];fo.push(Calculation_Static),fo.push(Calculation_Formula);let vo=[];vo.push(Calculation_Static),vo.push(Calculation_Formula);let go=[];go.push(Calculation_Static),go.push(Calculation_LookupTable),go.push(Calculation_2AxisTable);let yo=[];yo.push(Calculation_Static),yo.push(Calculation_LookupTable),yo.push(Calculation_2AxisTable);let bo=[];bo.push(Calculation_Static);let xo=[];xo.push(Calculation_Static);let Eo=[];Eo.push(Calculation_Static);let wo=[];wo.push(Calculation_Static),wo.push(Calculation_LookupTable),wo.push(Calculation_2AxisTable),wo.push(Calculation_Formula);var _o=[];class EngineSensors extends ConfigContainer{static template='<div data-element="CrankPosition"></div><div data-element="CamPosition"></div><div data-element="CylinderAirTemperature"></div><div data-element="ManifoldAbsolutePressure"></div><div data-element="ThrottlePosition"></div>';CrankPosition=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:void 0,label:"Crank Position",outputTypes:["ReluctorResult"]});CamPosition=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:void 0,label:"Cam Position",outputTypes:["ReluctorResult"]});CylinderAirTemperature=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:bo,label:"Cylinder Air Temperature",outputUnits:["°C"]});ManifoldAbsolutePressure=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:xo,label:"Manifold Absolute Pressure",outputUnits:["Bar"]});ThrottlePosition=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:Eo,label:"Throttle Position",outputUnits:["%"]});constructor(e){super(),this.label="Engine Sensor Selection",this.Setup(e)}get value(){let e=super.value;return e.CrankPriority=1,this.ManifoldAbsolutePressure.hidden&&delete e.ManifoldAbsolutePressure,this.ThrottlePosition.hidden&&delete e.ThrottlePosition,this.CylinderAirTemperature.hidden&&delete e.CylinderAirTemperature,e}set value(e){super.value=e}RegisterVariables(){this.CrankPosition.RegisterVariables({name:"EngineParameters.Crank Position"}),this.CamPosition.RegisterVariables({name:"EngineParameters.Cam Position"}),this.ManifoldAbsolutePressure.hidden=-1===(_o?.indexOf("Manifold Absolute Pressure")??-1),this.ManifoldAbsolutePressure.hidden||this.ManifoldAbsolutePressure.RegisterVariables({name:"EngineParameters.Manifold Absolute Pressure"}),this.ThrottlePosition.hidden=-1===(_o?.indexOf("Throttle Position")??-1),this.ThrottlePosition.hidden||this.ThrottlePosition.RegisterVariables({name:"EngineParameters.Throttle Position"}),this.CylinderAirTemperature.hidden=-1===(_o?.indexOf("Cylinder Air Temperature")??-1),this.CylinderAirTemperature.hidden||this.CylinderAirTemperature.RegisterVariables({name:"EngineParameters.Cylinder Air Temperature"})}}customElements.define("top-engine-sensors",EngineSensors,{extends:"span"});class EngineCalculations extends ConfigContainer{static template='<div data-element="CylinderAirmass"></div><div data-element="VolumetricEfficiency"></div>';CylinderAirmass=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:io,label:"Cylinder Air Mass",selectName:"No Calculation",outputUnits:["g"],value:{selection:"CylinderAirmass_SpeedDensity"}});VolumetricEfficiency=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:wo,label:"Volumetric Efficiency",outputUnits:["[0.0-1.0]"],displayUnits:["%"]});constructor(e){super(),this.label="Engine Calculations",this.Setup(e)}get value(){let e=super.value;return this.VolumetricEfficiency.hidden&&delete e.VolumetricEfficiency,e}set value(e){super.value=e}RegisterVariables(){this.CylinderAirmass.RegisterVariables({name:"EngineParameters.Cylinder Air Mass"}),_o=this.CylinderAirmass.GetSubConfigProperty("Requirements"),this.VolumetricEfficiency.hidden=-1===(_o?.indexOf("Volumetric Efficiency")??-1),this.VolumetricEfficiency.hidden||this.VolumetricEfficiency.RegisterVariables({name:"EngineParameters.Volumetric Efficiency"})}}customElements.define("top-engine-calculations",EngineCalculations,{extends:"span"});class Engine extends ConfigList{constructor(e){super(e={...e,staticItems:[{name:"EngineSensors",item:new EngineSensors},{name:"EngineCalculations",item:new EngineCalculations}],itemConstructor:GenericCalculation})}RegisterVariables(){VariableRegister.RegisterVariable({name:"EngineParameters.Engine Speed",unit:"RPM"}),super.RegisterVariables({name:"EngineParameters"}),super.RegisterVariables({name:"EngineParameters"})}}customElements.define("top-engine",Engine,{extends:"div"});class InjectorProperties extends ConfigContainer{static template='<div data-element="InjectorEnable"></div><div data-element="InjectorPulseWidth"></div><div data-element="InjectorEndPosition"></div>';InjectorEnable=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:fo,label:"Injector Enable",outputTypes:["bool"]});InjectorPulseWidth=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:so,label:"Injector Pulse Width",outputUnits:["s"],displayUnits:["ms"]});InjectorEndPosition=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:ia,label:"Injector End Position",outputUnits:["°"]});constructor(e){super(),this.label="Injector Properties",this.Setup(e)}RegisterVariables(){this.InjectorEnable.RegisterVariables({name:"FuelParameters.Injector Enable"}),this.InjectorPulseWidth.RegisterVariables({name:"FuelParameters.Injector Pulse Width"}),this.InjectorEndPosition.RegisterVariables({name:"FuelParameters.Injector End Position"})}}customElements.define("top-injector-properties",InjectorProperties,{extends:"span"});class Fuel extends ConfigList{constructor(e){super(e={...e,staticItems:[{name:"AFR",item:new GenericCalculation({calculations:mo,name:"Air Fuel Ratio",nameEditable:!1,outputUnits:[":1"]})},{name:"InjectorProperties",item:new InjectorProperties},{name:"InjectorOutputs",item:new OutputList({label:"Injector Outputs",newOutput:e=>new Output_TDC({label:`Injector ${e+1}`})})}],itemConstructor:GenericCalculation})}RegisterVariables(){VariableRegister.RegisterVariable({name:"FuelParameters.Cylinder Fuel Mass",unit:"g"}),super.RegisterVariables({name:"FuelParameters"})}}customElements.define("top-fuel",Fuel,{extends:"div"});class IgnitionProperties extends ConfigContainer{static template='<div data-element="IgnitionEnable"></div><div data-element="IgnitionAdvance"></div><div data-element="IgnitionDwell"></div><div data-element="IgnitionDwellDeviation"></div>';IgnitionEnable=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:vo,label:"Ignition Enable",outputTypes:["bool"]});IgnitionAdvance=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:go,label:"Ignition Advance",outputUnits:["°"]});IgnitionDwell=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:yo,label:"Ignition Dwell",outputUnits:["s"],displayUnits:["ms"]});IgnitionDwellDeviation=new CalculationOrVariableSelection_CalculationOrVariableSelection({calculations:yo,label:"Ignition Dwell Deviation",outputUnits:["s"],displayUnits:["ms"]});constructor(e){super(),this.label="Ignition Properties",this.Setup(e)}RegisterVariables(){this.IgnitionEnable.RegisterVariables({name:"IgnitionParameters.Ignition Enable"}),this.IgnitionAdvance.RegisterVariables({name:"IgnitionParameters.Ignition Advance"}),this.IgnitionDwell.RegisterVariables({name:"IgnitionParameters.Ignition Dwell"}),this.IgnitionDwellDeviation.RegisterVariables({name:"IgnitionParameters.Ignition Dwell Deviation"})}}customElements.define("top-ignition-properties",IgnitionProperties,{extends:"span"});class Ignition extends ConfigList{constructor(e){super(e={...e,staticItems:[{name:"IgnitionProperties",item:new IgnitionProperties},{name:"IgnitionOutputs",item:new OutputList({label:"Ignition Outputs",newOutput:e=>new Output_TDC({label:`Ignition ${e+1}`})})}],itemConstructor:GenericCalculation})}RegisterVariables(){super.RegisterVariables({name:"IgnitionParameters"})}}customElements.define("top-ignition",Ignition,{extends:"div"});class Top extends UITemplate{static template='<div class="w3-sidebar" style="display: none;">\n    <div class="w3-bar">\n        <div data-element="topTitle"></div>\n        <div data-element="sidebarClose"></div>\n    </div>\n    <div data-element="sidebarSelection">\n    </div>\n</div>\n<div class="w3-container w3-display-container">\n    <span>\n        <div data-element="sidebarOpen"></div>\n        <div data-element="pageTitle"></div>\n    </span>\n    <hr style="margin: 0px 0px 5px 0px;">\n    <div data-element="page"></div>\n</div>';topTitle=document.createElement("div");pageTitle=document.createElement("div");sidebarClose=new UIButton({className:"sidebaropenclose w3-button w3-padding-16 w3-right"});sidebarOpen=new UIButton({className:"sidebaropenclose w3-button w3-padding-16"});sidebarSelection=document.createElement("div");page=document.createElement("div");addTab(e,t){const i=document.createElement("div");if(this.sidebarSelection.append(i),i.class="w3-bar-item w3-button tab",i.setAttribute("data-label",t),i.addEventListener("click",(()=>{this.activeTab=t})),e.tabListElement){e.tabListElement.setAttribute("data-label",t);const n="false"===(window.localStorage.getItem(`${t}Expanded`)??"true"),a=document.createElement("span");i.append(a),n?(a.className="despand",e.tabListElement.hidden=!1):(a.className="expand",e.tabListElement.hidden=!0),a.addEventListener("click",(i=>(e.tabListElement.hidden=!e.tabListElement.hidden,e.tabListElement.hidden?(window.localStorage.setItem(`${t}Expanded`,"true"),a.className="expand"):(window.localStorage.setItem(`${t}Expanded`,"false"),a.className="despand"),i.preventDefault(),i.stopPropagation(),!1))),e.tabListElement.addEventListener("click",(()=>{this.activeTab=t})),this.sidebarSelection.append(e.tabListElement)}const n=document.createElement("div");n.label=t,n.append(e),this.page.append(n)}hideTab(e){this.sidebarSelection.querySelectorAll(`div[data-label="${e}"]`).forEach((e=>{e.hidden=!0}))}unhideTab(e){this.sidebarSelection.querySelectorAll(`div[data-label="${e}"]`).forEach((e=>{e.hidden=!1}))}constructor(e){super(),this.Setup(e)}Setup(e){this.className="top",this.topTitle.className="w3-bar-item w3-padding-16",this.pageTitle.className="w3-padding-16",this.pageTitle.style.display="inline-block",this.pageTitle.style.margin="3px",this.sidebarSelection.className="w3-bar-block sidebarSelection",this.sidebarOpen.addEventListener("click",(()=>{window.localStorage.setItem("expanded","true");var e=this.firstChild,t=this.lastChild;e.hidden=!1;var i=e.offsetWidth,n=.005*i/.1,a=parseFloat(t.style.left);isNaN(a)&&(a=0),e.style.left=a-i+"px";var l=setInterval((()=>{a>=i?clearInterval(l):(a+=n,t.style.marginRight=t.style.left=`${a}px`,e.style.left=a-i+"px",e.style.opacity=a/i)}),5);this.sidebarOpen.hidden=!0})),this.sidebarClose.addEventListener("click",(()=>{window.localStorage.setItem("expanded","false");var e=this.firstChild,t=this.lastChild,i=e.offsetWidth,n=.005*i/.1,a=parseFloat(t.style.left);isNaN(a)&&(a=0),e.style.left=a-i+"px";var l=setInterval((()=>{a<=0?(clearInterval(l),e.hidden=!0):(a-=n,t.style.marginRight=t.style.left=`${a}px`,e.style.left=a-i+"px",e.style.opacity=a/i)}),5);this.sidebarOpen.hidden=!1}));let t=!1;this.sidebarSelection.addEventListener("touchstart",(()=>{t=!0})),this.addEventListener("click",(()=>{t&&(t=!1,this.sidebarClose.dispatchEvent(new Event("click")))})),this.activeTab=window.localStorage.getItem("lastTab")??"Inputs",window.setTimeout((()=>{"true"===(window.localStorage.getItem("expanded")??"false")&&this.sidebarOpen.dispatchEvent(new Event("click"))}),50),super.Setup(e)}get activeTab(){return this.pageTitle.textContent}set activeTab(e){window.localStorage.setItem("lastTab",e),this.pageTitle.textContent=e,[...this.page.children].forEach((t=>{t.hidden=t.label!==e}))}get saveValue(){return super.saveValue}set saveValue(e){super.saveValue=e,this.RegisterVariables()}RegisterVariables(){}}customElements.define("top-top",Top,{extends:"span"});customElements.define("top-topexpander",class TopExpander extends Top{Dashboard=new Dashboard;PinOverlay=new UIPinOverlay;TargetDevice=new UISelection({options:Object.entries(n).map((([e,t])=>({name:t.name,value:e}))),value:"ESP32C6_Expander"});Inputs=new ConfigList({itemConstructor:Input,saveValue:[{}]});CAN=new ConfigList({newItem:()=>new GenericCalculation({calculations:[{group:"CAN",calculations:to},{group:"Generic",calculations:ia}]})});Outputs=new ConfigList({newItem:()=>new GenericCalculation({calculations:[{group:"Output",calculations:ho},{group:"Generic",calculations:ia}]})});constructor(e){super(),this.addTab(this.Dashboard,"Dashboard"),this.addTab(this.PinOverlay,"Pin Mapping"),this.addTab(this.Inputs,"Inputs"),this.addTab(this.CAN,"CAN"),this.addTab(this.Outputs,"Outputs"),this.TargetDevice.addEventListener("change",(()=>{this.PinOverlay.pinOut=n[this.TargetDevice.value]})),this.PinOverlay.pinOut=n[this.TargetDevice.value],this.Setup(e)}get saveValue(){return super.saveValue}set saveValue(e){super.saveValue=e,this.RegisterVariables()}RegisterVariables(){VariableRegister.Clear(),this.Inputs.RegisterVariables(),this.CAN.RegisterVariables({name:"CANParameters"}),this.Outputs.RegisterVariables({name:"Outputs"}),this.Dashboard.RegisterVariables(),this.PinOverlay.update()}},{extends:"span"});class TopEngine extends Top{Dashboard=new Dashboard;PinOverlay=new UIPinOverlay;TargetDevice=new UISelection({options:Object.entries(n).map((([e,t])=>({name:t.name,value:e}))),value:"Purple_Pill_W806"});Inputs=new ConfigList({itemConstructor:Input,saveValue:[{}]});CAN=new ConfigList({newItem:()=>new GenericCalculation({calculations:[{group:"CAN",calculations:to},{group:"Generic",calculations:ia}]})});Engine=new Engine;Fuel=new Fuel;Ignition=new Ignition;constructor(e){super(),this.addTab(this.Dashboard,"Dashboard"),this.addTab(this.PinOverlay,"Pin Mapping"),this.addTab(this.Inputs,"Inputs"),this.addTab(this.CAN,"CAN"),this.addTab(this.Engine,"Engine"),this.addTab(this.Fuel,"Fuel"),this.addTab(this.Ignition,"Ignition"),this.TargetDevice.addEventListener("change",(()=>{this.PinOverlay.pinOut=n[this.TargetDevice.value],this.PinOverlay.pinOut.CANBusCount?this.unhideTab("CAN"):this.hideTab("CAN"),this.CAN.hidden=!0})),this.PinOverlay.pinOut=n[this.TargetDevice.value],this.PinOverlay.pinOut.CANBusCount?this.unhideTab("CAN"):this.hideTab("CAN"),this.Setup(e)}get saveValue(){return super.saveValue}set saveValue(e){super.saveValue=e,this.RegisterVariables()}get value(){return{...super.value,CANAvailable:this.PinOverlay.pinOut.CANBusCount}}set value(e){super.value=e}RegisterVariables(){VariableRegister.Clear(),VariableRegister.CurrentTick={name:"CurrentTick",type:"tick"},this.Inputs.RegisterVariables(),this.CAN.RegisterVariables({name:"CANParameters"}),this.Engine.RegisterVariables(),this.Fuel.RegisterVariables(),this.Ignition.RegisterVariables(),this.Dashboard.RegisterVariables(),this.PinOverlay.update()}}customElements.define("top-topengine",TopEngine,{extends:"span"});let Uo=[];na.unshift({group:"TPS Sensors",calculations:Uo});const Vo=Uo;class TPS_Linear extends Input_AnalogPolynomial{static displayName="Linear TPS";static outputUnits=["[0.0-1.0]"];static template=`${Input_AnalogPolynomial.template}<div style="display: flex;"><div style="display: inline-block;"><div><label>0% Voltage:</label><div data-element="voltage0"></div></div><div><label>100% Voltage:</label><div data-element="voltage100"></div></div></div><div style="display: flex; align-items: center;"><div data-element="swap"></div><div data-element="calibrate"></div></div></div>`;voltage0=new UINumberWithUnit({value:.1,step:.001,min:.001,measurement:"Voltage",valueUnit:"V"});voltage100=new UINumberWithUnit({value:4.9,step:.001,min:.001,measurement:"Voltage",valueUnit:"V"});calibrate=new UIButton({label:"Calibrate",hidden:!0});swap=new UIButton({label:"⤸"});get saveValue(){let e=super.saveValue;return delete e.polynomial,e}set saveValue(e){super.saveValue=e}constructor(e){super(),this.polynomial.hidden=!0,this.updatePolynomial(),this.polynomial.addEventListener("change",(()=>{this.updatePolynomial()})),this.voltage0.addEventListener("change",(()=>{this.updatePolynomial()})),this.voltage100.addEventListener("change",(()=>{this.updatePolynomial()})),this.calibrate.addEventListener("click",(()=>{"Stop"==this.calibrate.label?this.calibrate.label="Calibrate":(this.polarity=this.voltage100.value<this.voltage0.value?-1:1,this.voltage0.value=this.voltage100.value=this.voltageLiveUpdate.value,this.calibrate.label="Stop")})),this.swap.addEventListener("click",(()=>{this.polarity=-this.polarity;const e=this.voltage0.value;this.voltage0.value=this.voltage100.value,this.voltage100.value=e})),this.Setup(e),this.outputUnits=this.constructor.outputUnits}RegisterVariables(e){super.RegisterVariables(e);const t=Ti.liveUpdateEvents[this.voltageLiveUpdate.GUID];Ti.liveUpdateEvents[this.voltageLiveUpdate.GUID]=(e,i)=>{t(e,i);const n=this.voltageLiveUpdate.value,a="Stop"==this.calibrate.label;this.calibrate.hidden=null==n,null!=n?(this.calibrate.hidden=!1,this.polarity>0?(a&&n<this.voltage0.value&&(this.voltage0.value=n),a&&n>this.voltage100.value&&(this.voltage100.value=n)):(a&&n<this.voltage100.value&&(this.voltage100.value=n),a&&n>this.voltage0.value&&(this.voltage0.value=n))):this.calibrate.hidden=!0}}updatePolynomial(){const e=this.voltage0.value,t=this.voltage100.value;let i=[];i[1]=1/(t-e),i[0]=-e*i[1],this.polynomial.minValue=0,this.polynomial.maxValue=1,this.polynomial.coeffecients=i}}Vo.push(TPS_Linear),customElements.define("tps-linear",TPS_Linear,{extends:"span"});let Ao={enumerable:!0,get:function(){return"none"===this.style.display},set:function(e){e&&"none"!==this.style.display?(this.style.display&&(this._previousDisplayValue=this.style.display),this.style.display="none"):e||"none"!==this.style.display||(this._previousDisplayValue?this.style.display=this._previousDisplayValue:this.style.display=null,delete this._previousDisplayValue)}};Object.defineProperty(HTMLElement.prototype,"hidden",Ao),Object.defineProperty(SVGElement.prototype,"hidden",Ao),Object.defineProperty(HTMLElement.prototype,"class",{enumerable:!0,set:function(e){e.split(" ").forEach((e=>{this.classList.add(e)}))}}),window.VariableRegister=new VariableRegistry,window.GetMeasurementNameFromUnitName=Jn,window.addEventListener("load",(function(){Ti._serial=new Serial({baudRate:2e6},[{usbVendorId:6790,usbProductId:29987}]),window.communication=Ti,window.Pinouts=n,window.buildConfig=Ci,window.b=new TopEngine;let t=document.querySelector("#workspace");t.innerHtml="",t.append(b),b.addEventListener("change",(e=>{b.RegisterVariables()}));const i=e=>{try{b.saveValue=JSON.parse(e),document.querySelector("#btnLoad").value=""}catch{}};let a=window.localStorage.getItem("config");i(a);let l="tune.json";document.querySelector("#btnBurn").addEventListener("click",(function(){n[b.TargetDevice.value].Burn(b)})),document.querySelector("#btnDownload").addEventListener("click",(function(){e(b.saveValue,l)})),document.querySelector("#btnLoad").addEventListener("change",(function(e){var t=new FileReader;t.onload=function(e){if(2!=e.target.readyState)return;if(e.target.error)return void alert("Error while reading file");const t=e.target.result;window.localStorage.setItem("config",t),i(t)},t.readAsText(e.target.files[0]),l=e.target.files[0].name})),document.querySelector("#btnConnect").addEventListener("click",(function(){Ti.connect()}))}))})()})();
//# sourceMappingURL=main.js.map